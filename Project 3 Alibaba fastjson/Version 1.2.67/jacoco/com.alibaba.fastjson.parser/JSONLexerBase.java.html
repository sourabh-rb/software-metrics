<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSONLexerBase.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fastjson</a> &gt; <a href="index.source.html" class="el_package">com.alibaba.fastjson.parser</a> &gt; <span class="el_source">JSONLexerBase.java</span></div><h1>JSONLexerBase.java</h1><pre class="source lang-java linenums">/*
 * Copyright 1999-2019 Alibaba Group.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.alibaba.fastjson.parser;

import java.io.Closeable;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.*;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONException;
import com.alibaba.fastjson.util.IOUtils;

import static com.alibaba.fastjson.parser.JSONToken.*;

/**
 * @author wenshao[szujobs@hotmail.com]
 */
public abstract class JSONLexerBase implements JSONLexer, Closeable {

    protected void lexError(String key, Object... args) {
<span class="fc" id="L35">        token = ERROR;</span>
<span class="fc" id="L36">    }</span>

    protected int                            token;
    protected int                            pos;
    protected int                            features;

    protected char                           ch;
    protected int                            bp;

    protected int                            eofPos;

    /**
     * A character buffer for literals.
     */
    protected char[]                         sbuf;
    protected int                            sp;

    /**
     * number start position
     */
    protected int                            np;

    protected boolean                        hasSpecial;

<span class="fc" id="L60">    protected Calendar                       calendar           = null;</span>
<span class="fc" id="L61">    protected TimeZone                       timeZone           = JSON.defaultTimeZone;</span>
<span class="fc" id="L62">    protected Locale                         locale             = JSON.defaultLocale;</span>

<span class="fc" id="L64">    public int                               matchStat          = UNKNOWN;</span>

<span class="fc" id="L66">    private final static ThreadLocal&lt;char[]&gt; SBUF_LOCAL         = new ThreadLocal&lt;char[]&gt;();</span>

<span class="fc" id="L68">    protected String                         stringDefaultValue = null;</span>
<span class="fc" id="L69">    protected int                            nanos              = 0;</span>

<span class="fc" id="L71">    public JSONLexerBase(int features){</span>
<span class="fc" id="L72">        this.features = features;</span>

<span class="fc bfc" id="L74" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L75">            stringDefaultValue = &quot;&quot;;</span>
        }

<span class="fc" id="L78">        sbuf = SBUF_LOCAL.get();</span>

<span class="fc bfc" id="L80" title="All 2 branches covered.">        if (sbuf == null) {</span>
<span class="fc" id="L81">            sbuf = new char[512];</span>
        }
<span class="fc" id="L83">    }</span>

    public final int matchStat() {
<span class="fc" id="L86">        return matchStat;</span>
    }

    /**
     * internal method, don't invoke
     * @param token
     */
    public void setToken(int token) {
<span class="fc" id="L94">        this.token = token;</span>
<span class="fc" id="L95">    }</span>

    public final void nextToken() {
<span class="fc" id="L98">        sp = 0;</span>

        for (;;) {
<span class="fc" id="L101">            pos = bp;</span>

<span class="fc bfc" id="L103" title="All 2 branches covered.">            if (ch == '/') {</span>
<span class="fc" id="L104">                skipComment();</span>
<span class="fc" id="L105">                continue;</span>
            }

<span class="fc bfc" id="L108" title="All 2 branches covered.">            if (ch == '&quot;') {</span>
<span class="fc" id="L109">                scanString();</span>
<span class="fc" id="L110">                return;</span>
            }

<span class="fc bfc" id="L113" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L114">                next();</span>
<span class="fc" id="L115">                token = COMMA;</span>
<span class="fc" id="L116">                return;</span>
            }

<span class="fc bfc" id="L119" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L120">                scanNumber();</span>
<span class="fc" id="L121">                return;</span>
            }

<span class="fc bfc" id="L124" title="All 2 branches covered.">            if (ch == '-') {</span>
<span class="fc" id="L125">                scanNumber();</span>
<span class="fc" id="L126">                return;</span>
            }

<span class="fc bfc" id="L129" title="All 18 branches covered.">            switch (ch) {</span>
                case '\'':
<span class="fc bfc" id="L131" title="All 2 branches covered.">                    if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L132">                        throw new JSONException(&quot;Feature.AllowSingleQuotes is false&quot;);</span>
                    }
<span class="fc" id="L134">                    scanStringSingleQuote();</span>
<span class="fc" id="L135">                    return;</span>
                case ' ':
                case '\t':
                case '\b':
                case '\f':
                case '\n':
                case '\r':
<span class="fc" id="L142">                    next();</span>
<span class="fc" id="L143">                    break;</span>
                case 't': // true
<span class="fc" id="L145">                    scanTrue();</span>
<span class="fc" id="L146">                    return;</span>
                case 'f': // false
<span class="fc" id="L148">                    scanFalse();</span>
<span class="fc" id="L149">                    return;</span>
                case 'n': // new,null
<span class="fc" id="L151">                    scanNullOrNew();</span>
<span class="fc" id="L152">                    return;</span>
                case 'T':
                case 'N': // NULL
                case 'S':
                case 'u': // undefined
<span class="fc" id="L157">                    scanIdent();</span>
<span class="fc" id="L158">                    return;</span>
                case '(':
<span class="fc" id="L160">                    next();</span>
<span class="fc" id="L161">                    token = LPAREN;</span>
<span class="fc" id="L162">                    return;</span>
                case ')':
<span class="fc" id="L164">                    next();</span>
<span class="fc" id="L165">                    token = RPAREN;</span>
<span class="fc" id="L166">                    return;</span>
                case '[':
<span class="fc" id="L168">                    next();</span>
<span class="fc" id="L169">                    token = LBRACKET;</span>
<span class="fc" id="L170">                    return;</span>
                case ']':
<span class="fc" id="L172">                    next();</span>
<span class="fc" id="L173">                    token = RBRACKET;</span>
<span class="fc" id="L174">                    return;</span>
                case '{':
<span class="fc" id="L176">                    next();</span>
<span class="fc" id="L177">                    token = LBRACE;</span>
<span class="fc" id="L178">                    return;</span>
                case '}':
<span class="fc" id="L180">                    next();</span>
<span class="fc" id="L181">                    token = RBRACE;</span>
<span class="fc" id="L182">                    return;</span>
                case ':':
<span class="fc" id="L184">                    next();</span>
<span class="fc" id="L185">                    token = COLON;</span>
<span class="fc" id="L186">                    return;</span>
                case ';':
<span class="fc" id="L188">                    next();</span>
<span class="fc" id="L189">                    token = SEMI;</span>
<span class="fc" id="L190">                    return;</span>
                case '.':
<span class="fc" id="L192">                    next();</span>
<span class="fc" id="L193">                    token = DOT;</span>
<span class="fc" id="L194">                    return;</span>
                case '+':
<span class="fc" id="L196">                    next();</span>
<span class="fc" id="L197">                    scanNumber();</span>
<span class="fc" id="L198">                    return;</span>
                case 'x':
<span class="fc" id="L200">                    scanHex();</span>
<span class="fc" id="L201">                    return;</span>
                default:
<span class="fc bfc" id="L203" title="All 2 branches covered.">                    if (isEOF()) { // JLS</span>
<span class="fc bfc" id="L204" title="All 2 branches covered.">                        if (token == EOF) {</span>
<span class="fc" id="L205">                            throw new JSONException(&quot;EOF error&quot;);</span>
                        }

<span class="fc" id="L208">                        token = EOF;</span>
<span class="fc" id="L209">                        eofPos = pos = bp;</span>
<span class="fc" id="L210">                    } else {</span>
<span class="fc bfc" id="L211" title="All 4 branches covered.">                        if (ch &lt;= 31 || ch == 127) {</span>
<span class="fc" id="L212">                            next();</span>
<span class="fc" id="L213">                            break;</span>
                        }

<span class="fc" id="L216">                        lexError(&quot;illegal.char&quot;, String.valueOf((int) ch));</span>
<span class="fc" id="L217">                        next();</span>
                    }

<span class="fc" id="L220">                    return;</span>
            }
        }

    }

    public final void nextToken(int expect) {
<span class="fc" id="L227">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L230" title="All 9 branches covered.">            switch (expect) {</span>
                case JSONToken.LBRACE:
<span class="fc bfc" id="L232" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L233">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L234">                        next();</span>
<span class="fc" id="L235">                        return;</span>
                    }
<span class="fc bfc" id="L237" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L238">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L239">                        next();</span>
<span class="fc" id="L240">                        return;</span>
                    }
                    break;
                case JSONToken.COMMA:
<span class="fc bfc" id="L244" title="All 2 branches covered.">                    if (ch == ',') {</span>
<span class="fc" id="L245">                        token = JSONToken.COMMA;</span>
<span class="fc" id="L246">                        next();</span>
<span class="fc" id="L247">                        return;</span>
                    }

<span class="fc bfc" id="L250" title="All 2 branches covered.">                    if (ch == '}') {</span>
<span class="fc" id="L251">                        token = JSONToken.RBRACE;</span>
<span class="fc" id="L252">                        next();</span>
<span class="fc" id="L253">                        return;</span>
                    }

<span class="fc bfc" id="L256" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L257">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L258">                        next();</span>
<span class="fc" id="L259">                        return;</span>
                    }

<span class="fc bfc" id="L262" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L263">                        token = JSONToken.EOF;</span>
<span class="fc" id="L264">                        return;</span>
                    }

<span class="fc bfc" id="L267" title="All 2 branches covered.">                    if (ch == 'n') {</span>
<span class="fc" id="L268">                        scanNullOrNew(false);</span>
<span class="fc" id="L269">                        return;</span>
                    }
                    break;
                case JSONToken.LITERAL_INT:
<span class="fc bfc" id="L273" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L274">                        pos = bp;</span>
<span class="fc" id="L275">                        scanNumber();</span>
<span class="fc" id="L276">                        return;</span>
                    }

<span class="fc bfc" id="L279" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L280">                        pos = bp;</span>
<span class="fc" id="L281">                        scanString();</span>
<span class="fc" id="L282">                        return;</span>
                    }

<span class="fc bfc" id="L285" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L286">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L287">                        next();</span>
<span class="fc" id="L288">                        return;</span>
                    }

<span class="fc bfc" id="L291" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L292">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L293">                        next();</span>
<span class="fc" id="L294">                        return;</span>
                    }

                    break;
                case JSONToken.LITERAL_STRING:
<span class="fc bfc" id="L299" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L300">                        pos = bp;</span>
<span class="fc" id="L301">                        scanString();</span>
<span class="fc" id="L302">                        return;</span>
                    }

<span class="fc bfc" id="L305" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L306">                        pos = bp;</span>
<span class="fc" id="L307">                        scanNumber();</span>
<span class="fc" id="L308">                        return;</span>
                    }

<span class="fc bfc" id="L311" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L312">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L313">                        next();</span>
<span class="fc" id="L314">                        return;</span>
                    }

<span class="fc bfc" id="L317" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L318">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L319">                        next();</span>
<span class="fc" id="L320">                        return;</span>
                    }
                    break;
                case JSONToken.LBRACKET:
<span class="fc bfc" id="L324" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L325">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L326">                        next();</span>
<span class="fc" id="L327">                        return;</span>
                    }

<span class="fc bfc" id="L330" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L331">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L332">                        next();</span>
<span class="fc" id="L333">                        return;</span>
                    }
                    break;
                case JSONToken.RBRACKET:
<span class="fc bfc" id="L337" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L338">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L339">                        next();</span>
<span class="fc" id="L340">                        return;</span>
                    }
                case JSONToken.EOF:
<span class="fc bfc" id="L343" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L344">                        token = JSONToken.EOF;</span>
<span class="fc" id="L345">                        return;</span>
                    }
                    break;
                case JSONToken.IDENTIFIER:
<span class="fc" id="L349">                    nextIdent();</span>
<span class="fc" id="L350">                    return;</span>
                default:
                    break;
            }

<span class="fc bfc" id="L355" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L356">                next();</span>
<span class="fc" id="L357">                continue;</span>
            }

<span class="fc" id="L360">            nextToken();</span>
            break;
        }
<span class="fc" id="L363">    }</span>

    public final void nextIdent() {
<span class="fc bfc" id="L366" title="All 2 branches covered.">        while (isWhitespace(ch)) {</span>
<span class="fc" id="L367">            next();</span>
        }
<span class="fc bfc" id="L369" title="All 6 branches covered.">        if (ch == '_' || ch == '$' || Character.isLetter(ch)) {</span>
<span class="fc" id="L370">            scanIdent();</span>
<span class="fc" id="L371">        } else {</span>
<span class="fc" id="L372">            nextToken();</span>
        }
<span class="fc" id="L374">    }</span>

    public final void nextTokenWithColon() {
<span class="fc" id="L377">        nextTokenWithChar(':');</span>
<span class="fc" id="L378">    }</span>

    public final void nextTokenWithChar(char expect) {
<span class="fc" id="L381">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L384" title="All 2 branches covered.">            if (ch == expect) {</span>
<span class="fc" id="L385">                next();</span>
<span class="fc" id="L386">                nextToken();</span>
<span class="fc" id="L387">                return;</span>
            }

<span class="fc bfc" id="L390" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L391">                next();</span>
<span class="fc" id="L392">                continue;</span>
            }

<span class="fc" id="L395">            throw new JSONException(&quot;not match &quot; + expect + &quot; - &quot; + ch + &quot;, info : &quot; + this.info());</span>
        }
    }

    public final int token() {
<span class="fc" id="L400">        return token;</span>
    }

    public final String tokenName() {
<span class="fc" id="L404">        return JSONToken.name(token);</span>
    }

    public final int pos() {
<span class="fc" id="L408">        return pos;</span>
    }

    public final String stringDefaultValue() {
<span class="fc" id="L412">        return stringDefaultValue;</span>
    }

    public final Number integerValue() throws NumberFormatException {
<span class="fc" id="L416">        long result = 0;</span>
<span class="fc" id="L417">        boolean negative = false;</span>
<span class="fc bfc" id="L418" title="All 2 branches covered.">        if (np == -1) {</span>
<span class="fc" id="L419">            np = 0;</span>
        }
<span class="fc" id="L421">        int i = np, max = np + sp;</span>
        long limit;
        long multmin;
        int digit;

<span class="fc" id="L426">        char type = ' ';</span>

<span class="fc bfc" id="L428" title="All 4 branches covered.">        switch (charAt(max - 1)) {</span>
            case 'L':
<span class="fc" id="L430">                max--;</span>
<span class="fc" id="L431">                type = 'L';</span>
<span class="fc" id="L432">                break;</span>
            case 'S':
<span class="fc" id="L434">                max--;</span>
<span class="fc" id="L435">                type = 'S';</span>
<span class="fc" id="L436">                break;</span>
            case 'B':
<span class="fc" id="L438">                max--;</span>
<span class="fc" id="L439">                type = 'B';</span>
<span class="fc" id="L440">                break;</span>
            default:
                break;
        }

<span class="fc bfc" id="L445" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L446">            negative = true;</span>
<span class="fc" id="L447">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L448">            i++;</span>
<span class="fc" id="L449">        } else {</span>
<span class="fc" id="L450">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L452">        multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L453" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L454">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L455">            result = -digit;</span>
        }
<span class="fc bfc" id="L457" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L459">            digit = charAt(i++) - '0';</span>
<span class="fc bfc" id="L460" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L461">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L463">            result *= 10;</span>
<span class="fc bfc" id="L464" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L465">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L467">            result -= digit;</span>
        }

<span class="fc bfc" id="L470" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L471" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc bfc" id="L472" title="All 4 branches covered.">                if (result &gt;= Integer.MIN_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L473" title="All 2 branches covered.">                    if (type == 'S') {</span>
<span class="fc" id="L474">                        return (short) result;</span>
                    }

<span class="fc bfc" id="L477" title="All 2 branches covered.">                    if (type == 'B') {</span>
<span class="fc" id="L478">                        return (byte) result;</span>
                    }

<span class="fc" id="L481">                    return (int) result;</span>
                }
<span class="fc" id="L483">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L485">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L488">            result = -result;</span>
<span class="fc bfc" id="L489" title="All 4 branches covered.">            if (result &lt;= Integer.MAX_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L490" title="All 2 branches covered.">                if (type == 'S') {</span>
<span class="fc" id="L491">                    return (short) result;</span>
                }

<span class="fc bfc" id="L494" title="All 2 branches covered.">                if (type == 'B') {</span>
<span class="fc" id="L495">                    return (byte) result;</span>
                }

<span class="fc" id="L498">                return (int) result;</span>
            }
<span class="fc" id="L500">            return result;</span>
        }
    }

    public final void nextTokenWithColon(int expect) {
<span class="fc" id="L505">        nextTokenWithChar(':');</span>
<span class="fc" id="L506">    }</span>

    public float floatValue() {
<span class="fc" id="L509">        String strVal = numberString();</span>
<span class="fc" id="L510">        float floatValue = Float.parseFloat(strVal);</span>
<span class="fc bfc" id="L511" title="All 4 branches covered.">        if (floatValue == 0 || floatValue == Float.POSITIVE_INFINITY) {</span>
<span class="fc" id="L512">            char c0 = strVal.charAt(0);</span>
<span class="pc bpc" id="L513" title="1 of 4 branches missed.">            if (c0 &gt; '0' &amp;&amp; c0 &lt;= '9') {</span>
<span class="fc" id="L514">                throw new JSONException(&quot;float overflow : &quot; + strVal);</span>
            }
        }
<span class="fc" id="L517">        return floatValue;</span>
    }

    public double doubleValue() {
<span class="fc" id="L521">        return Double.parseDouble(numberString());</span>
    }

    public void config(Feature feature, boolean state) {
<span class="fc" id="L525">        features = Feature.config(features, feature, state);</span>

<span class="fc bfc" id="L527" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L528">            stringDefaultValue = &quot;&quot;;</span>
        }
<span class="fc" id="L530">    }</span>

    public final boolean isEnabled(Feature feature) {
<span class="fc" id="L533">        return isEnabled(feature.mask);</span>
    }

    public final boolean isEnabled(int feature) {
<span class="fc bfc" id="L537" title="All 2 branches covered.">        return (this.features &amp; feature) != 0;</span>
    }

    public final boolean isEnabled(int features, int feature) {
<span class="pc bpc" id="L541" title="1 of 4 branches missed.">        return (this.features &amp; feature) != 0 || (features &amp; feature) != 0;</span>
    }

    public abstract String numberString();

    public abstract boolean isEOF();

    public final char getCurrent() {
<span class="fc" id="L549">        return ch;</span>
    }

    public abstract char charAt(int index);

    // public final char next() {
    // ch = doNext();
    //// if (ch == '/' &amp;&amp; (this.features &amp; Feature.AllowComment.mask) != 0) {
    //// skipComment();
    //// }
    // return ch;
    // }

    public abstract char next();

    protected void skipComment() {
<span class="fc" id="L565">        next();</span>
<span class="fc bfc" id="L566" title="All 2 branches covered.">        if (ch == '/') {</span>
            for (;;) {
<span class="fc" id="L568">                next();</span>
<span class="fc bfc" id="L569" title="All 2 branches covered.">                if (ch == '\n') {</span>
<span class="fc" id="L570">                    next();</span>
<span class="fc" id="L571">                    return;</span>
<span class="fc bfc" id="L572" title="All 2 branches covered.">                } else if (ch == EOI) {</span>
<span class="fc" id="L573">                    return;</span>
                }
            }
<span class="fc bfc" id="L576" title="All 2 branches covered.">        } else if (ch == '*') {</span>
<span class="fc" id="L577">            next();</span>

<span class="pc bpc" id="L579" title="1 of 2 branches missed.">            for (; ch != EOI;) {</span>
<span class="fc bfc" id="L580" title="All 2 branches covered.">                if (ch == '*') {</span>
<span class="fc" id="L581">                    next();</span>
<span class="fc bfc" id="L582" title="All 2 branches covered.">                    if (ch == '/') {</span>
<span class="fc" id="L583">                        next();</span>
<span class="fc" id="L584">                        return;</span>
                    } else {
                        continue;
                    }
                }
<span class="fc" id="L589">                next();</span>
            }
<span class="nc" id="L591">        } else {</span>
<span class="fc" id="L592">            throw new JSONException(&quot;invalid comment&quot;);</span>
        }
<span class="nc" id="L594">    }</span>

    public final String scanSymbol(final SymbolTable symbolTable) {
<span class="fc" id="L597">        skipWhitespace();</span>

<span class="fc bfc" id="L599" title="All 2 branches covered.">        if (ch == '&quot;') {</span>
<span class="fc" id="L600">            return scanSymbol(symbolTable, '&quot;');</span>
        }

<span class="fc bfc" id="L603" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc bfc" id="L604" title="All 2 branches covered.">            if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L605">                throw new JSONException(&quot;syntax error&quot;);</span>
            }

<span class="fc" id="L608">            return scanSymbol(symbolTable, '\'');</span>
        }

<span class="fc bfc" id="L611" title="All 2 branches covered.">        if (ch == '}') {</span>
<span class="fc" id="L612">            next();</span>
<span class="fc" id="L613">            token = JSONToken.RBRACE;</span>
<span class="fc" id="L614">            return null;</span>
        }

<span class="fc bfc" id="L617" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L618">            next();</span>
<span class="fc" id="L619">            token = JSONToken.COMMA;</span>
<span class="fc" id="L620">            return null;</span>
        }

<span class="fc bfc" id="L623" title="All 2 branches covered.">        if (ch == EOI) {</span>
<span class="fc" id="L624">            token = JSONToken.EOF;</span>
<span class="fc" id="L625">            return null;</span>
        }

<span class="fc bfc" id="L628" title="All 2 branches covered.">        if (!isEnabled(Feature.AllowUnQuotedFieldNames)) {</span>
<span class="fc" id="L629">            throw new JSONException(&quot;syntax error&quot;);</span>
        }

<span class="fc" id="L632">        return scanSymbolUnQuoted(symbolTable);</span>
    }

    // public abstract String scanSymbol(final SymbolTable symbolTable, final char quote);

    protected abstract void arrayCopy(int srcPos, char[] dest, int destPos, int length);

    public final String scanSymbol(final SymbolTable symbolTable, final char quote) {
<span class="fc" id="L640">        int hash = 0;</span>

<span class="fc" id="L642">        np = bp;</span>
<span class="fc" id="L643">        sp = 0;</span>
<span class="fc" id="L644">        boolean hasSpecial = false;</span>
        char chLocal;
<span class="fc" id="L646">        for (;;) {</span>
<span class="fc" id="L647">            chLocal = next();</span>

<span class="fc bfc" id="L649" title="All 2 branches covered.">            if (chLocal == quote) {</span>
<span class="fc" id="L650">                break;</span>
            }

<span class="fc bfc" id="L653" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L654">                throw new JSONException(&quot;unclosed.str&quot;);</span>
            }

<span class="fc bfc" id="L657" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L658" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L659">                    hasSpecial = true;</span>

<span class="fc bfc" id="L661" title="All 2 branches covered.">                    if (sp &gt;= sbuf.length) {</span>
<span class="fc" id="L662">                        int newCapcity = sbuf.length * 2;</span>
<span class="pc bpc" id="L663" title="1 of 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L664">                            newCapcity = sp;</span>
                        }
<span class="fc" id="L666">                        char[] newsbuf = new char[newCapcity];</span>
<span class="fc" id="L667">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L668">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(this.buf, np + 1, sbuf, 0, sp);
<span class="fc" id="L673">                    arrayCopy(np + 1, sbuf, 0, sp);</span>
                }

<span class="fc" id="L676">                chLocal = next();</span>

<span class="fc bfc" id="L678" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L680">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L681">                        putChar('\0');</span>
<span class="fc" id="L682">                        break;</span>
                    case '1':
<span class="fc" id="L684">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L685">                        putChar('\1');</span>
<span class="fc" id="L686">                        break;</span>
                    case '2':
<span class="fc" id="L688">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L689">                        putChar('\2');</span>
<span class="fc" id="L690">                        break;</span>
                    case '3':
<span class="fc" id="L692">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L693">                        putChar('\3');</span>
<span class="fc" id="L694">                        break;</span>
                    case '4':
<span class="fc" id="L696">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L697">                        putChar('\4');</span>
<span class="fc" id="L698">                        break;</span>
                    case '5':
<span class="fc" id="L700">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L701">                        putChar('\5');</span>
<span class="fc" id="L702">                        break;</span>
                    case '6':
<span class="fc" id="L704">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L705">                        putChar('\6');</span>
<span class="fc" id="L706">                        break;</span>
                    case '7':
<span class="fc" id="L708">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L709">                        putChar('\7');</span>
<span class="fc" id="L710">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L712">                        hash = 31 * hash + (int) '\b';</span>
<span class="fc" id="L713">                        putChar('\b');</span>
<span class="fc" id="L714">                        break;</span>
                    case 't': // 9
<span class="fc" id="L716">                        hash = 31 * hash + (int) '\t';</span>
<span class="fc" id="L717">                        putChar('\t');</span>
<span class="fc" id="L718">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L720">                        hash = 31 * hash + (int) '\n';</span>
<span class="fc" id="L721">                        putChar('\n');</span>
<span class="fc" id="L722">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L724">                        hash = 31 * hash + (int) '\u000B';</span>
<span class="fc" id="L725">                        putChar('\u000B');</span>
<span class="fc" id="L726">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L729">                        hash = 31 * hash + (int) '\f';</span>
<span class="fc" id="L730">                        putChar('\f');</span>
<span class="fc" id="L731">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L733">                        hash = 31 * hash + (int) '\r';</span>
<span class="fc" id="L734">                        putChar('\r');</span>
<span class="fc" id="L735">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L737">                        hash = 31 * hash + (int) '&quot;';</span>
<span class="fc" id="L738">                        putChar('&quot;');</span>
<span class="fc" id="L739">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L741">                        hash = 31 * hash + (int) '\'';</span>
<span class="fc" id="L742">                        putChar('\'');</span>
<span class="fc" id="L743">                        break;</span>
                    case '/': // 47
<span class="fc" id="L745">                        hash = 31 * hash + (int) '/';</span>
<span class="fc" id="L746">                        putChar('/');</span>
<span class="fc" id="L747">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L749">                        hash = 31 * hash + (int) '\\';</span>
<span class="fc" id="L750">                        putChar('\\');</span>
<span class="fc" id="L751">                        break;</span>
                    case 'x':
<span class="fc" id="L753">                        char x1 = ch = next();</span>
<span class="fc" id="L754">                        char x2 = ch = next();</span>

<span class="fc" id="L756">                        int x_val = digits[x1] * 16 + digits[x2];</span>
<span class="fc" id="L757">                        char x_char = (char) x_val;</span>
<span class="fc" id="L758">                        hash = 31 * hash + (int) x_char;</span>
<span class="fc" id="L759">                        putChar(x_char);</span>
<span class="fc" id="L760">                        break;</span>
                    case 'u':
<span class="fc" id="L762">                        char c1 = chLocal = next();</span>
<span class="fc" id="L763">                        char c2 = chLocal = next();</span>
<span class="fc" id="L764">                        char c3 = chLocal = next();</span>
<span class="fc" id="L765">                        char c4 = chLocal = next();</span>
<span class="fc" id="L766">                        int val = Integer.parseInt(new String(new char[] { c1, c2, c3, c4 }), 16);</span>
<span class="fc" id="L767">                        hash = 31 * hash + val;</span>
<span class="fc" id="L768">                        putChar((char) val);</span>
<span class="fc" id="L769">                        break;</span>
                    default:
<span class="fc" id="L771">                        this.ch = chLocal;</span>
<span class="fc" id="L772">                        throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
                }
                continue;
            }

<span class="fc" id="L777">            hash = 31 * hash + chLocal;</span>

<span class="fc bfc" id="L779" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L780">                sp++;</span>
<span class="fc" id="L781">                continue;</span>
            }

<span class="fc bfc" id="L784" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L785">                putChar(chLocal);</span>
<span class="fc" id="L786">            } else {</span>
<span class="fc" id="L787">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L791">        token = LITERAL_STRING;</span>

        String value;
<span class="fc bfc" id="L794" title="All 2 branches covered.">        if (!hasSpecial) {</span>
            // return this.text.substring(np + 1, np + 1 + sp).intern();
            int offset;
<span class="pc bpc" id="L797" title="1 of 2 branches missed.">            if (np == -1) {</span>
<span class="nc" id="L798">                offset = 0;</span>
<span class="nc" id="L799">            } else {</span>
<span class="fc" id="L800">                offset = np + 1;</span>
            }
<span class="fc" id="L802">            value = addSymbol(offset, sp, hash, symbolTable);</span>
<span class="fc" id="L803">        } else {</span>
<span class="fc" id="L804">            value = symbolTable.addSymbol(sbuf, 0, sp, hash);</span>
        }

<span class="fc" id="L807">        sp = 0;</span>
<span class="fc" id="L808">        this.next();</span>

<span class="fc" id="L810">        return value;</span>
    }

    public final void resetStringPosition() {
<span class="fc" id="L814">        this.sp = 0;</span>
<span class="fc" id="L815">    }</span>

    public String info() {
<span class="fc" id="L818">        return &quot;&quot;;</span>
    }

    public final String scanSymbolUnQuoted(final SymbolTable symbolTable) {
<span class="pc bpc" id="L822" title="2 of 6 branches missed.">        if (token == JSONToken.ERROR &amp;&amp; pos == 0 &amp;&amp; bp == 1) {</span>
<span class="fc" id="L823">            bp = 0; // adjust</span>
        }
<span class="fc" id="L825">        final boolean[] firstIdentifierFlags = IOUtils.firstIdentifierFlags;</span>
<span class="fc" id="L826">        final char first = ch;</span>

<span class="pc bpc" id="L828" title="1 of 4 branches missed.">        final boolean firstFlag = ch &gt;= firstIdentifierFlags.length || firstIdentifierFlags[first];</span>
<span class="fc bfc" id="L829" title="All 2 branches covered.">        if (!firstFlag) {</span>
<span class="fc" id="L830">            throw new JSONException(&quot;illegal identifier : &quot; + ch //</span>
<span class="fc" id="L831">                    + info());</span>
        }

<span class="fc" id="L834">        final boolean[] identifierFlags = IOUtils.identifierFlags;</span>

<span class="fc" id="L836">        int hash = first;</span>

<span class="fc" id="L838">        np = bp;</span>
<span class="fc" id="L839">        sp = 1;</span>
        char chLocal;
<span class="fc" id="L841">        for (;;) {</span>
<span class="fc" id="L842">            chLocal = next();</span>

<span class="pc bpc" id="L844" title="1 of 2 branches missed.">            if (chLocal &lt; identifierFlags.length) {</span>
<span class="fc bfc" id="L845" title="All 2 branches covered.">                if (!identifierFlags[chLocal]) {</span>
<span class="fc" id="L846">                    break;</span>
                }
            }

<span class="fc" id="L850">            hash = 31 * hash + chLocal;</span>

<span class="fc" id="L852">            sp++;</span>
            continue;
        }

<span class="fc" id="L856">        this.ch = charAt(bp);</span>
<span class="fc" id="L857">        token = JSONToken.IDENTIFIER;</span>

<span class="fc" id="L859">        final int NULL_HASH = 3392903;</span>
<span class="pc bpc" id="L860" title="3 of 10 branches missed.">        if (sp == 4 &amp;&amp; hash == NULL_HASH &amp;&amp; charAt(np) == 'n' &amp;&amp; charAt(np + 1) == 'u' &amp;&amp; charAt(np + 2) == 'l'</span>
<span class="pc bpc" id="L861" title="1 of 2 branches missed.">                &amp;&amp; charAt(np + 3) == 'l') {</span>
<span class="fc" id="L862">            return null;</span>
        }

        // return text.substring(np, np + sp).intern();

<span class="pc bpc" id="L867" title="1 of 2 branches missed.">        if (symbolTable == null) {</span>
<span class="nc" id="L868">            return subString(np, sp);</span>
        }

<span class="fc" id="L871">        return this.addSymbol(np, sp, hash, symbolTable);</span>
        // return symbolTable.addSymbol(buf, np, sp, hash);
    }

    protected abstract void copyTo(int offset, int count, char[] dest);

    public final void scanString() {
<span class="fc" id="L878">        np = bp;</span>
<span class="fc" id="L879">        hasSpecial = false;</span>
        char ch;
<span class="fc" id="L881">        for (;;) {</span>
<span class="fc" id="L882">            ch = next();</span>

<span class="fc bfc" id="L884" title="All 2 branches covered.">            if (ch == '\&quot;') {</span>
<span class="fc" id="L885">                break;</span>
            }

<span class="fc bfc" id="L888" title="All 2 branches covered.">            if (ch == EOI) {</span>
<span class="fc bfc" id="L889" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L890">                    putChar((char) EOI);</span>
<span class="fc" id="L891">                    continue;</span>
                }
<span class="fc" id="L893">                throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
            }

<span class="fc bfc" id="L896" title="All 2 branches covered.">            if (ch == '\\') {</span>
<span class="fc bfc" id="L897" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L898">                    hasSpecial = true;</span>

<span class="pc bpc" id="L900" title="1 of 2 branches missed.">                    if (sp &gt;= sbuf.length) {</span>
<span class="nc" id="L901">                        int newCapcity = sbuf.length * 2;</span>
<span class="nc bnc" id="L902" title="All 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L903">                            newCapcity = sp;</span>
                        }
<span class="nc" id="L905">                        char[] newsbuf = new char[newCapcity];</span>
<span class="nc" id="L906">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L907">                        sbuf = newsbuf;</span>
                    }

<span class="fc" id="L910">                    copyTo(np + 1, sp, sbuf);</span>
                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L915">                ch = next();</span>

<span class="fc bfc" id="L917" title="All 21 branches covered.">                switch (ch) {</span>
                    case '0':
<span class="fc" id="L919">                        putChar('\0');</span>
<span class="fc" id="L920">                        break;</span>
                    case '1':
<span class="fc" id="L922">                        putChar('\1');</span>
<span class="fc" id="L923">                        break;</span>
                    case '2':
<span class="fc" id="L925">                        putChar('\2');</span>
<span class="fc" id="L926">                        break;</span>
                    case '3':
<span class="fc" id="L928">                        putChar('\3');</span>
<span class="fc" id="L929">                        break;</span>
                    case '4':
<span class="fc" id="L931">                        putChar('\4');</span>
<span class="fc" id="L932">                        break;</span>
                    case '5':
<span class="fc" id="L934">                        putChar('\5');</span>
<span class="fc" id="L935">                        break;</span>
                    case '6':
<span class="fc" id="L937">                        putChar('\6');</span>
<span class="fc" id="L938">                        break;</span>
                    case '7':
<span class="fc" id="L940">                        putChar('\7');</span>
<span class="fc" id="L941">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L943">                        putChar('\b');</span>
<span class="fc" id="L944">                        break;</span>
                    case 't': // 9
<span class="fc" id="L946">                        putChar('\t');</span>
<span class="fc" id="L947">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L949">                        putChar('\n');</span>
<span class="fc" id="L950">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L952">                        putChar('\u000B');</span>
<span class="fc" id="L953">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L956">                        putChar('\f');</span>
<span class="fc" id="L957">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L959">                        putChar('\r');</span>
<span class="fc" id="L960">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L962">                        putChar('&quot;');</span>
<span class="fc" id="L963">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L965">                        putChar('\'');</span>
<span class="fc" id="L966">                        break;</span>
                    case '/': // 47
<span class="fc" id="L968">                        putChar('/');</span>
<span class="fc" id="L969">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L971">                        putChar('\\');</span>
<span class="fc" id="L972">                        break;</span>
                    case 'x':
<span class="fc" id="L974">                        char x1 = next();</span>
<span class="fc" id="L975">                        char x2 = next();</span>

<span class="pc bpc" id="L977" title="2 of 6 branches missed.">                        boolean hex1 = (x1 &gt;= '0' &amp;&amp; x1 &lt;= '9')</span>
<span class="pc bpc" id="L978" title="1 of 4 branches missed.">                                || (x1 &gt;= 'a' &amp;&amp; x1 &lt;= 'f')</span>
<span class="pc bpc" id="L979" title="1 of 2 branches missed.">                                || (x1 &gt;= 'A' &amp;&amp; x1 &lt;= 'F');</span>
<span class="pc bpc" id="L980" title="2 of 6 branches missed.">                        boolean hex2 = (x2 &gt;= '0' &amp;&amp; x2 &lt;= '9')</span>
<span class="pc bpc" id="L981" title="1 of 4 branches missed.">                                || (x2 &gt;= 'a' &amp;&amp; x2 &lt;= 'f')</span>
<span class="pc bpc" id="L982" title="1 of 2 branches missed.">                                || (x2 &gt;= 'A' &amp;&amp; x2 &lt;= 'F');</span>
<span class="pc bpc" id="L983" title="1 of 4 branches missed.">                        if (!hex1 || !hex2) {</span>
<span class="fc" id="L984">                            throw new JSONException(&quot;invalid escape character \\x&quot; + x1 + x2);</span>
                        }

<span class="fc" id="L987">                        char x_char = (char) (digits[x1] * 16 + digits[x2]);</span>
<span class="fc" id="L988">                        putChar(x_char);</span>
<span class="fc" id="L989">                        break;</span>
                    case 'u':
<span class="fc" id="L991">                        char u1 = next();</span>
<span class="fc" id="L992">                        char u2 = next();</span>
<span class="fc" id="L993">                        char u3 = next();</span>
<span class="fc" id="L994">                        char u4 = next();</span>
<span class="fc" id="L995">                        int val = Integer.parseInt(new String(new char[] { u1, u2, u3, u4 }), 16);</span>
<span class="fc" id="L996">                        putChar((char) val);</span>
<span class="fc" id="L997">                        break;</span>
                    default:
<span class="fc" id="L999">                        this.ch = ch;</span>
<span class="fc" id="L1000">                        throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
                }
                continue;
            }

<span class="fc bfc" id="L1005" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L1006">                sp++;</span>
<span class="fc" id="L1007">                continue;</span>
            }

<span class="fc bfc" id="L1010" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L1011">                putChar(ch);</span>
<span class="fc" id="L1012">            } else {</span>
<span class="fc" id="L1013">                sbuf[sp++] = ch;</span>
            }
        }

<span class="fc" id="L1017">        token = JSONToken.LITERAL_STRING;</span>
<span class="fc" id="L1018">        this.ch = next();</span>
<span class="fc" id="L1019">    }</span>

    public Calendar getCalendar() {
<span class="fc" id="L1022">        return this.calendar;</span>
    }

    public TimeZone getTimeZone() {
<span class="fc" id="L1026">        return timeZone;</span>
    }

    public void setTimeZone(TimeZone timeZone) {
<span class="fc" id="L1030">        this.timeZone = timeZone;</span>
<span class="fc" id="L1031">    }</span>

    public Locale getLocale() {
<span class="fc" id="L1034">        return locale;</span>
    }

    public void setLocale(Locale locale) {
<span class="fc" id="L1038">        this.locale = locale;</span>
<span class="fc" id="L1039">    }</span>

    public final int intValue() {
<span class="pc bpc" id="L1042" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L1043">            np = 0;</span>
        }

<span class="fc" id="L1046">        int result = 0;</span>
<span class="fc" id="L1047">        boolean negative = false;</span>
<span class="fc" id="L1048">        int i = np, max = np + sp;</span>
        int limit;
        int digit;

<span class="fc bfc" id="L1052" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L1053">            negative = true;</span>
<span class="fc" id="L1054">            limit = Integer.MIN_VALUE;</span>
<span class="fc" id="L1055">            i++;</span>
<span class="fc" id="L1056">        } else {</span>
<span class="fc" id="L1057">            limit = -Integer.MAX_VALUE;</span>
        }
<span class="fc" id="L1059">        long multmin = INT_MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L1060" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L1061">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L1062">            result = -digit;</span>
        }
<span class="fc bfc" id="L1064" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L1066">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L1068" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L1069">                break;</span>
            }

<span class="fc" id="L1072">            digit = chLocal - '0';</span>

<span class="fc bfc" id="L1074" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L1075">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1077">            result *= 10;</span>
<span class="fc bfc" id="L1078" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L1079">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1081">            result -= digit;</span>
        }

<span class="fc bfc" id="L1084" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L1085" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L1086">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L1088">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L1091">            return -result;</span>
        }
    }

    public abstract byte[] bytesValue();

    public void close() {
<span class="fc bfc" id="L1098" title="All 2 branches covered.">        if (sbuf.length &lt;= 1024 * 8) {</span>
<span class="fc" id="L1099">            SBUF_LOCAL.set(sbuf);</span>
        }
<span class="fc" id="L1101">        this.sbuf = null;</span>
<span class="fc" id="L1102">    }</span>

    public final boolean isRef() {
<span class="fc bfc" id="L1105" title="All 2 branches covered.">        if (sp != 4) {</span>
<span class="fc" id="L1106">            return false;</span>
        }

<span class="fc bfc" id="L1109" title="All 2 branches covered.">        return charAt(np + 1) == '$' //</span>
<span class="fc bfc" id="L1110" title="All 2 branches covered.">                &amp;&amp; charAt(np + 2) == 'r' //</span>
<span class="fc bfc" id="L1111" title="All 2 branches covered.">                &amp;&amp; charAt(np + 3) == 'e' //</span>
<span class="fc bfc" id="L1112" title="All 2 branches covered.">                &amp;&amp; charAt(np + 4) == 'f';</span>
    }

    public String scanTypeName(SymbolTable symbolTable) {
<span class="fc" id="L1116">        return null;</span>
    }

<span class="fc" id="L1119">    protected final static char[] typeFieldName = (&quot;\&quot;&quot; + JSON.DEFAULT_TYPE_KEY + &quot;\&quot;:\&quot;&quot;).toCharArray();</span>

    public final int scanType(String type) {
<span class="fc" id="L1122">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1124" title="All 2 branches covered.">        if (!charArrayCompare(typeFieldName)) {</span>
<span class="fc" id="L1125">            return NOT_MATCH_NAME;</span>
        }

<span class="fc" id="L1128">        int bpLocal = this.bp + typeFieldName.length;</span>

<span class="fc" id="L1130">        final int typeLength = type.length();</span>
<span class="fc bfc" id="L1131" title="All 2 branches covered.">        for (int i = 0; i &lt; typeLength; ++i) {</span>
<span class="fc bfc" id="L1132" title="All 2 branches covered.">            if (type.charAt(i) != charAt(bpLocal + i)) {</span>
<span class="fc" id="L1133">                return NOT_MATCH;</span>
            }
        }
<span class="fc" id="L1136">        bpLocal += typeLength;</span>
<span class="fc bfc" id="L1137" title="All 2 branches covered.">        if (charAt(bpLocal) != '&quot;') {</span>
<span class="fc" id="L1138">            return NOT_MATCH;</span>
        }

<span class="fc" id="L1141">        this.ch = charAt(++bpLocal);</span>

<span class="fc bfc" id="L1143" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L1144">            this.ch = charAt(++bpLocal);</span>
<span class="fc" id="L1145">            this.bp = bpLocal;</span>
<span class="fc" id="L1146">            token = JSONToken.COMMA;</span>
<span class="fc" id="L1147">            return VALUE;</span>
<span class="pc bpc" id="L1148" title="1 of 2 branches missed.">        } else if (ch == '}') {</span>
<span class="fc" id="L1149">            ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1150" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L1151">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1152">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1153" title="All 2 branches covered.">            } else if (ch == ']') {</span>
<span class="fc" id="L1154">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1155">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1156" title="All 2 branches covered.">            } else if (ch == '}') {</span>
<span class="fc" id="L1157">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1158">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1159" title="All 2 branches covered.">            } else if (ch == EOI) {</span>
<span class="fc" id="L1160">                token = JSONToken.EOF;</span>
<span class="fc" id="L1161">            } else {</span>
<span class="fc" id="L1162">                return NOT_MATCH;</span>
            }
<span class="fc" id="L1164">            matchStat = END;</span>
        }

<span class="fc" id="L1167">        this.bp = bpLocal;</span>
<span class="fc" id="L1168">        return matchStat;</span>
    }

    public final boolean matchField(char[] fieldName) {
        for (;;) {
<span class="fc bfc" id="L1173" title="All 2 branches covered.">            if (!charArrayCompare(fieldName)) {</span>
<span class="fc bfc" id="L1174" title="All 2 branches covered.">                if (isWhitespace(ch)) {</span>
<span class="fc" id="L1175">                    next();</span>
<span class="fc" id="L1176">                    continue;</span>
                }
<span class="fc" id="L1178">                return false;</span>
            } else {
                break;
            }
        }

<span class="fc" id="L1184">        bp = bp + fieldName.length;</span>
<span class="fc" id="L1185">        ch = charAt(bp);</span>

<span class="fc bfc" id="L1187" title="All 2 branches covered.">        if (ch == '{') {</span>
<span class="fc" id="L1188">            next();</span>
<span class="fc" id="L1189">            token = JSONToken.LBRACE;</span>
<span class="fc bfc" id="L1190" title="All 2 branches covered.">        } else if (ch == '[') {</span>
<span class="fc" id="L1191">            next();</span>
<span class="fc" id="L1192">            token = JSONToken.LBRACKET;</span>
<span class="pc bpc" id="L1193" title="3 of 8 branches missed.">        } else if (ch == 'S' &amp;&amp; charAt(bp + 1) == 'e' &amp;&amp; charAt(bp + 2) == 't' &amp;&amp; charAt(bp + 3) == '[') {</span>
<span class="fc" id="L1194">            bp += 3;</span>
<span class="fc" id="L1195">            ch = charAt(bp);</span>
<span class="fc" id="L1196">            token = JSONToken.SET;</span>
<span class="fc" id="L1197">        } else {</span>
<span class="fc" id="L1198">            nextToken();</span>
        }

<span class="fc" id="L1201">        return true;</span>
    }

    public int matchField(long fieldNameHash) {
<span class="nc" id="L1205">        throw new UnsupportedOperationException();</span>
    }

    public boolean seekArrayToItem(int index) {
<span class="nc" id="L1209">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long fieldNameHash, boolean deepScan) {
<span class="nc" id="L1213">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long[] fieldNameHash) {
<span class="nc" id="L1217">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToFieldDeepScan(long fieldNameHash) {
<span class="nc" id="L1221">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject() {
<span class="nc" id="L1225">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject(boolean valid) {
<span class="nc" id="L1229">        throw new UnsupportedOperationException();</span>
    }

    public void skipArray() {
<span class="nc" id="L1233">        throw new UnsupportedOperationException();</span>
    }

    public abstract int indexOf(char ch, int startIndex);

    public abstract String addSymbol(int offset, int len, int hash, final SymbolTable symbolTable);

    public String scanFieldString(char[] fieldName) {
<span class="fc" id="L1241">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1243" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1244">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1245">            return stringDefaultValue();</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1250">        int offset = fieldName.length;</span>
<span class="fc" id="L1251">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1253" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1254">            matchStat = NOT_MATCH;</span>

<span class="fc" id="L1256">            return stringDefaultValue();</span>
        }

        final String strVal;
        {
<span class="fc" id="L1261">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L1262">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1263" title="All 2 branches covered.">            if (endIndex == -1) {</span>
<span class="fc" id="L1264">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L1267">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L1268">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1269" title="All 2 branches covered.">            if (stringVal.indexOf('\\') != -1) {</span>
<span class="fc" id="L1270">                for (;;) {</span>
<span class="fc" id="L1271">                    int slashCount = 0;</span>
<span class="pc bpc" id="L1272" title="1 of 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1273" title="All 2 branches covered.">                        if (charAt(i) == '\\') {</span>
<span class="fc" id="L1274">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="fc bfc" id="L1279" title="All 2 branches covered.">                    if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1280">                        break;</span>
                    }
<span class="fc" id="L1282">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
                }

<span class="fc" id="L1285">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="fc" id="L1286">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="fc" id="L1288">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L1291">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L1292">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1293">            strVal = stringVal;</span>
        }

<span class="fc bfc" id="L1296" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1297">            bp += offset;</span>
<span class="fc" id="L1298">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1299">            matchStat = VALUE;</span>
<span class="fc" id="L1300">            return strVal;</span>
        }

<span class="pc bpc" id="L1303" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L1304">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1305" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1306">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1307">                bp += offset;</span>
<span class="fc" id="L1308">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1309" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1310">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1311">                bp += offset;</span>
<span class="fc" id="L1312">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1313" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1314">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1315">                bp += offset;</span>
<span class="fc" id="L1316">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1317" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1318">                token = JSONToken.EOF;</span>
<span class="fc" id="L1319">                bp += (offset - 1);</span>
<span class="fc" id="L1320">                ch = EOI;</span>
<span class="fc" id="L1321">            } else {</span>
<span class="fc" id="L1322">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1323">                return stringDefaultValue();</span>
            }
<span class="fc" id="L1325">            matchStat = END;</span>
<span class="fc" id="L1326">        } else {</span>
<span class="nc" id="L1327">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1328">            return stringDefaultValue();</span>
        }

<span class="fc" id="L1331">        return strVal;</span>
    }

    public String scanString(char expectNextChar) {
<span class="fc" id="L1335">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1337">        int offset = 0;</span>
<span class="fc" id="L1338">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1340" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1341" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1342">                offset += 3;</span>
<span class="fc" id="L1343">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1344">            } else {</span>
<span class="fc" id="L1345">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1346">                return null;</span>
            }

<span class="fc bfc" id="L1349" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1350">                bp += offset;</span>
<span class="fc" id="L1351">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1352">                matchStat = VALUE;</span>
<span class="fc" id="L1353">                return null;</span>
            } else {
<span class="fc" id="L1355">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1356">                return null;</span>
            }
        }

        final String strVal;
        for (;;) {
<span class="fc bfc" id="L1362" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1363">                int startIndex = bp + offset;</span>
<span class="fc" id="L1364">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1365" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1366">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1369">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1370" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
<span class="fc" id="L1371">                    for (; ; ) {</span>
<span class="fc" id="L1372">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1373" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1374" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1375">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1380" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1381">                            break;</span>
                        }
<span class="fc" id="L1383">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
                    }

<span class="fc" id="L1386">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1387">                    char[] chars = sub_chars(bp + 1, chars_len);</span>

<span class="fc" id="L1389">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1392">                offset += (endIndex - startIndex + 1);</span>
<span class="fc" id="L1393">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1394">                strVal = stringVal;</span>
<span class="fc" id="L1395">                break;</span>
<span class="fc bfc" id="L1396" title="All 2 branches covered.">            } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1397">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1398">                continue;</span>
            } else {
<span class="fc" id="L1400">                matchStat = NOT_MATCH;</span>

<span class="fc" id="L1402">                return stringDefaultValue();</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1407" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1408">                bp += offset;</span>
<span class="fc" id="L1409">                this.ch = charAt(bp);</span>
<span class="fc" id="L1410">                matchStat = VALUE;</span>
<span class="fc" id="L1411">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1412">                return strVal;</span>
<span class="pc bpc" id="L1413" title="1 of 2 branches missed.">            } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L1414">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1415">                continue;</span>
            } else {
<span class="fc bfc" id="L1417" title="All 2 branches covered.">                if (chLocal == ']') {</span>
<span class="fc" id="L1418">                    bp += offset;</span>
<span class="fc" id="L1419">                    this.ch = charAt(bp);</span>
<span class="fc" id="L1420">                    matchStat = NOT_MATCH;</span>
                }
<span class="fc" id="L1422">                return strVal;</span>
            }
        }
    }

    public long scanFieldSymbol(char[] fieldName) {
<span class="nc" id="L1428">        matchStat = UNKNOWN;</span>

<span class="nc bnc" id="L1430" title="All 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1431">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1432">            return 0;</span>
        }

<span class="nc" id="L1435">        int offset = fieldName.length;</span>
<span class="nc" id="L1436">        char chLocal = charAt(bp + (offset++));</span>

<span class="nc bnc" id="L1438" title="All 2 branches missed.">        if (chLocal != '&quot;') {</span>
<span class="nc" id="L1439">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1440">            return 0;</span>
        }

<span class="nc" id="L1443">        long hash = 0xcbf29ce484222325L;</span>
        for (;;) {
<span class="nc" id="L1445">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1446" title="All 2 branches missed.">            if (chLocal == '\&quot;') {</span>
<span class="nc" id="L1447">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1448">                break;</span>
            }

<span class="nc" id="L1451">            hash ^= chLocal;</span>
<span class="nc" id="L1452">            hash *= 0x100000001b3L;</span>

<span class="nc bnc" id="L1454" title="All 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1455">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1456">                return 0;</span>
            }
        }

<span class="nc bnc" id="L1460" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L1461">            bp += offset;</span>
<span class="nc" id="L1462">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L1463">            matchStat = VALUE;</span>
<span class="nc" id="L1464">            return hash;</span>
        }

<span class="nc bnc" id="L1467" title="All 2 branches missed.">        if (chLocal == '}') {</span>
<span class="nc" id="L1468">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1469" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L1470">                token = JSONToken.COMMA;</span>
<span class="nc" id="L1471">                bp += offset;</span>
<span class="nc" id="L1472">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1473" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L1474">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L1475">                bp += offset;</span>
<span class="nc" id="L1476">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1477" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L1478">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L1479">                bp += offset;</span>
<span class="nc" id="L1480">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1481" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L1482">                token = JSONToken.EOF;</span>
<span class="nc" id="L1483">                bp += (offset - 1);</span>
<span class="nc" id="L1484">                ch = EOI;</span>
<span class="nc" id="L1485">            } else {</span>
<span class="nc" id="L1486">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1487">                return 0;</span>
            }
<span class="nc" id="L1489">            matchStat = END;</span>
<span class="nc" id="L1490">        } else {</span>
<span class="nc" id="L1491">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1492">            return 0;</span>
        }

<span class="nc" id="L1495">        return hash;</span>
    }

    public long scanEnumSymbol(char[] fieldName) {
<span class="fc" id="L1499">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1501" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1502">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1503">            return 0;</span>
        }

<span class="fc" id="L1506">        int offset = fieldName.length;</span>
<span class="fc" id="L1507">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1509" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1510">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1511">            return 0;</span>
        }

<span class="fc" id="L1514">        long hash = 0xcbf29ce484222325L;</span>
        for (;;) {
<span class="fc" id="L1516">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1517" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
<span class="fc" id="L1518">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1519">                break;</span>
            }

<span class="fc bfc" id="L1522" title="All 4 branches covered.">            hash ^= ((chLocal &gt;= 'A' &amp;&amp; chLocal &lt;= 'Z') ? (chLocal + 32) : chLocal);</span>
<span class="fc" id="L1523">            hash *= 0x100000001b3L;</span>

<span class="fc bfc" id="L1525" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc" id="L1526">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1527">                return 0;</span>
            }
        }

<span class="fc bfc" id="L1531" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1532">            bp += offset;</span>
<span class="fc" id="L1533">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1534">            matchStat = VALUE;</span>
<span class="fc" id="L1535">            return hash;</span>
        }

<span class="fc bfc" id="L1538" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1539">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1540" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1541">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1542">                bp += offset;</span>
<span class="fc" id="L1543">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1544" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1545">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1546">                bp += offset;</span>
<span class="fc" id="L1547">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1548" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1549">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1550">                bp += offset;</span>
<span class="fc" id="L1551">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1552" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1553">                token = JSONToken.EOF;</span>
<span class="fc" id="L1554">                bp += (offset - 1);</span>
<span class="fc" id="L1555">                ch = EOI;</span>
<span class="fc" id="L1556">            } else {</span>
<span class="fc" id="L1557">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1558">                return 0;</span>
            }
<span class="fc" id="L1560">            matchStat = END;</span>
<span class="fc" id="L1561">        } else {</span>
<span class="fc" id="L1562">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1563">            return 0;</span>
        }

<span class="fc" id="L1566">        return hash;</span>
    }

    @SuppressWarnings({ &quot;unchecked&quot;, &quot;rawtypes&quot; })
    public Enum&lt;?&gt; scanEnum(Class&lt;?&gt; enumClass, final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1571">        String name = scanSymbolWithSeperator(symbolTable, serperator);</span>
<span class="fc bfc" id="L1572" title="All 2 branches covered.">        if (name == null) {</span>
<span class="fc" id="L1573">            return null;</span>
        }
<span class="fc" id="L1575">        return Enum.valueOf((Class&lt;? extends Enum&gt;) enumClass, name);</span>
    }

    public String scanSymbolWithSeperator(final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1579">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1581">        int offset = 0;</span>
<span class="fc" id="L1582">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1584" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1585" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1586">                offset += 3;</span>
<span class="fc" id="L1587">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1588">            } else {</span>
<span class="fc" id="L1589">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1590">                return null;</span>
            }

<span class="fc bfc" id="L1593" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1594">                bp += offset;</span>
<span class="fc" id="L1595">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1596">                matchStat = VALUE;</span>
<span class="fc" id="L1597">                return null;</span>
            } else {
<span class="fc" id="L1599">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1600">                return null;</span>
            }
        }

<span class="fc bfc" id="L1604" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1605">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1606">            return null;</span>
        }

        String strVal;
        // int start = index;
<span class="fc" id="L1611">        int hash = 0;</span>
        for (;;) {
<span class="fc" id="L1613">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1614" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
                // bp = index;
                // this.ch = chLocal = charAt(bp);
<span class="fc" id="L1617">                int start = bp + 0 + 1;</span>
<span class="fc" id="L1618">                int len = bp + offset - start - 1;</span>
<span class="fc" id="L1619">                strVal = addSymbol(start, len, hash, symbolTable);</span>
<span class="fc" id="L1620">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1621">                break;</span>
            }

<span class="fc" id="L1624">            hash = 31 * hash + chLocal;</span>

<span class="pc bpc" id="L1626" title="1 of 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1627">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1628">                return null;</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1633" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1634">                bp += offset;</span>
<span class="fc" id="L1635">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1636">                matchStat = VALUE;</span>
<span class="fc" id="L1637">                return strVal;</span>
            } else {
<span class="pc bpc" id="L1639" title="1 of 2 branches missed.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1640">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1641">                    continue;</span>
                }

<span class="nc" id="L1644">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1645">                return strVal;</span>
            }
        }
    }

    public Collection&lt;String&gt; newCollectionByType(Class&lt;?&gt; type){
<span class="fc bfc" id="L1651" title="All 2 branches covered.">        if (type.isAssignableFrom(HashSet.class)) {</span>
<span class="fc" id="L1652">            return new HashSet&lt;String&gt;();</span>
<span class="fc bfc" id="L1653" title="All 2 branches covered.">        } else if (type.isAssignableFrom(ArrayList.class)) {</span>
<span class="fc" id="L1654">            return new ArrayList&lt;String&gt;();</span>
<span class="fc bfc" id="L1655" title="All 2 branches covered.">        } else if (type.isAssignableFrom(LinkedList.class)) {</span>
<span class="fc" id="L1656">            return new LinkedList&lt;String&gt;();</span>
        } else {
            try {
<span class="fc" id="L1659">                return (Collection&lt;String&gt;) type.newInstance();</span>
<span class="fc" id="L1660">            } catch (Exception e) {</span>
<span class="fc" id="L1661">                throw new JSONException(e.getMessage(), e);</span>
            }
        }
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    public Collection&lt;String&gt; scanFieldStringArray(char[] fieldName, Class&lt;?&gt; type) {
<span class="fc" id="L1668">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1670" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1671">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1672">            return null;</span>
        }

<span class="fc" id="L1675">        Collection&lt;String&gt; list = newCollectionByType(type);</span>

//        if (type.isAssignableFrom(HashSet.class)) {
//            list = new HashSet&lt;String&gt;();
//        } else if (type.isAssignableFrom(ArrayList.class)) {
//            list = new ArrayList&lt;String&gt;();
//        } else {
//            try {
//                list = (Collection&lt;String&gt;) type.newInstance();
//            } catch (Exception e) {
//                throw new JSONException(e.getMessage(), e);
//            }
//        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1691">        int offset = fieldName.length;</span>
<span class="fc" id="L1692">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1694" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1695">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1696">            return null;</span>
        }

<span class="fc" id="L1699">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
            // int start = index;
<span class="fc bfc" id="L1703" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1704">                int startIndex = bp + offset;</span>
<span class="fc" id="L1705">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1706" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1707">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1710">                int startIndex2 = bp + offset; // must re compute</span>
<span class="fc" id="L1711">                String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1712" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
<span class="fc" id="L1713">                    for (;;) {</span>
<span class="fc" id="L1714">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1715" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1716" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1717">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1722" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1723">                            break;</span>
                        }
<span class="fc" id="L1725">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
                    }

<span class="fc" id="L1728">                    int chars_len = endIndex - (bp + offset);</span>
<span class="fc" id="L1729">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1731">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1734">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1735">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1737">                list.add(stringVal);</span>
<span class="fc bfc" id="L1738" title="All 2 branches covered.">            } else if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1739" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1740" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1741" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1742">                offset += 3;</span>
<span class="fc" id="L1743">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1744">                list.add(null);</span>
<span class="fc bfc" id="L1745" title="All 4 branches covered.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1746">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1747">                break;</span>
            } else {
<span class="fc" id="L1749">                throw new JSONException(&quot;illega str&quot;);</span>
            }

<span class="fc bfc" id="L1752" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1753">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1754">                continue;</span>
            }

<span class="fc bfc" id="L1757" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1758">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1759">                break;</span>
            }

<span class="fc" id="L1762">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1763">            return null;</span>
        }

<span class="fc bfc" id="L1766" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1767">            bp += offset;</span>
<span class="fc" id="L1768">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1769">            matchStat = VALUE;</span>
<span class="fc" id="L1770">            return list;</span>
        }

<span class="fc bfc" id="L1773" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1774">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1775" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1776">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1777">                bp += offset;</span>
<span class="fc" id="L1778">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1779" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1780">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1781">                bp += offset;</span>
<span class="fc" id="L1782">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1783" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1784">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1785">                bp += offset;</span>
<span class="fc" id="L1786">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1787" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1788">                bp += (offset - 1);</span>
<span class="fc" id="L1789">                token = JSONToken.EOF;</span>
<span class="fc" id="L1790">                this.ch = EOI;</span>
<span class="fc" id="L1791">            } else {</span>
<span class="fc" id="L1792">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1793">                return null;</span>
            }
<span class="fc" id="L1795">            matchStat = END;</span>
<span class="fc" id="L1796">        } else {</span>
<span class="fc" id="L1797">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1798">            return null;</span>
        }

<span class="fc" id="L1801">        return list;</span>
    }

    public void scanStringArray(Collection&lt;String&gt; list, char seperator) {
<span class="fc" id="L1805">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1807">        int offset = 0;</span>
<span class="fc" id="L1808">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1810" title="All 2 branches covered.">        if (chLocal == 'n'</span>
<span class="fc bfc" id="L1811" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset) == 'u'</span>
<span class="fc bfc" id="L1812" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 1) == 'l'</span>
<span class="fc bfc" id="L1813" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 2) == 'l'</span>
<span class="fc bfc" id="L1814" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 3) == seperator</span>
        ) {
<span class="fc" id="L1816">            bp += 5;</span>
<span class="fc" id="L1817">            ch = charAt(bp);</span>
<span class="fc" id="L1818">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L1819">            return;</span>
        }

<span class="fc bfc" id="L1822" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1823">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1824">            return;</span>
        }

<span class="fc" id="L1827">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
<span class="fc bfc" id="L1830" title="All 2 branches covered.">            if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1831" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1832" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1833" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1834">                offset += 3;</span>
<span class="fc" id="L1835">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1836">                list.add(null);</span>
<span class="pc bpc" id="L1837" title="1 of 4 branches missed.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1838">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1839">                break;</span>
<span class="fc bfc" id="L1840" title="All 2 branches covered.">            } else if (chLocal != '&quot;') {</span>
<span class="fc" id="L1841">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1842">                return;</span>
            } else {
<span class="fc" id="L1844">                int startIndex = bp + offset;</span>
<span class="fc" id="L1845">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1846" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1847">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1850">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1851" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
<span class="fc" id="L1852">                    for (;;) {</span>
<span class="fc" id="L1853">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1854" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1855" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1856">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1861" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1862">                            break;</span>
                        }
<span class="fc" id="L1864">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
                    }

<span class="fc" id="L1867">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1868">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1870">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1873">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1874">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1875">                list.add(stringVal);</span>
            }

<span class="fc bfc" id="L1878" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1879">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1880">                continue;</span>
            }

<span class="fc bfc" id="L1883" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1884">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1885">                break;</span>
            }

<span class="fc" id="L1888">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1889">            return;</span>
        }

<span class="fc bfc" id="L1892" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L1893">            bp += offset;</span>
<span class="fc" id="L1894">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1895">            matchStat = VALUE;</span>
<span class="fc" id="L1896">            return;</span>
        } else {
<span class="fc" id="L1898">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1899">            return;</span>
        }
    }

    public int scanFieldInt(char[] fieldName) {
<span class="fc" id="L1904">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1906" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1907">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1908">            return 0;</span>
        }

<span class="fc" id="L1911">        int offset = fieldName.length;</span>
<span class="fc" id="L1912">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1914" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L1915" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L1916">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="pc bpc" id="L1920" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1921">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L1923">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1924" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1925">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L1926" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L1927">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1928">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L1933" title="All 2 branches covered.">            if (value &lt; 0 //</span>
<span class="fc bfc" id="L1934" title="All 2 branches covered.">                    || offset &gt; 11 + 3 + fieldName.length) {</span>
<span class="fc bfc" id="L1935" title="All 2 branches covered.">                if (value != Integer.MIN_VALUE //</span>
<span class="fc bfc" id="L1936" title="All 2 branches covered.">                        || offset != 17 //</span>
<span class="pc bpc" id="L1937" title="1 of 2 branches missed.">                        || !negative) {</span>
<span class="fc" id="L1938">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1939">                    return 0;</span>
                }
            }
        } else {
<span class="fc" id="L1943">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1944">            return 0;</span>
        }

<span class="fc bfc" id="L1947" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1948">            bp += offset;</span>
<span class="fc" id="L1949">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1950">            matchStat = VALUE;</span>
<span class="fc" id="L1951">            token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L1952" title="All 2 branches covered.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L1955" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1956">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1957" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1958">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1959">                bp += offset;</span>
<span class="fc" id="L1960">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1961" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1962">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1963">                bp += offset;</span>
<span class="fc" id="L1964">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1965" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1966">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1967">                bp += offset;</span>
<span class="fc" id="L1968">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1969" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1970">                token = JSONToken.EOF;</span>
<span class="fc" id="L1971">                bp += (offset - 1);</span>
<span class="fc" id="L1972">                ch = EOI;</span>
<span class="fc" id="L1973">            } else {</span>
<span class="fc" id="L1974">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1975">                return 0;</span>
            }
<span class="fc" id="L1977">            matchStat = END;</span>
<span class="fc" id="L1978">        } else {</span>
<span class="fc" id="L1979">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1980">            return 0;</span>
        }

<span class="fc bfc" id="L1983" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public final int[] scanFieldIntArray(char[] fieldName) {
<span class="fc" id="L1987">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L1989" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1990">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1991">            return null;</span>
        }

<span class="fc" id="L1994">        int offset = fieldName.length;</span>
<span class="fc" id="L1995">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1997" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1998">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1999">            return null;</span>
        }
<span class="fc" id="L2001">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2003">        int[] array = new int[16];</span>
<span class="fc" id="L2004">        int arrayIndex = 0;</span>

<span class="pc bpc" id="L2006" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L2007">            chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L2008">        } else {</span>
            for (;;) {
<span class="fc" id="L2010">                boolean nagative = false;</span>
<span class="pc bpc" id="L2011" title="1 of 2 branches missed.">                if (chLocal == '-') {</span>
<span class="nc" id="L2012">                    chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L2013">                    nagative = true;</span>
                }
<span class="pc bpc" id="L2015" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2016">                    int value = chLocal - '0';</span>
<span class="fc" id="L2017">                    for (; ; ) {</span>
<span class="fc" id="L2018">                        chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2020" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2021">                            value = value * 10 + (chLocal - '0');</span>
                        } else {
                            break;
                        }
                    }

<span class="pc bpc" id="L2027" title="1 of 2 branches missed.">                    if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L2028">                        int[] tmp = new int[array.length * 3 / 2];</span>
<span class="nc" id="L2029">                        System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L2030">                        array = tmp;</span>
                    }
<span class="pc bpc" id="L2032" title="1 of 2 branches missed.">                    array[arrayIndex++] = nagative ? -value : value;</span>

<span class="fc bfc" id="L2034" title="All 2 branches covered.">                    if (chLocal == ',') {</span>
<span class="fc" id="L2035">                        chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2036" title="1 of 2 branches missed.">                    } else if (chLocal == ']') {</span>
<span class="fc" id="L2037">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2038">                        break;</span>
                    }
                } else {
<span class="fc" id="L2041">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2042">                    return null;</span>
                }
            }
        }


<span class="pc bpc" id="L2048" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L2049">            int[] tmp = new int[arrayIndex];</span>
<span class="fc" id="L2050">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L2051">            array = tmp;</span>
        }

<span class="pc bpc" id="L2054" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L2055">            bp += (offset - 1);</span>
<span class="nc" id="L2056">            this.next();</span>
<span class="nc" id="L2057">            matchStat = VALUE;</span>
<span class="nc" id="L2058">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2059">            return array;</span>
        }

<span class="pc bpc" id="L2062" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2063">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2064" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2065">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2066">                bp += (offset - 1);</span>
<span class="fc" id="L2067">                this.next();</span>
<span class="fc bfc" id="L2068" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2069">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2070">                bp += (offset - 1);</span>
<span class="fc" id="L2071">                this.next();</span>
<span class="pc bpc" id="L2072" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L2073">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L2074">                bp += (offset - 1);</span>
<span class="nc" id="L2075">                this.next();</span>
<span class="pc bpc" id="L2076" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2077">                bp += (offset - 1);</span>
<span class="fc" id="L2078">                token = JSONToken.EOF;</span>
<span class="fc" id="L2079">                ch = EOI;</span>
<span class="fc" id="L2080">            } else {</span>
<span class="nc" id="L2081">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2082">                return null;</span>
            }
<span class="fc" id="L2084">            matchStat = END;</span>
<span class="fc" id="L2085">        } else {</span>
<span class="nc" id="L2086">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2087">            return null;</span>
        }

<span class="fc" id="L2090">        return array;</span>
    }

    public boolean scanBoolean(char expectNext) {
<span class="fc" id="L2094">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2096">        int offset = 0;</span>
<span class="fc" id="L2097">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2099">        boolean value = false;</span>
<span class="fc bfc" id="L2100" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2101" title="All 2 branches covered.">            if (charAt(bp + offset) == 'r' //</span>
<span class="fc bfc" id="L2102" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'u' //</span>
<span class="fc bfc" id="L2103" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'e') {</span>
<span class="fc" id="L2104">                offset += 3;</span>
<span class="fc" id="L2105">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2106">                value = true;</span>
<span class="fc" id="L2107">            } else {</span>
<span class="fc" id="L2108">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2109">                return false;</span>
            }
<span class="fc bfc" id="L2111" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2112" title="All 2 branches covered.">            if (charAt(bp + offset) == 'a' //</span>
<span class="fc bfc" id="L2113" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L2114" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 's' //</span>
<span class="fc bfc" id="L2115" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 3) == 'e') {</span>
<span class="fc" id="L2116">                offset += 4;</span>
<span class="fc" id="L2117">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2118">                value = false;</span>
<span class="fc" id="L2119">            } else {</span>
<span class="fc" id="L2120">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2121">                return false;</span>
            }
<span class="fc bfc" id="L2123" title="All 2 branches covered.">        } else if (chLocal == '1') {</span>
<span class="fc" id="L2124">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2125">            value = true;</span>
<span class="pc bpc" id="L2126" title="1 of 2 branches missed.">        } else if (chLocal == '0') {</span>
<span class="fc" id="L2127">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2128">            value = false;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2132" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2133">                bp += offset;</span>
<span class="fc" id="L2134">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2135">                matchStat = VALUE;</span>
<span class="fc" id="L2136">                return value;</span>
            } else {
<span class="fc bfc" id="L2138" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2139">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2140">                    continue;</span>
                }
<span class="fc" id="L2142">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2143">                return value;</span>
            }
        }
    }

    public int scanInt(char expectNext) {
<span class="fc" id="L2149">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2151">        int offset = 0;</span>
<span class="fc" id="L2152">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2154" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2155" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2156">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2159" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2160" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2161">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="fc bfc" id="L2165" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2166">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2168">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2169" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2170">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2171" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2172">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2173">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L2178" title="All 2 branches covered.">            if (value &lt; 0) {</span>
<span class="fc" id="L2179">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2180">                return 0;</span>
            }
<span class="pc bpc" id="L2182" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2183">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2184">            value = 0;</span>
<span class="fc" id="L2185">            offset += 3;</span>
<span class="fc" id="L2186">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2188" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2189">                chLocal = charAt(bp + offset++);</span>
            }

<span class="fc" id="L2192">            for (;;) {</span>
<span class="fc bfc" id="L2193" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2194">                    bp += offset;</span>
<span class="fc" id="L2195">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2196">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2197">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2198">                    return value;</span>
<span class="fc bfc" id="L2199" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2200">                    bp += offset;</span>
<span class="fc" id="L2201">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2202">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2203">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2204">                    return value;</span>
<span class="pc bpc" id="L2205" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2206">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L2211">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2212">            return 0;</span>
        } else {
<span class="fc" id="L2214">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2215">            return 0;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2219" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2220">                bp += offset;</span>
<span class="fc" id="L2221">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2222">                matchStat = VALUE;</span>
<span class="fc" id="L2223">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2224" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2226" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2227">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2228">                    continue;</span>
                }
<span class="fc" id="L2230">                matchStat = NOT_MATCH;</span>
<span class="fc bfc" id="L2231" title="All 2 branches covered.">                return negative ? -value : value;</span>
            }
        }
    }

    public boolean scanFieldBoolean(char[] fieldName) {
<span class="fc" id="L2237">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2239" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2240">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2241">            return false;</span>
        }

<span class="fc" id="L2244">        int offset = fieldName.length;</span>
<span class="fc" id="L2245">        char chLocal = charAt(bp + (offset++));</span>

        boolean value;
<span class="fc bfc" id="L2248" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2249" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'r') {</span>
<span class="fc" id="L2250">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2251">                return false;</span>
            }
<span class="fc bfc" id="L2253" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'u') {</span>
<span class="fc" id="L2254">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2255">                return false;</span>
            }
<span class="fc bfc" id="L2257" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2258">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2259">                return false;</span>
            }

<span class="fc" id="L2262">            value = true;</span>
<span class="fc bfc" id="L2263" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2264" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'a') {</span>
<span class="fc" id="L2265">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2266">                return false;</span>
            }
<span class="fc bfc" id="L2268" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'l') {</span>
<span class="fc" id="L2269">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2270">                return false;</span>
            }
<span class="fc bfc" id="L2272" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 's') {</span>
<span class="fc" id="L2273">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2274">                return false;</span>
            }
<span class="fc bfc" id="L2276" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2277">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2278">                return false;</span>
            }

<span class="fc" id="L2281">            value = false;</span>
<span class="fc" id="L2282">        } else {</span>
<span class="fc" id="L2283">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2284">            return false;</span>
        }

<span class="fc" id="L2287">        chLocal = charAt(bp + offset++);</span>
<span class="fc bfc" id="L2288" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2289">            bp += offset;</span>
<span class="fc" id="L2290">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2291">            matchStat = VALUE;</span>
<span class="fc" id="L2292">            token = JSONToken.COMMA;</span>

<span class="fc" id="L2294">            return value;</span>
        }

<span class="pc bpc" id="L2297" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2298">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2299" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2300">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2301">                bp += offset;</span>
<span class="fc" id="L2302">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2303" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2304">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2305">                bp += offset;</span>
<span class="fc" id="L2306">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2307" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2308">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2309">                bp += offset;</span>
<span class="fc" id="L2310">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2311" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2312">                token = JSONToken.EOF;</span>
<span class="fc" id="L2313">                bp += (offset - 1);</span>
<span class="fc" id="L2314">                ch = EOI;</span>
<span class="fc" id="L2315">            } else {</span>
<span class="fc" id="L2316">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2317">                return false;</span>
            }
<span class="fc" id="L2319">            matchStat = END;</span>
<span class="fc" id="L2320">        } else {</span>
<span class="nc" id="L2321">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2322">            return false;</span>
        }

<span class="fc" id="L2325">        return value;</span>
    }

    public long scanFieldLong(char[] fieldName) {
<span class="fc" id="L2329">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2331" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2332">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2333">            return 0;</span>
        }

<span class="fc" id="L2336">        int offset = fieldName.length;</span>
<span class="fc" id="L2337">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2339">        boolean negative = false;</span>
<span class="fc bfc" id="L2340" title="All 2 branches covered.">        if (chLocal == '-') {</span>
<span class="fc" id="L2341">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2342">            negative = true;</span>
        }

        long value;
<span class="fc bfc" id="L2346" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2347">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2349">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2350" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2351">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2352" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2353">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2354">                    return 0;</span>
                } else {
                    break;
                }
            }

<span class="fc bfc" id="L2360" title="All 2 branches covered.">            boolean valid = offset - fieldName.length &lt; 21</span>
<span class="pc bpc" id="L2361" title="2 of 6 branches missed.">                    &amp;&amp; (value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative));</span>
<span class="fc bfc" id="L2362" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2363">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2364">                return 0;</span>
            }
        } else {
<span class="fc" id="L2367">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2368">            return 0;</span>
        }

<span class="fc bfc" id="L2371" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2372">            bp += offset;</span>
<span class="fc" id="L2373">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2374">            matchStat = VALUE;</span>
<span class="fc" id="L2375">            token = JSONToken.COMMA;</span>
<span class="pc bpc" id="L2376" title="1 of 2 branches missed.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L2379" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2380">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2381" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2382">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2383">                bp += offset;</span>
<span class="fc" id="L2384">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2385" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2386">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2387">                bp += offset;</span>
<span class="fc" id="L2388">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2389" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2390">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2391">                bp += offset;</span>
<span class="fc" id="L2392">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2393" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2394">                token = JSONToken.EOF;</span>
<span class="fc" id="L2395">                bp += (offset - 1);</span>
<span class="fc" id="L2396">                ch = EOI;</span>
<span class="fc" id="L2397">            } else {</span>
<span class="fc" id="L2398">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2399">                return 0;</span>
            }
<span class="fc" id="L2401">            matchStat = END;</span>
<span class="fc" id="L2402">        } else {</span>
<span class="fc" id="L2403">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2404">            return 0;</span>
        }

<span class="fc bfc" id="L2407" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public long scanLong(char expectNextChar) {
<span class="fc" id="L2411">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2413">        int offset = 0;</span>
<span class="fc" id="L2414">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2415" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2416" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2417">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2420" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2421" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2422">            chLocal = charAt(bp + (offset++));</span>
        }

        long value;
<span class="fc bfc" id="L2426" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2427">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2429">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2430" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2431">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2432" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2433">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2434">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="pc bpc" id="L2439" title="1 of 6 branches missed.">            boolean valid = value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative);</span>
<span class="fc bfc" id="L2440" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2441">                String val = subString(bp, offset - 1);</span>
<span class="fc" id="L2442">                throw new NumberFormatException(val);</span>
            }
<span class="pc bpc" id="L2444" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2445">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2446">            value = 0;</span>
<span class="fc" id="L2447">            offset += 3;</span>
<span class="fc" id="L2448">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2450" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2451">                chLocal = charAt(bp + offset++);</span>
            }

<span class="fc" id="L2454">            for (;;) {</span>
<span class="fc bfc" id="L2455" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2456">                    bp += offset;</span>
<span class="fc" id="L2457">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2458">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2459">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2460">                    return value;</span>
<span class="fc bfc" id="L2461" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2462">                    bp += offset;</span>
<span class="fc" id="L2463">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2464">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2465">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2466">                    return value;</span>
<span class="pc bpc" id="L2467" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2468">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L2473">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2474">            return 0;</span>
        } else {
<span class="fc" id="L2476">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2477">            return 0;</span>
        }

<span class="fc bfc" id="L2480" title="All 2 branches covered.">        if (quote) {</span>
<span class="pc bpc" id="L2481" title="1 of 2 branches missed.">            if (chLocal != '&quot;') {</span>
<span class="nc" id="L2482">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2483">                return 0;</span>
            } else {
<span class="fc" id="L2485">                chLocal = charAt(bp + (offset++));</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L2490" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L2491">                bp += offset;</span>
<span class="fc" id="L2492">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2493">                matchStat = VALUE;</span>
<span class="fc" id="L2494">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2495" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2497" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2498">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2499">                    continue;</span>
                }

<span class="fc" id="L2502">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2503">                return value;</span>
            }
        }
    }

    public final float scanFieldFloat(char[] fieldName) {
<span class="fc" id="L2509">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2511" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2512">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2513">            return 0;</span>
        }

<span class="fc" id="L2516">        int offset = fieldName.length;</span>
<span class="fc" id="L2517">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2519" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2520" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2521">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2524" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2525" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2526">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="fc bfc" id="L2530" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2531">            long intVal = chLocal - '0';</span>
<span class="fc" id="L2532">            for (;;) {</span>
<span class="fc" id="L2533">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2534" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2535">                    intVal = intVal * 10 + (chLocal - '0');</span>
                    continue;
                } else {
                    break;
                }
            }

<span class="fc" id="L2542">            long power = 1;</span>
<span class="fc bfc" id="L2543" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2544" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2545">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2546" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2547">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2548">                    power = 10;</span>
<span class="fc" id="L2549">                    for (;;) {</span>
<span class="fc" id="L2550">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2551" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2552">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2553">                            power *= 10;</span>
                            continue;
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2560">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2561">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2565" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2566" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2567">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2568" title="1 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2569">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2571">                for (;;) {</span>
<span class="pc bpc" id="L2572" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2573">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L2581" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2582" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2583">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2584">                    return 0;</span>
                } else {
<span class="fc" id="L2586">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2588">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L2589">                count = bp + offset - start - 2;</span>
<span class="fc" id="L2590">            } else {</span>
<span class="fc" id="L2591">                start = bp + fieldName.length;</span>
<span class="fc" id="L2592">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2595" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2596">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2597" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2598">                    value = -value;</span>
                }
<span class="fc" id="L2600">            } else {</span>
<span class="fc" id="L2601">                String text = this.subString(start, count);</span>
<span class="fc" id="L2602">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2604" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2605">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2606">            value = 0;</span>
<span class="fc" id="L2607">            offset += 3;</span>
<span class="fc" id="L2608">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2610" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2611">                chLocal = charAt(bp + offset++);</span>
            }

<span class="fc" id="L2614">            for (;;) {</span>
<span class="fc bfc" id="L2615" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2616">                    bp += offset;</span>
<span class="fc" id="L2617">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2618">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2619">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2620">                    return value;</span>
<span class="fc bfc" id="L2621" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L2622">                    bp += offset;</span>
<span class="fc" id="L2623">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2624">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2625">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L2626">                    return value;</span>
<span class="pc bpc" id="L2627" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2628">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L2633">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2634">            return 0;</span>
        } else {
<span class="fc" id="L2636">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2637">            return 0;</span>
        }

<span class="fc bfc" id="L2640" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2641">            bp += offset;</span>
<span class="fc" id="L2642">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2643">            matchStat = VALUE;</span>
<span class="fc" id="L2644">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2645">            return value;</span>
        }

<span class="fc bfc" id="L2648" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2649">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2650" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2651">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2652">                bp += offset;</span>
<span class="fc" id="L2653">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2654" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2655">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2656">                bp += offset;</span>
<span class="fc" id="L2657">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2658" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2659">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2660">                bp += offset;</span>
<span class="fc" id="L2661">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2662" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2663">                bp += (offset - 1);</span>
<span class="fc" id="L2664">                token = JSONToken.EOF;</span>
<span class="fc" id="L2665">                ch = EOI;</span>
<span class="fc" id="L2666">            } else {</span>
<span class="fc" id="L2667">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2668">                return 0;</span>
            }
<span class="fc" id="L2670">            matchStat = END;</span>
<span class="fc" id="L2671">        } else {</span>
<span class="fc" id="L2672">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2673">            return 0;</span>
        }

<span class="fc" id="L2676">        return value;</span>
    }

    public final float scanFloat(char seperator) {
<span class="fc" id="L2680">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2682">        int offset = 0;</span>
<span class="fc" id="L2683">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2684" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2685" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2686">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2689" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2690" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2691">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="pc bpc" id="L2695" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2696">            long intVal = chLocal - '0';</span>
<span class="fc" id="L2697">            for (; ; ) {</span>
<span class="fc" id="L2698">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2699" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2700">                    intVal = intVal * 10 + (chLocal - '0');</span>
                    continue;
                } else {
                    break;
                }
            }

<span class="fc" id="L2707">            long power = 1;</span>
<span class="fc bfc" id="L2708" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2709" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2710">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2711" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2712">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2713">                    power = 10;</span>
<span class="fc" id="L2714">                    for (; ; ) {</span>
<span class="fc" id="L2715">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2716" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2717">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2718">                            power *= 10;</span>
                            continue;
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2725">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2726">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2730" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2731" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2732">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2733" title="2 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2734">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2736">                for (; ; ) {</span>
<span class="pc bpc" id="L2737" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2738">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }
//            int start, count;
//            if (quote) {
//                if (chLocal != '&quot;') {
//                    matchStat = NOT_MATCH;
//                    return 0;
//                } else {
//                    chLocal = charAt(bp + (offset++));
//                }
//                start = bp + 1;
//                count = bp + offset - start - 2;
//            } else {
//                start = bp;
//                count = bp + offset - start - 1;
//            }
//            String text = this.subString(start, count);
//            value = Float.parseFloat(text);
            int start, count;
<span class="fc bfc" id="L2761" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2762" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2763">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2764">                    return 0;</span>
                } else {
<span class="fc" id="L2766">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2768">                start = bp + 1;</span>
<span class="fc" id="L2769">                count = bp + offset - start - 2;</span>
<span class="fc" id="L2770">            } else {</span>
<span class="fc" id="L2771">                start = bp;</span>
<span class="fc" id="L2772">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2775" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2776">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2777" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2778">                    value = -value;</span>
                }
<span class="fc" id="L2780">            } else {</span>
<span class="fc" id="L2781">                String text = this.subString(start, count);</span>
<span class="fc" id="L2782">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2784" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2785">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2786">            value = 0;</span>
<span class="fc" id="L2787">            offset += 3;</span>
<span class="fc" id="L2788">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2790" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2791">                chLocal = charAt(bp + offset++);</span>
            }

<span class="fc" id="L2794">            for (;;) {</span>
<span class="fc bfc" id="L2795" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2796">                    bp += offset;</span>
<span class="fc" id="L2797">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2798">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2799">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2800">                    return value;</span>
<span class="fc bfc" id="L2801" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2802">                    bp += offset;</span>
<span class="fc" id="L2803">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2804">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2805">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2806">                    return value;</span>
<span class="pc bpc" id="L2807" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2808">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L2813">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2814">            return 0;</span>
        } else {
<span class="fc" id="L2816">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2817">            return 0;</span>
        }

<span class="fc bfc" id="L2820" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L2821">            bp += offset;</span>
<span class="fc" id="L2822">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2823">            matchStat = VALUE;</span>
<span class="fc" id="L2824">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2825">            return value;</span>
        } else {
<span class="fc" id="L2827">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2828">            return value;</span>
        }
    }

    public double scanDouble(char seperator) {
<span class="fc" id="L2833">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2835">        int offset = 0;</span>
<span class="fc" id="L2836">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2837" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L2838" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="fc" id="L2839">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L2842" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L2843" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2844">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="pc bpc" id="L2848" title="2 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2849">            long intVal = chLocal - '0';</span>
<span class="nc" id="L2850">            for (; ; ) {</span>
<span class="nc" id="L2851">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2852" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2853">                    intVal = intVal * 10 + (chLocal - '0');</span>
                    continue;
                } else {
                    break;
                }
            }

<span class="nc" id="L2860">            long power = 1;</span>
<span class="nc bnc" id="L2861" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2862" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2863">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2864" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2865">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2866">                    power = 10;</span>
<span class="nc" id="L2867">                    for (; ; ) {</span>
<span class="nc" id="L2868">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2869" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2870">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2871">                            power *= 10;</span>
                            continue;
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L2878">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2879">                    return 0;</span>
                }
            }

<span class="nc bnc" id="L2883" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L2884" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2885">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2886" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2887">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L2889">                for (; ; ) {</span>
<span class="nc bnc" id="L2890" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2891">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L2899" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L2900" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2901">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2902">                    return 0;</span>
                } else {
<span class="nc" id="L2904">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L2906">                start = bp + 1;</span>
<span class="nc" id="L2907">                count = bp + offset - start - 2;</span>
<span class="nc" id="L2908">            } else {</span>
<span class="nc" id="L2909">                start = bp;</span>
<span class="nc" id="L2910">                count = bp + offset - start - 1;</span>
            }

<span class="nc bnc" id="L2913" title="All 4 branches missed.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="nc" id="L2914">                value = ((double) intVal) / power;</span>
<span class="nc bnc" id="L2915" title="All 2 branches missed.">                if (negative) {</span>
<span class="nc" id="L2916">                    value = -value;</span>
                }
<span class="nc" id="L2918">            } else {</span>
<span class="nc" id="L2919">                String text = this.subString(start, count);</span>
<span class="nc" id="L2920">                value = Double.parseDouble(text);</span>
            }
<span class="pc bpc" id="L2922" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2923">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2924">            value = 0;</span>
<span class="fc" id="L2925">            offset += 3;</span>
<span class="fc" id="L2926">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2928" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2929">                chLocal = charAt(bp + offset++);</span>
            }

<span class="fc" id="L2932">            for (;;) {</span>
<span class="fc bfc" id="L2933" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2934">                    bp += offset;</span>
<span class="fc" id="L2935">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2936">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2937">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2938">                    return value;</span>
<span class="fc bfc" id="L2939" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2940">                    bp += offset;</span>
<span class="fc" id="L2941">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2942">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2943">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2944">                    return value;</span>
<span class="pc bpc" id="L2945" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2946">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L2951">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2952">            return 0;</span>
        } else {
<span class="nc" id="L2954">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2955">            return 0;</span>
        }

<span class="nc bnc" id="L2958" title="All 2 branches missed.">        if (chLocal == seperator) {</span>
<span class="nc" id="L2959">            bp += offset;</span>
<span class="nc" id="L2960">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L2961">            matchStat = VALUE;</span>
<span class="nc" id="L2962">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2963">            return value;</span>
        } else {
<span class="nc" id="L2965">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2966">            return value;</span>
        }
    }

    public BigDecimal scanDecimal(char seperator) {
<span class="nc" id="L2971">        matchStat = UNKNOWN;</span>

<span class="nc" id="L2973">        int offset = 0;</span>
<span class="nc" id="L2974">        char chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2975" title="All 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="nc bnc" id="L2976" title="All 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L2977">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="nc bnc" id="L2980" title="All 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="nc bnc" id="L2981" title="All 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2982">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="nc bnc" id="L2986" title="All 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2987">            for (;;) {</span>
<span class="nc" id="L2988">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2989" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    continue;
                } else {
                    break;
                }
            }

<span class="nc bnc" id="L2996" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2997" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2998">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2999" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3000">                    for (;;) {</span>
<span class="nc" id="L3001">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3002" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                            continue;
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3009">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3010">                    return null;</span>
                }
            }

<span class="nc bnc" id="L3014" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L3015" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3016">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3017" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3018">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3020">                for (;;) {</span>
<span class="nc bnc" id="L3021" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3022">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L3030" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3031" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3032">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3033">                    return null;</span>
                } else {
<span class="nc" id="L3035">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3037">                start = bp + 1;</span>
<span class="nc" id="L3038">                count = bp + offset - start - 2;</span>
<span class="nc" id="L3039">            } else {</span>
<span class="nc" id="L3040">                start = bp;</span>
<span class="nc" id="L3041">                count = bp + offset - start - 1;</span>
            }

<span class="nc" id="L3044">            char[] chars = this.sub_chars(start, count);</span>
<span class="nc" id="L3045">            value = new BigDecimal(chars);</span>
<span class="nc bnc" id="L3046" title="All 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="nc" id="L3047">            matchStat = VALUE_NULL;</span>
<span class="nc" id="L3048">            value = null;</span>
<span class="nc" id="L3049">            offset += 3;</span>
<span class="nc" id="L3050">            chLocal = charAt(bp + offset++);</span>

<span class="nc bnc" id="L3052" title="All 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3053">                chLocal = charAt(bp + offset++);</span>
            }

<span class="nc" id="L3056">            for (;;) {</span>
<span class="nc bnc" id="L3057" title="All 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3058">                    bp += offset;</span>
<span class="nc" id="L3059">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3060">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3061">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3062">                    return value;</span>
<span class="nc bnc" id="L3063" title="All 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="nc" id="L3064">                    bp += offset;</span>
<span class="nc" id="L3065">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3066">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3067">                    token = JSONToken.RBRACE;</span>
<span class="nc" id="L3068">                    return value;</span>
<span class="nc bnc" id="L3069" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3070">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L3075">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3076">            return null;</span>
        } else {
<span class="nc" id="L3078">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3079">            return null;</span>
        }

<span class="nc bnc" id="L3082" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3083">            bp += offset;</span>
<span class="nc" id="L3084">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L3085">            matchStat = VALUE;</span>
<span class="nc" id="L3086">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3087">            return value;</span>
        }

<span class="nc bnc" id="L3090" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L3091">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3092" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3093">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3094">                bp += offset;</span>
<span class="nc" id="L3095">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3096" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3097">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3098">                bp += offset;</span>
<span class="nc" id="L3099">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3100" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3101">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3102">                bp += offset;</span>
<span class="nc" id="L3103">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3104" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L3105">                token = JSONToken.EOF;</span>
<span class="nc" id="L3106">                bp += (offset - 1);</span>
<span class="nc" id="L3107">                ch = EOI;</span>
<span class="nc" id="L3108">            } else {</span>
<span class="nc" id="L3109">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3110">                return null;</span>
            }
<span class="nc" id="L3112">            matchStat = END;</span>
<span class="nc" id="L3113">        } else {</span>
<span class="nc" id="L3114">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3115">            return null;</span>
        }

<span class="nc" id="L3118">        return value;</span>
    }

    public final float[] scanFieldFloatArray(char[] fieldName) {
<span class="fc" id="L3122">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3124" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3125">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3126">            return null;</span>
        }

<span class="fc" id="L3129">        int offset = fieldName.length;</span>
<span class="fc" id="L3130">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3131" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L3132">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3133">            return null;</span>
        }
<span class="fc" id="L3135">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3137">        float[] array = new float[16];</span>
<span class="fc" id="L3138">        int arrayIndex = 0;</span>

        for (;;) {
<span class="fc" id="L3141">            int start = bp + offset - 1;</span>

<span class="fc bfc" id="L3143" title="All 2 branches covered.">            boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3144" title="All 2 branches covered.">            if (negative) {</span>
<span class="fc" id="L3145">                chLocal = charAt(bp + (offset++));</span>
            }

<span class="pc bpc" id="L3148" title="1 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3149">                int intVal = chLocal - '0';</span>
<span class="nc" id="L3150">                for (; ; ) {</span>
<span class="fc" id="L3151">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3152" title="3 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3153">                        intVal = intVal * 10 + (chLocal - '0');</span>
                        continue;
                    } else {
                        break;
                    }
                }

<span class="fc" id="L3160">                int power = 1;</span>
<span class="fc bfc" id="L3161" title="All 2 branches covered.">                boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3162" title="All 2 branches covered.">                if (small) {</span>
<span class="fc" id="L3163">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3164">                    power = 10;</span>
<span class="pc bpc" id="L3165" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3166">                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3167">                        for (; ; ) {</span>
<span class="fc" id="L3168">                            chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L3170" title="All 4 branches covered.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3171">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3172">                                power *= 10;</span>
                                continue;
                            } else {
                                break;
                            }
                        }
                    } else {
<span class="nc" id="L3179">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3180">                        return null;</span>
                    }
                }

<span class="pc bpc" id="L3184" title="1 of 4 branches missed.">                boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3185" title="All 2 branches covered.">                if (exp) {</span>
<span class="fc" id="L3186">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3187" title="2 of 4 branches missed.">                    if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3188">                        chLocal = charAt(bp + (offset++));</span>
                    }
<span class="fc" id="L3190">                    for (;;) {</span>
<span class="pc bpc" id="L3191" title="1 of 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3192">                            chLocal = charAt(bp + (offset++));</span>
                        } else {
                            break;
                        }
                    }
                }

<span class="fc" id="L3199">                int count = bp + offset - start - 1;</span>

                float value;
<span class="fc bfc" id="L3202" title="All 4 branches covered.">                if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3203">                    value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3204" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3205">                        value = -value;</span>
                    }
<span class="fc" id="L3207">                } else {</span>
<span class="fc" id="L3208">                    String text = this.subString(start, count);</span>
<span class="fc" id="L3209">                    value = Float.parseFloat(text);</span>
                }

<span class="pc bpc" id="L3212" title="1 of 2 branches missed.">                if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3213">                    float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3214">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3215">                    array = tmp;</span>
                }
<span class="fc" id="L3217">                array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3219" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3220">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3221" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3222">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3223">                    break;</span>
                }
            } else {
<span class="fc" id="L3226">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3227">                return null;</span>
            }
        }


<span class="pc bpc" id="L3232" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L3233">            float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3234">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3235">            array = tmp;</span>
        }

<span class="pc bpc" id="L3238" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3239">            bp += (offset - 1);</span>
<span class="nc" id="L3240">            this.next();</span>
<span class="nc" id="L3241">            matchStat = VALUE;</span>
<span class="nc" id="L3242">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3243">            return array;</span>
        }

<span class="pc bpc" id="L3246" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3247">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3248" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3249">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3250">                bp += (offset - 1);</span>
<span class="nc" id="L3251">                this.next();</span>
<span class="pc bpc" id="L3252" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3253">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3254">                bp += (offset - 1);</span>
<span class="nc" id="L3255">                this.next();</span>
<span class="pc bpc" id="L3256" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3257">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3258">                bp += (offset - 1);</span>
<span class="nc" id="L3259">                this.next();</span>
<span class="pc bpc" id="L3260" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3261">                bp += (offset - 1);</span>
<span class="fc" id="L3262">                token = JSONToken.EOF;</span>
<span class="fc" id="L3263">                ch = EOI;</span>
<span class="fc" id="L3264">            } else {</span>
<span class="nc" id="L3265">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3266">                return null;</span>
            }
<span class="fc" id="L3268">            matchStat = END;</span>
<span class="fc" id="L3269">        } else {</span>
<span class="nc" id="L3270">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3271">            return null;</span>
        }

<span class="fc" id="L3274">        return array;</span>
    }

    public final float[][] scanFieldFloatArray2(char[] fieldName) {
<span class="fc" id="L3278">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3280" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3281">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3282">            return null;</span>
        }

<span class="fc" id="L3285">        int offset = fieldName.length;</span>
<span class="fc" id="L3286">        char chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3288" title="1 of 2 branches missed.">        if (chLocal != '[') {</span>
<span class="nc" id="L3289">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3290">            return null;</span>
        }
<span class="fc" id="L3292">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3294">        float[][] arrayarray = new float[16][];</span>
<span class="fc" id="L3295">        int arrayarrayIndex = 0;</span>

        for (;;) {
<span class="fc bfc" id="L3298" title="All 2 branches covered.">            if (chLocal == '[') {</span>
<span class="fc" id="L3299">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3301">                float[] array = new float[16];</span>
<span class="fc" id="L3302">                int arrayIndex = 0;</span>

                for (; ; ) {
<span class="fc" id="L3305">                    int start = bp + offset - 1;</span>
<span class="fc bfc" id="L3306" title="All 2 branches covered.">                    boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3307" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3308">                        chLocal = charAt(bp + (offset++));</span>
                    }

<span class="pc bpc" id="L3311" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3312">                        int intVal = chLocal - '0';</span>
<span class="nc" id="L3313">                        for (; ; ) {</span>
<span class="fc" id="L3314">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3316" title="3 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3317">                                intVal = intVal * 10 + (chLocal - '0');</span>
                                continue;
                            } else {
                                break;
                            }
                        }

<span class="fc" id="L3324">                        int power = 1;</span>
<span class="fc bfc" id="L3325" title="All 2 branches covered.">                        if (chLocal == '.') {</span>
<span class="fc" id="L3326">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3328" title="2 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3329">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3330">                                power = 10;</span>
<span class="nc" id="L3331">                                for (; ; ) {</span>
<span class="fc" id="L3332">                                    chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3334" title="1 of 4 branches missed.">                                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3335">                                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3336">                                        power *= 10;</span>
                                        continue;
                                    } else {
                                        break;
                                    }
                                }
                            } else {
<span class="nc" id="L3343">                                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3344">                                return null;</span>
                            }
                        }

<span class="pc bpc" id="L3348" title="2 of 4 branches missed.">                        boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3349" title="1 of 2 branches missed.">                        if (exp) {</span>
<span class="nc" id="L3350">                            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3351" title="All 4 branches missed.">                            if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3352">                                chLocal = charAt(bp + (offset++));</span>
                            }
<span class="nc" id="L3354">                            for (;;) {</span>
<span class="nc bnc" id="L3355" title="All 4 branches missed.">                                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3356">                                    chLocal = charAt(bp + (offset++));</span>
                                } else {
                                    break;
                                }
                            }
                        }

<span class="fc" id="L3363">                        int count = bp + offset - start - 1;</span>
                        float value;
<span class="pc bpc" id="L3365" title="2 of 4 branches missed.">                        if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3366">                            value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3367" title="All 2 branches covered.">                            if (negative) {</span>
<span class="fc" id="L3368">                                value = -value;</span>
                            }
<span class="fc" id="L3370">                        } else {</span>
<span class="nc" id="L3371">                            String text = this.subString(start, count);</span>
<span class="nc" id="L3372">                            value = Float.parseFloat(text);</span>
                        }

<span class="pc bpc" id="L3375" title="1 of 2 branches missed.">                        if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3376">                            float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3377">                            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3378">                            array = tmp;</span>
                        }
<span class="fc" id="L3380">                        array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3382" title="All 2 branches covered.">                        if (chLocal == ',') {</span>
<span class="fc" id="L3383">                            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3384" title="1 of 2 branches missed.">                        } else if (chLocal == ']') {</span>
<span class="fc" id="L3385">                            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3386">                            break;</span>
                        }
                    } else {
<span class="nc" id="L3389">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3390">                        return null;</span>
                    }
                }

                // compact
<span class="pc bpc" id="L3395" title="1 of 2 branches missed.">                if (arrayIndex != array.length) {</span>
<span class="fc" id="L3396">                    float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3397">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3398">                    array = tmp;</span>
                }

<span class="pc bpc" id="L3401" title="1 of 2 branches missed.">                if (arrayarrayIndex &gt;= arrayarray.length) {</span>
<span class="nc" id="L3402">                    float[][] tmp = new float[arrayarray.length * 3 / 2][];</span>
<span class="nc" id="L3403">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3404">                    arrayarray = tmp;</span>
                }
<span class="fc" id="L3406">                arrayarray[arrayarrayIndex++] = array;</span>

<span class="pc bpc" id="L3408" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3409">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3410" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3411">                    chLocal = charAt(bp + (offset++));</span>
                    break;
                }
            } else {
                break;
            }
        }

        // compact
<span class="pc bpc" id="L3420" title="1 of 2 branches missed.">        if (arrayarrayIndex != arrayarray.length) {</span>
<span class="fc" id="L3421">            float[][] tmp = new float[arrayarrayIndex][];</span>
<span class="fc" id="L3422">            System.arraycopy(arrayarray, 0, tmp, 0, arrayarrayIndex);</span>
<span class="fc" id="L3423">            arrayarray = tmp;</span>
        }

<span class="pc bpc" id="L3426" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3427">            bp += (offset - 1);</span>
<span class="nc" id="L3428">            this.next();</span>
<span class="nc" id="L3429">            matchStat = VALUE;</span>
<span class="nc" id="L3430">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3431">            return arrayarray;</span>
        }

<span class="fc bfc" id="L3434" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3435">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3436" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3437">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3438">                bp += (offset - 1);</span>
<span class="nc" id="L3439">                this.next();</span>
<span class="pc bpc" id="L3440" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3441">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3442">                bp += (offset - 1);</span>
<span class="nc" id="L3443">                this.next();</span>
<span class="pc bpc" id="L3444" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3445">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3446">                bp += (offset - 1);</span>
<span class="nc" id="L3447">                this.next();</span>
<span class="pc bpc" id="L3448" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3449">                bp += (offset - 1);</span>
<span class="fc" id="L3450">                token = JSONToken.EOF;</span>
<span class="fc" id="L3451">                ch = EOI;</span>
<span class="fc" id="L3452">            } else {</span>
<span class="nc" id="L3453">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3454">                return null;</span>
            }
<span class="fc" id="L3456">            matchStat = END;</span>
<span class="fc" id="L3457">        } else {</span>
<span class="fc" id="L3458">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3459">            return null;</span>
        }

<span class="fc" id="L3462">        return arrayarray;</span>
    }

    public final double scanFieldDouble(char[] fieldName) {
<span class="fc" id="L3466">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3468" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3469">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3470">            return 0;</span>
        }

<span class="fc" id="L3473">        int offset = fieldName.length;</span>
<span class="fc" id="L3474">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3475" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3476" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3477">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L3480" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3481" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L3482">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="fc bfc" id="L3486" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3487">            long intVal = chLocal - '0';</span>

<span class="fc" id="L3489">            for (;;) {</span>
<span class="fc" id="L3490">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3491" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3492">                    intVal = intVal * 10 + (chLocal - '0');</span>
                    continue;
                } else {
                    break;
                }
            }

<span class="fc" id="L3499">            long power = 1;</span>
<span class="fc bfc" id="L3500" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3501" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3502">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3503" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3504">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3505">                    power = 10;</span>
<span class="fc" id="L3506">                    for (;;) {</span>
<span class="fc" id="L3507">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3508" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3509">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3510">                            power *= 10;</span>
                            continue;
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L3517">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3518">                    return 0;</span>
                }
            }

<span class="fc bfc" id="L3522" title="All 4 branches covered.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3523" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L3524">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3525" title="All 4 branches covered.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3526">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L3528">                for (;;) {</span>
<span class="fc bfc" id="L3529" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3530">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L3538" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L3539" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3540">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3541">                    return 0;</span>
                } else {
<span class="fc" id="L3543">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L3545">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L3546">                count = bp + offset - start - 2;</span>
<span class="fc" id="L3547">            } else {</span>
<span class="fc" id="L3548">                start = bp + fieldName.length;</span>
<span class="fc" id="L3549">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L3552" title="All 4 branches covered.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L3553">                value = ((double) intVal) / power;</span>
<span class="fc bfc" id="L3554" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L3555">                    value = -value;</span>
                }
<span class="fc" id="L3557">            } else {</span>
<span class="fc" id="L3558">                String text = this.subString(start, count);</span>
<span class="fc" id="L3559">                value = Double.parseDouble(text);</span>
            }
<span class="fc bfc" id="L3561" title="All 2 branches covered.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3562" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3563" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3564" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3565">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3566">            value = 0;</span>
<span class="fc" id="L3567">            offset += 3;</span>
<span class="fc" id="L3568">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3570" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L3571">                chLocal = charAt(bp + offset++);</span>
            }

<span class="fc" id="L3574">            for (;;) {</span>
<span class="fc bfc" id="L3575" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3576">                    bp += offset;</span>
<span class="fc" id="L3577">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3578">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3579">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L3580">                    return value;</span>
<span class="fc bfc" id="L3581" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3582">                    bp += offset;</span>
<span class="fc" id="L3583">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3584">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3585">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3586">                    return value;</span>
<span class="pc bpc" id="L3587" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L3588">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L3593">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3594">            return 0;</span>
        } else {
<span class="fc" id="L3596">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3597">            return 0;</span>
        }

<span class="fc bfc" id="L3600" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3601">            bp += offset;</span>
<span class="fc" id="L3602">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3603">            matchStat = VALUE;</span>
<span class="fc" id="L3604">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3605">            return value;</span>
        }

<span class="fc bfc" id="L3608" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3609">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3610" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L3611">                token = JSONToken.COMMA;</span>
<span class="fc" id="L3612">                bp += offset;</span>
<span class="fc" id="L3613">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3614" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3615">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3616">                bp += offset;</span>
<span class="fc" id="L3617">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3618" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L3619">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L3620">                bp += offset;</span>
<span class="fc" id="L3621">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3622" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3623">                token = JSONToken.EOF;</span>
<span class="fc" id="L3624">                bp += (offset - 1);</span>
<span class="fc" id="L3625">                ch = EOI;</span>
<span class="fc" id="L3626">            } else {</span>
<span class="fc" id="L3627">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3628">                return 0;</span>
            }
<span class="fc" id="L3630">            matchStat = END;</span>
<span class="fc" id="L3631">        } else {</span>
<span class="fc" id="L3632">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3633">            return 0;</span>
        }

<span class="fc" id="L3636">        return value;</span>
    }

    public BigDecimal scanFieldDecimal(char[] fieldName) {
<span class="fc" id="L3640">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3642" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3643">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3644">            return null;</span>
        }

<span class="fc" id="L3647">        int offset = fieldName.length;</span>
<span class="fc" id="L3648">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3649" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3650" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3651">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3654" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3655" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3656">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="pc bpc" id="L3660" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3661">            for (;;) {</span>
<span class="fc" id="L3662">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3663" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    continue;
                } else {
                    break;
                }
            }

<span class="fc bfc" id="L3670" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3671" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3672">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3673" title="2 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3674">                    for (;;) {</span>
<span class="fc" id="L3675">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3676" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                            continue;
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3683">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3684">                    return null;</span>
                }
            }

<span class="pc bpc" id="L3688" title="2 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3689" title="1 of 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3690">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3691" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3692">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3694">                for (;;) {</span>
<span class="nc bnc" id="L3695" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3696">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="pc bpc" id="L3704" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3705" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3706">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3707">                    return null;</span>
                } else {
<span class="nc" id="L3709">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3711">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3712">                count = bp + offset - start - 2;</span>
<span class="nc" id="L3713">            } else {</span>
<span class="fc" id="L3714">                start = bp + fieldName.length;</span>
<span class="fc" id="L3715">                count = bp + offset - start - 1;</span>
            }

<span class="fc" id="L3718">            char[] chars = this.sub_chars(start, count);</span>
<span class="fc" id="L3719">            value = new BigDecimal(chars);</span>
<span class="fc bfc" id="L3720" title="All 2 branches covered.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3721" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3722" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3723" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3724">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3725">            value = null;</span>
<span class="fc" id="L3726">            offset += 3;</span>
<span class="fc" id="L3727">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3729" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3730">                chLocal = charAt(bp + offset++);</span>
            }

<span class="nc" id="L3733">            for (;;) {</span>
<span class="pc bpc" id="L3734" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3735">                    bp += offset;</span>
<span class="nc" id="L3736">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3737">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3738">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3739">                    return value;</span>
<span class="pc bpc" id="L3740" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3741">                    bp += offset;</span>
<span class="fc" id="L3742">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3743">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3744">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3745">                    return value;</span>
<span class="nc bnc" id="L3746" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3747">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L3752">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3753">            return null;</span>
        } else {
<span class="fc" id="L3755">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3756">            return null;</span>
        }

<span class="fc bfc" id="L3759" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3760">            bp += offset;</span>
<span class="fc" id="L3761">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3762">            matchStat = VALUE;</span>
<span class="fc" id="L3763">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3764">            return value;</span>
        }

<span class="pc bpc" id="L3767" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3768">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3769" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3770">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3771">                bp += offset;</span>
<span class="nc" id="L3772">                this.ch = this.charAt(bp);</span>
<span class="pc bfc" id="L3773" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3774">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3775">                bp += offset;</span>
<span class="fc" id="L3776">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3777" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3778">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3779">                bp += offset;</span>
<span class="nc" id="L3780">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3781" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3782">                token = JSONToken.EOF;</span>
<span class="fc" id="L3783">                bp += (offset - 1);</span>
<span class="fc" id="L3784">                ch = EOI;</span>
<span class="fc" id="L3785">            } else {</span>
<span class="nc" id="L3786">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3787">                return null;</span>
            }
<span class="fc" id="L3789">            matchStat = END;</span>
<span class="fc" id="L3790">        } else {</span>
<span class="nc" id="L3791">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3792">            return null;</span>
        }

<span class="fc" id="L3795">        return value;</span>
    }

    public BigInteger scanFieldBigInteger(char[] fieldName) {
<span class="fc" id="L3799">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3801" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3802">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3803">            return null;</span>
        }

<span class="fc" id="L3806">        int offset = fieldName.length;</span>
<span class="fc" id="L3807">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3808" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L3809" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L3810">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3813" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3814" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3815">            chLocal = charAt(bp + (offset++));</span>
        }

        BigInteger value;
<span class="pc bpc" id="L3819" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3820">            long intVal = chLocal - '0';</span>
<span class="fc" id="L3821">            boolean overflow = false;</span>
            long temp;
<span class="fc" id="L3823">            for (;;) {</span>
<span class="fc" id="L3824">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3825" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3826">                    temp = intVal * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L3827" title="All 2 branches covered.">                    if (temp &lt; intVal) {</span>
<span class="fc" id="L3828">                        overflow = true;</span>
<span class="fc" id="L3829">                        break;</span>
                    }
<span class="fc" id="L3831">                    intVal = temp;</span>
                    continue;
                } else {
                    break;
                }
            }

            int start, count;
<span class="pc bpc" id="L3839" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3840" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3841">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3842">                    return null;</span>
                } else {
<span class="nc" id="L3844">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3846">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3847">                count = bp + offset - start - 2;</span>
<span class="nc" id="L3848">            } else {</span>
<span class="fc" id="L3849">                start = bp + fieldName.length;</span>
<span class="fc" id="L3850">                count = bp + offset - start - 1;</span>
            }

<span class="pc bpc" id="L3853" title="5 of 8 branches missed.">            if (!overflow &amp;&amp; (count &lt; 20 || (negative &amp;&amp; count &lt; 21))) {</span>
<span class="pc bpc" id="L3854" title="1 of 2 branches missed.">                value = BigInteger.valueOf(negative ? -intVal : intVal);</span>
<span class="fc" id="L3855">            } else {</span>

//            char[] chars = this.sub_chars(negative ? start + 1 : start, count);
//            value = new BigInteger(chars, )
<span class="fc" id="L3859">                String strVal = this.subString(start, count);</span>
<span class="fc" id="L3860">                value = new BigInteger(strVal);</span>
            }
<span class="pc bpc" id="L3862" title="1 of 2 branches missed.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3863" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3864" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3865" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3866">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3867">            value = null;</span>
<span class="fc" id="L3868">            offset += 3;</span>
<span class="fc" id="L3869">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3871" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3872">                chLocal = charAt(bp + offset++);</span>
            }

<span class="nc" id="L3875">            for (;;) {</span>
<span class="pc bpc" id="L3876" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3877">                    bp += offset;</span>
<span class="nc" id="L3878">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3879">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3880">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3881">                    return value;</span>
<span class="pc bpc" id="L3882" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3883">                    bp += offset;</span>
<span class="fc" id="L3884">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3885">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3886">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3887">                    return value;</span>
<span class="nc bnc" id="L3888" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3889">                    chLocal = charAt(bp + offset++);</span>
                    continue;
                }
                break;
            }
<span class="nc" id="L3894">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3895">            return null;</span>
        } else {
<span class="nc" id="L3897">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3898">            return null;</span>
        }

<span class="pc bpc" id="L3901" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3902">            bp += offset;</span>
<span class="nc" id="L3903">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L3904">            matchStat = VALUE;</span>
<span class="nc" id="L3905">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3906">            return value;</span>
        }

<span class="fc bfc" id="L3909" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3910">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3911" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3912">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3913">                bp += offset;</span>
<span class="nc" id="L3914">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3915" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3916">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3917">                bp += offset;</span>
<span class="nc" id="L3918">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3919" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3920">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3921">                bp += offset;</span>
<span class="nc" id="L3922">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3923" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3924">                token = JSONToken.EOF;</span>
<span class="fc" id="L3925">                bp += (offset - 1);</span>
<span class="fc" id="L3926">                ch = EOI;</span>
<span class="fc" id="L3927">            } else {</span>
<span class="nc" id="L3928">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3929">                return null;</span>
            }
<span class="fc" id="L3931">            matchStat = END;</span>
<span class="fc" id="L3932">        } else {</span>
<span class="fc" id="L3933">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3934">            return null;</span>
        }

<span class="fc" id="L3937">        return value;</span>
    }

    public java.util.Date scanFieldDate(char[] fieldName) {
<span class="fc" id="L3941">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3943" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3944">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3945">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L3950">        int offset = fieldName.length;</span>
<span class="fc" id="L3951">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L3954" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L3955">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L3956">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L3957" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L3958">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L3961">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L3962">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L3963" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
<span class="nc" id="L3964">                for (;;) {</span>
<span class="nc" id="L3965">                    int slashCount = 0;</span>
<span class="nc bnc" id="L3966" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L3967" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L3968">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L3973" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L3974">                        break;</span>
                    }
<span class="nc" id="L3976">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
                }

<span class="nc" id="L3979">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="nc" id="L3980">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="nc" id="L3982">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L3985">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L3986">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3988">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="fc bfc" id="L3990" title="All 2 branches covered.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L3991">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L3992">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L3993">                } else {</span>
<span class="fc" id="L3994">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3995">                    return null;</span>
                }
            } finally {
<span class="fc" id="L3998">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L4000" title="3 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L4001">            long millis = 0;</span>

<span class="fc" id="L4003">            boolean negative = false;</span>
<span class="pc bpc" id="L4004" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L4005">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4006">                negative = true;</span>
            }

<span class="pc bpc" id="L4009" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4010">                millis = chLocal - '0';</span>
<span class="fc" id="L4011">                for (; ; ) {</span>
<span class="fc" id="L4012">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L4013" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4014">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4021" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4022">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4023">                return null;</span>
            }

<span class="pc bpc" id="L4026" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4027">                millis = -millis;</span>
            }

<span class="fc" id="L4030">            dateVal = new java.util.Date(millis);</span>
<span class="fc" id="L4031">        } else {</span>
<span class="nc" id="L4032">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4033">            return null;</span>
        }

<span class="fc bfc" id="L4036" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4037">            bp += offset;</span>
<span class="fc" id="L4038">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4039">            matchStat = VALUE;</span>
<span class="fc" id="L4040">            return dateVal;</span>
        }

<span class="pc bpc" id="L4043" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4044">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4045" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4046">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4047">                bp += offset;</span>
<span class="nc" id="L4048">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4049" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4050">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4051">                bp += offset;</span>
<span class="nc" id="L4052">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4053" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4054">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4055">                bp += offset;</span>
<span class="nc" id="L4056">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4057" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4058">                token = JSONToken.EOF;</span>
<span class="fc" id="L4059">                bp += (offset - 1);</span>
<span class="fc" id="L4060">                ch = EOI;</span>
<span class="fc" id="L4061">            } else {</span>
<span class="nc" id="L4062">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4063">                return null;</span>
            }
<span class="fc" id="L4065">            matchStat = END;</span>
<span class="fc" id="L4066">        } else {</span>
<span class="nc" id="L4067">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4068">            return null;</span>
        }

<span class="fc" id="L4071">        return dateVal;</span>
    }

    public java.util.Date scanDate(char seperator) {
<span class="fc" id="L4075">        matchStat = UNKNOWN;</span>

<span class="fc" id="L4077">        int offset = 0;</span>
<span class="fc" id="L4078">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L4081" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L4082">            int startIndex = bp + 1;</span>
<span class="fc" id="L4083">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4084" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4085">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4088">            int startIndex2 = bp + 1; // must re compute</span>
<span class="fc" id="L4089">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L4090" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
<span class="nc" id="L4091">                for (;;) {</span>
<span class="nc" id="L4092">                    int slashCount = 0;</span>
<span class="nc bnc" id="L4093" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L4094" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L4095">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L4100" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L4101">                        break;</span>
                    }
<span class="nc" id="L4103">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
                }

<span class="nc" id="L4106">                int chars_len = endIndex - (bp + 1);</span>
<span class="nc" id="L4107">                char[] chars = sub_chars( bp + 1, chars_len);</span>

<span class="nc" id="L4109">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L4112">            offset += (endIndex - (bp + 1) + 1);</span>
<span class="fc" id="L4113">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L4115">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="pc bpc" id="L4117" title="1 of 2 branches missed.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L4118">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L4119">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L4120">                } else {</span>
<span class="nc" id="L4121">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L4122">                    return null;</span>
                }
            } finally {
<span class="fc" id="L4125">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L4127" title="2 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L4128">            long millis = 0;</span>

<span class="fc" id="L4130">            boolean negative = false;</span>
<span class="pc bpc" id="L4131" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L4132">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4133">                negative = true;</span>
            }

<span class="pc bpc" id="L4136" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4137">                millis = chLocal - '0';</span>
<span class="fc" id="L4138">                for (; ; ) {</span>
<span class="fc" id="L4139">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L4140" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4141">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4148" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4149">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4150">                return null;</span>
            }

<span class="pc bpc" id="L4153" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4154">                millis = -millis;</span>
            }

<span class="fc" id="L4157">            dateVal = new java.util.Date(millis);</span>
<span class="pc bpc" id="L4158" title="1 of 2 branches missed.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L4159" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L4160" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L4161" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L4162">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L4163">            dateVal = null;</span>
<span class="fc" id="L4164">            offset += 3;</span>
<span class="fc" id="L4165">            chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L4166">        } else {</span>
<span class="nc" id="L4167">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4168">            return null;</span>
        }

<span class="fc bfc" id="L4171" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4172">            bp += offset;</span>
<span class="fc" id="L4173">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4174">            matchStat = VALUE;</span>
<span class="fc" id="L4175">            token = JSONToken.COMMA;</span>
<span class="fc" id="L4176">            return dateVal;</span>
        }

<span class="pc bpc" id="L4179" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="fc" id="L4180">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4181" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4182">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4183">                bp += offset;</span>
<span class="nc" id="L4184">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4185" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4186">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4187">                bp += offset;</span>
<span class="nc" id="L4188">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4189" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4190">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4191">                bp += offset;</span>
<span class="nc" id="L4192">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4193" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4194">                token = JSONToken.EOF;</span>
<span class="fc" id="L4195">                bp += (offset - 1);</span>
<span class="fc" id="L4196">                ch = EOI;</span>
<span class="fc" id="L4197">            } else {</span>
<span class="nc" id="L4198">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4199">                return null;</span>
            }
<span class="fc" id="L4201">            matchStat = END;</span>
<span class="fc" id="L4202">        } else {</span>
<span class="nc" id="L4203">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4204">            return null;</span>
        }

<span class="fc" id="L4207">        return dateVal;</span>
    }

    public java.util.UUID scanFieldUUID(char[] fieldName) {
<span class="fc" id="L4211">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L4213" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L4214">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L4215">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L4220">        int offset = fieldName.length;</span>
<span class="fc" id="L4221">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="fc bfc" id="L4224" title="All 2 branches covered.">        if (chLocal == '&quot;') {</span>
<span class="fc" id="L4225">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L4226">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4227" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4228">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4231">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L4232">            int len = endIndex - startIndex2;</span>
<span class="fc bfc" id="L4233" title="All 2 branches covered.">            if (len == 36) {</span>
<span class="fc" id="L4234">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="fc bfc" id="L4235" title="All 2 branches covered.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="fc" id="L4236">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4238" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4239">                        num = ch - '0';</span>
<span class="pc bpc" id="L4240" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4241">                        num = 10 + (ch - 'a');</span>
<span class="pc bnc" id="L4242" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4243">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4244">                    } else {</span>
<span class="nc" id="L4245">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4246">                        return null;</span>
                    }

<span class="fc" id="L4249">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4250">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4252" title="All 2 branches covered.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="fc" id="L4253">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4255" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4256">                        num = ch - '0';</span>
<span class="pc bpc" id="L4257" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4258">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4259" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4260">                        num = 10 + (ch - 'A');</span>
<span class="fc" id="L4261">                    } else {</span>
<span class="nc" id="L4262">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4263">                        return null;</span>
                    }

<span class="fc" id="L4266">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4267">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4269" title="All 2 branches covered.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="fc" id="L4270">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4272" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4273">                        num = ch - '0';</span>
<span class="pc bpc" id="L4274" title="3 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4275">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4276" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4277">                        num = 10 + (ch - 'A');</span>
<span class="fc" id="L4278">                    } else {</span>
<span class="nc" id="L4279">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4280">                        return null;</span>
                    }

<span class="fc" id="L4283">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4284">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4286" title="All 2 branches covered.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="fc" id="L4287">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4289" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4290">                        num = ch - '0';</span>
<span class="pc bpc" id="L4291" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4292">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4293" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4294">                        num = 10 + (ch - 'A');</span>
<span class="fc" id="L4295">                    } else {</span>
<span class="nc" id="L4296">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4297">                        return null;</span>
                    }

<span class="fc" id="L4300">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4301">                    leastSigBits |= num;</span>
                }
<span class="fc bfc" id="L4303" title="All 2 branches covered.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="fc" id="L4304">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4306" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4307">                        num = ch - '0';</span>
<span class="pc bpc" id="L4308" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4309">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4310" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4311">                        num = 10 + (ch - 'A');</span>
<span class="fc" id="L4312">                    } else {</span>
<span class="nc" id="L4313">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4314">                        return null;</span>
                    }

<span class="fc" id="L4317">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4318">                    leastSigBits |= num;</span>
                }
<span class="fc" id="L4320">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="fc" id="L4322">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L4323">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4324" title="1 of 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4325">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4326" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4327">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4329" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4330">                        num = ch - '0';</span>
<span class="nc bnc" id="L4331" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4332">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4333" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4334">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4335">                    } else {</span>
<span class="nc" id="L4336">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4337">                        return null;</span>
                    }

<span class="nc" id="L4340">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4341">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4343" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4344">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4346" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4347">                        num = ch - '0';</span>
<span class="nc bnc" id="L4348" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4349">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4350" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4351">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4352">                    } else {</span>
<span class="nc" id="L4353">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4354">                        return null;</span>
                    }

<span class="nc" id="L4357">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4358">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4361">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4363">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="nc" id="L4364">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4365">            } else {</span>
<span class="fc" id="L4366">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L4367">                return null;</span>
            }
<span class="pc bpc" id="L4369" title="1 of 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="pc bpc" id="L4370" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="pc bpc" id="L4371" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="pc bpc" id="L4372" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="fc" id="L4373">            uuid = null;</span>
<span class="fc" id="L4374">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L4375">        } else {</span>
<span class="nc" id="L4376">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4377">            return null;</span>
        }

<span class="pc bpc" id="L4380" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4381">            bp += offset;</span>
<span class="nc" id="L4382">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4383">            matchStat = VALUE;</span>
<span class="nc" id="L4384">            return uuid;</span>
        }

<span class="pc bpc" id="L4387" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4388">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4389" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4390">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4391">                bp += offset;</span>
<span class="nc" id="L4392">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4393" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4394">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4395">                bp += offset;</span>
<span class="nc" id="L4396">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4397" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4398">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4399">                bp += offset;</span>
<span class="nc" id="L4400">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4401" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4402">                token = JSONToken.EOF;</span>
<span class="fc" id="L4403">                bp += (offset - 1);</span>
<span class="fc" id="L4404">                ch = EOI;</span>
<span class="fc" id="L4405">            } else {</span>
<span class="nc" id="L4406">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4407">                return null;</span>
            }
<span class="fc" id="L4409">            matchStat = END;</span>
<span class="fc" id="L4410">        } else {</span>
<span class="nc" id="L4411">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4412">            return null;</span>
        }

<span class="fc" id="L4415">        return uuid;</span>
    }

    public java.util.UUID scanUUID(char seperator) {
<span class="nc" id="L4419">        matchStat = UNKNOWN;</span>

        // int index = bp + fieldName.length;

<span class="nc" id="L4423">        int offset = 0;</span>
<span class="nc" id="L4424">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="nc bnc" id="L4427" title="All 2 branches missed.">        if (chLocal == '&quot;') {</span>
<span class="nc" id="L4428">            int startIndex = bp + 1;</span>
<span class="nc" id="L4429">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="nc bnc" id="L4430" title="All 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4431">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="nc" id="L4434">            int startIndex2 = bp + 1; // must re compute</span>
<span class="nc" id="L4435">            int len = endIndex - startIndex2;</span>
<span class="nc bnc" id="L4436" title="All 2 branches missed.">            if (len == 36) {</span>
<span class="nc" id="L4437">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4438" title="All 2 branches missed.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="nc" id="L4439">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4441" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4442">                        num = ch - '0';</span>
<span class="nc bnc" id="L4443" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4444">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4445" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4446">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4447">                    } else {</span>
<span class="nc" id="L4448">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4449">                        return null;</span>
                    }

<span class="nc" id="L4452">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4453">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4455" title="All 2 branches missed.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="nc" id="L4456">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4458" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4459">                        num = ch - '0';</span>
<span class="nc bnc" id="L4460" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4461">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4462" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4463">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4464">                    } else {</span>
<span class="nc" id="L4465">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4466">                        return null;</span>
                    }

<span class="nc" id="L4469">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4470">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4472" title="All 2 branches missed.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="nc" id="L4473">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4475" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4476">                        num = ch - '0';</span>
<span class="nc bnc" id="L4477" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4478">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4479" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4480">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4481">                    } else {</span>
<span class="nc" id="L4482">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4483">                        return null;</span>
                    }

<span class="nc" id="L4486">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4487">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4489" title="All 2 branches missed.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="nc" id="L4490">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4492" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4493">                        num = ch - '0';</span>
<span class="nc bnc" id="L4494" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4495">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4496" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4497">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4498">                    } else {</span>
<span class="nc" id="L4499">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4500">                        return null;</span>
                    }

<span class="nc" id="L4503">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4504">                    leastSigBits |= num;</span>
                }
<span class="nc bnc" id="L4506" title="All 2 branches missed.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="nc" id="L4507">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4509" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4510">                        num = ch - '0';</span>
<span class="nc bnc" id="L4511" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4512">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4513" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4514">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4515">                    } else {</span>
<span class="nc" id="L4516">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4517">                        return null;</span>
                    }

<span class="nc" id="L4520">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4521">                    leastSigBits |= num;</span>
                }
<span class="nc" id="L4523">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4525">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4526">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4527" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4528">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4529" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4530">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4532" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4533">                        num = ch - '0';</span>
<span class="nc bnc" id="L4534" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4535">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4536" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4537">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4538">                    } else {</span>
<span class="nc" id="L4539">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4540">                        return null;</span>
                    }

<span class="nc" id="L4543">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4544">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4546" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4547">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4549" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4550">                        num = ch - '0';</span>
<span class="nc bnc" id="L4551" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4552">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4553" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4554">                        num = 10 + (ch - 'A');</span>
<span class="nc" id="L4555">                    } else {</span>
<span class="nc" id="L4556">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4557">                        return null;</span>
                    }

<span class="nc" id="L4560">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4561">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4564">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4566">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4567">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4568">            } else {</span>
<span class="nc" id="L4569">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4570">                return null;</span>
            }
<span class="nc bnc" id="L4572" title="All 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="nc bnc" id="L4573" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="nc bnc" id="L4574" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="nc bnc" id="L4575" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="nc" id="L4576">            uuid = null;</span>
<span class="nc" id="L4577">            chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4578">        } else {</span>
<span class="nc" id="L4579">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4580">            return null;</span>
        }

<span class="nc bnc" id="L4583" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4584">            bp += offset;</span>
<span class="nc" id="L4585">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4586">            matchStat = VALUE;</span>
<span class="nc" id="L4587">            return uuid;</span>
        }

<span class="nc bnc" id="L4590" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L4591">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4592" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4593">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4594">                bp += offset;</span>
<span class="nc" id="L4595">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4596" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4597">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4598">                bp += offset;</span>
<span class="nc" id="L4599">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4600" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4601">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4602">                bp += offset;</span>
<span class="nc" id="L4603">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4604" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L4605">                token = JSONToken.EOF;</span>
<span class="nc" id="L4606">                bp += (offset - 1);</span>
<span class="nc" id="L4607">                ch = EOI;</span>
<span class="nc" id="L4608">            } else {</span>
<span class="nc" id="L4609">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4610">                return null;</span>
            }
<span class="nc" id="L4612">            matchStat = END;</span>
<span class="nc" id="L4613">        } else {</span>
<span class="nc" id="L4614">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4615">            return null;</span>
        }

<span class="nc" id="L4618">        return uuid;</span>
    }

    public final void scanTrue() {
<span class="fc bfc" id="L4622" title="All 2 branches covered.">        if (ch != 't') {</span>
<span class="fc" id="L4623">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4625">        next();</span>

<span class="fc bfc" id="L4627" title="All 2 branches covered.">        if (ch != 'r') {</span>
<span class="fc" id="L4628">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4630">        next();</span>

<span class="fc bfc" id="L4632" title="All 2 branches covered.">        if (ch != 'u') {</span>
<span class="fc" id="L4633">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4635">        next();</span>

<span class="fc bfc" id="L4637" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4638">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4640">        next();</span>

<span class="fc bfc" id="L4642" title="All 2 branches covered.">        if (ch == ' '  ||</span>
<span class="fc bfc" id="L4643" title="All 2 branches covered.">            ch == ','  ||</span>
<span class="fc bfc" id="L4644" title="All 2 branches covered.">            ch == '}'  ||</span>
<span class="fc bfc" id="L4645" title="All 2 branches covered.">            ch == ']'  ||</span>
<span class="fc bfc" id="L4646" title="All 2 branches covered.">            ch == '\n' ||</span>
<span class="fc bfc" id="L4647" title="All 2 branches covered.">            ch == '\r' ||</span>
<span class="fc bfc" id="L4648" title="All 2 branches covered.">            ch == '\t' ||</span>
<span class="fc bfc" id="L4649" title="All 2 branches covered.">            ch == EOI  ||</span>
<span class="fc bfc" id="L4650" title="All 2 branches covered.">            ch == '\f' ||</span>
<span class="fc bfc" id="L4651" title="All 2 branches covered.">            ch == '\b' ||</span>
<span class="pc bpc" id="L4652" title="1 of 2 branches missed.">            ch == ':'  ||</span>
<span class="fc bfc" id="L4653" title="All 2 branches covered.">            ch == '/') {</span>
<span class="fc" id="L4654">            token = JSONToken.TRUE;</span>
<span class="fc" id="L4655">        } else {</span>
<span class="fc" id="L4656">            throw new JSONException(&quot;scan true error&quot;);</span>
        }
<span class="fc" id="L4658">    }</span>

    public final void scanNullOrNew() {
<span class="fc" id="L4661">        scanNullOrNew(true);</span>
<span class="fc" id="L4662">    }</span>

    public final void scanNullOrNew(boolean acceptColon) {
<span class="fc bfc" id="L4665" title="All 2 branches covered.">        if (ch != 'n') {</span>
<span class="fc" id="L4666">            throw new JSONException(&quot;error parse null or new&quot;);</span>
        }
<span class="fc" id="L4668">        next();</span>

<span class="fc bfc" id="L4670" title="All 2 branches covered.">        if (ch == 'u') {</span>
<span class="fc" id="L4671">            next();</span>
<span class="fc bfc" id="L4672" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4673">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4675">            next();</span>

<span class="fc bfc" id="L4677" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4678">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4680">            next();</span>


<span class="fc bfc" id="L4683" title="All 2 branches covered.">            if (ch == ' '</span>
<span class="fc bfc" id="L4684" title="All 2 branches covered.">                    || ch == ','</span>
<span class="fc bfc" id="L4685" title="All 2 branches covered.">                    || ch == '}'</span>
<span class="fc bfc" id="L4686" title="All 2 branches covered.">                    || ch == ']'</span>
<span class="fc bfc" id="L4687" title="All 2 branches covered.">                    || ch == '\n'</span>
<span class="fc bfc" id="L4688" title="All 2 branches covered.">                    || ch == '\r'</span>
<span class="fc bfc" id="L4689" title="All 2 branches covered.">                    || ch == '\t'</span>
<span class="fc bfc" id="L4690" title="All 2 branches covered.">                    || ch == EOI</span>
<span class="pc bpc" id="L4691" title="1 of 4 branches missed.">                    || (ch == ':' &amp;&amp; acceptColon)</span>
<span class="fc bfc" id="L4692" title="All 2 branches covered.">                    || ch == '\f'</span>
<span class="fc bfc" id="L4693" title="All 2 branches covered.">                    || ch == '\b') {</span>

<span class="fc" id="L4695">                token = JSONToken.NULL;</span>
<span class="fc" id="L4696">            } else {</span>
<span class="fc" id="L4697">                throw new JSONException(&quot;scan null error&quot;);</span>
            }
<span class="fc" id="L4699">            return;</span>
        }

<span class="fc bfc" id="L4702" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4703">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4705">        next();</span>

<span class="fc bfc" id="L4707" title="All 2 branches covered.">        if (ch != 'w') {</span>
<span class="fc" id="L4708">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4710">        next();</span>

<span class="fc bfc" id="L4712" title="All 2 branches covered.">        if (ch == ' '  ||</span>
<span class="fc bfc" id="L4713" title="All 2 branches covered.">            ch == ','  ||</span>
<span class="fc bfc" id="L4714" title="All 2 branches covered.">            ch == '}'  ||</span>
<span class="fc bfc" id="L4715" title="All 2 branches covered.">            ch == ']'  ||</span>
<span class="fc bfc" id="L4716" title="All 2 branches covered.">            ch == '\n' ||</span>
<span class="fc bfc" id="L4717" title="All 2 branches covered.">            ch == '\r' ||</span>
<span class="fc bfc" id="L4718" title="All 2 branches covered.">            ch == '\t' ||</span>
<span class="fc bfc" id="L4719" title="All 2 branches covered.">            ch == EOI  ||</span>
<span class="fc bfc" id="L4720" title="All 2 branches covered.">            ch == '\f' ||</span>
<span class="fc bfc" id="L4721" title="All 2 branches covered.">            ch == '\b') {</span>
<span class="fc" id="L4722">            token = JSONToken.NEW;</span>
<span class="fc" id="L4723">        } else {</span>
<span class="fc" id="L4724">            throw new JSONException(&quot;scan new error&quot;);</span>
        }
<span class="fc" id="L4726">    }</span>

    public final void scanFalse() {
<span class="fc bfc" id="L4729" title="All 2 branches covered.">        if (ch != 'f') {</span>
<span class="fc" id="L4730">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4732">        next();</span>

<span class="fc bfc" id="L4734" title="All 2 branches covered.">        if (ch != 'a') {</span>
<span class="fc" id="L4735">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4737">        next();</span>

<span class="fc bfc" id="L4739" title="All 2 branches covered.">        if (ch != 'l') {</span>
<span class="fc" id="L4740">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4742">        next();</span>

<span class="fc bfc" id="L4744" title="All 2 branches covered.">        if (ch != 's') {</span>
<span class="fc" id="L4745">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4747">        next();</span>

<span class="fc bfc" id="L4749" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4750">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4752">        next();</span>

<span class="fc bfc" id="L4754" title="All 2 branches covered.">        if (ch == ' '  ||</span>
<span class="fc bfc" id="L4755" title="All 2 branches covered.">            ch == ','  ||</span>
<span class="fc bfc" id="L4756" title="All 2 branches covered.">            ch == '}'  ||</span>
<span class="fc bfc" id="L4757" title="All 2 branches covered.">            ch == ']'  ||</span>
<span class="fc bfc" id="L4758" title="All 2 branches covered.">            ch == '\n' ||</span>
<span class="fc bfc" id="L4759" title="All 2 branches covered.">            ch == '\r' ||</span>
<span class="fc bfc" id="L4760" title="All 2 branches covered.">            ch == '\t' ||</span>
<span class="fc bfc" id="L4761" title="All 2 branches covered.">            ch == EOI  ||</span>
<span class="fc bfc" id="L4762" title="All 2 branches covered.">            ch == '\f' ||</span>
<span class="fc bfc" id="L4763" title="All 2 branches covered.">            ch == '\b' ||</span>
<span class="pc bpc" id="L4764" title="1 of 2 branches missed.">            ch == ':'  ||</span>
<span class="fc bfc" id="L4765" title="All 2 branches covered.">            ch == '/') {</span>
<span class="fc" id="L4766">            token = JSONToken.FALSE;</span>
<span class="fc" id="L4767">        } else {</span>
<span class="fc" id="L4768">            throw new JSONException(&quot;scan false error&quot;);</span>
        }
<span class="fc" id="L4770">    }</span>

    public final void scanIdent() {
<span class="fc" id="L4773">        np = bp - 1;</span>
<span class="fc" id="L4774">        hasSpecial = false;</span>

        for (;;) {
<span class="fc" id="L4777">            sp++;</span>

<span class="fc" id="L4779">            next();</span>
<span class="fc bfc" id="L4780" title="All 2 branches covered.">            if (Character.isLetterOrDigit(ch)) {</span>
<span class="fc" id="L4781">                continue;</span>
            }

<span class="fc" id="L4784">            String ident = stringVal();</span>

<span class="fc bfc" id="L4786" title="All 2 branches covered.">            if (&quot;null&quot;.equalsIgnoreCase(ident)) {</span>
<span class="fc" id="L4787">                token = JSONToken.NULL;</span>
<span class="fc bfc" id="L4788" title="All 2 branches covered.">            } else if (&quot;new&quot;.equals(ident)) {</span>
<span class="fc" id="L4789">                token = JSONToken.NEW;</span>
<span class="fc bfc" id="L4790" title="All 2 branches covered.">            } else if (&quot;true&quot;.equals(ident)) {</span>
<span class="fc" id="L4791">                token = JSONToken.TRUE;</span>
<span class="fc bfc" id="L4792" title="All 2 branches covered.">            } else if (&quot;false&quot;.equals(ident)) {</span>
<span class="fc" id="L4793">                token = JSONToken.FALSE;</span>
<span class="fc bfc" id="L4794" title="All 2 branches covered.">            } else if (&quot;undefined&quot;.equals(ident)) {</span>
<span class="fc" id="L4795">                token = JSONToken.UNDEFINED;</span>
<span class="fc bfc" id="L4796" title="All 2 branches covered.">            } else if (&quot;Set&quot;.equals(ident)) {</span>
<span class="fc" id="L4797">                token = JSONToken.SET;</span>
<span class="fc bfc" id="L4798" title="All 2 branches covered.">            } else if (&quot;TreeSet&quot;.equals(ident)) {</span>
<span class="fc" id="L4799">                token = JSONToken.TREE_SET;</span>
<span class="fc" id="L4800">            } else {</span>
<span class="fc" id="L4801">                token = JSONToken.IDENTIFIER;</span>
            }
<span class="fc" id="L4803">            return;</span>
        }
    }

    public abstract String stringVal();

    public abstract String subString(int offset, int count);

    protected abstract char[] sub_chars(int offset, int count);

    public static String readString(char[] chars, int chars_len) {
<span class="fc" id="L4814">        char[] sbuf = new char[chars_len];</span>
<span class="fc" id="L4815">        int len = 0;</span>
<span class="fc bfc" id="L4816" title="All 2 branches covered.">        for (int i = 0; i &lt; chars_len; ++i) {</span>
<span class="fc" id="L4817">            char ch = chars[i];</span>

<span class="fc bfc" id="L4819" title="All 2 branches covered.">            if (ch != '\\') {</span>
<span class="fc" id="L4820">                sbuf[len++] = ch;</span>
<span class="fc" id="L4821">                continue;</span>
            }
<span class="fc" id="L4823">            ch = chars[++i];</span>

<span class="fc bfc" id="L4825" title="All 21 branches covered.">            switch (ch) {</span>
                case '0':
<span class="fc" id="L4827">                    sbuf[len++] = '\0';</span>
<span class="fc" id="L4828">                    break;</span>
                case '1':
<span class="fc" id="L4830">                    sbuf[len++] = '\1';</span>
<span class="fc" id="L4831">                    break;</span>
                case '2':
<span class="fc" id="L4833">                    sbuf[len++] = '\2';</span>
<span class="fc" id="L4834">                    break;</span>
                case '3':
<span class="fc" id="L4836">                    sbuf[len++] = '\3';</span>
<span class="fc" id="L4837">                    break;</span>
                case '4':
<span class="fc" id="L4839">                    sbuf[len++] = '\4';</span>
<span class="fc" id="L4840">                    break;</span>
                case '5':
<span class="fc" id="L4842">                    sbuf[len++] = '\5';</span>
<span class="fc" id="L4843">                    break;</span>
                case '6':
<span class="fc" id="L4845">                    sbuf[len++] = '\6';</span>
<span class="fc" id="L4846">                    break;</span>
                case '7':
<span class="fc" id="L4848">                    sbuf[len++] = '\7';</span>
<span class="fc" id="L4849">                    break;</span>
                case 'b': // 8
<span class="fc" id="L4851">                    sbuf[len++] = '\b';</span>
<span class="fc" id="L4852">                    break;</span>
                case 't': // 9
<span class="fc" id="L4854">                    sbuf[len++] = '\t';</span>
<span class="fc" id="L4855">                    break;</span>
                case 'n': // 10
<span class="fc" id="L4857">                    sbuf[len++] = '\n';</span>
<span class="fc" id="L4858">                    break;</span>
                case 'v': // 11
<span class="fc" id="L4860">                    sbuf[len++] = '\u000B';</span>
<span class="fc" id="L4861">                    break;</span>
                case 'f': // 12
                case 'F':
<span class="fc" id="L4864">                    sbuf[len++] = '\f';</span>
<span class="fc" id="L4865">                    break;</span>
                case 'r': // 13
<span class="fc" id="L4867">                    sbuf[len++] = '\r';</span>
<span class="fc" id="L4868">                    break;</span>
                case '&quot;': // 34
<span class="fc" id="L4870">                    sbuf[len++] = '&quot;';</span>
<span class="fc" id="L4871">                    break;</span>
                case '\'': // 39
<span class="fc" id="L4873">                    sbuf[len++] = '\'';</span>
<span class="fc" id="L4874">                    break;</span>
                case '/': // 47
<span class="fc" id="L4876">                    sbuf[len++] = '/';</span>
<span class="fc" id="L4877">                    break;</span>
                case '\\': // 92
<span class="fc" id="L4879">                    sbuf[len++] = '\\';</span>
<span class="fc" id="L4880">                    break;</span>
                case 'x':
<span class="fc" id="L4882">                    sbuf[len++] = (char) (digits[chars[++i]] * 16 + digits[chars[++i]]);</span>
<span class="fc" id="L4883">                    break;</span>
                case 'u':
<span class="fc" id="L4885">                    sbuf[len++] = (char) Integer.parseInt(new String(new char[] { chars[++i], //</span>
<span class="fc" id="L4886">                                    chars[++i], //</span>
<span class="fc" id="L4887">                                    chars[++i], //</span>
<span class="fc" id="L4888">                                    chars[++i] }),</span>
<span class="fc" id="L4889">                            16);</span>
<span class="fc" id="L4890">                    break;</span>
                default:
<span class="fc" id="L4892">                    throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
            }
        }
<span class="fc" id="L4895">        return new String(sbuf, 0, len);</span>
    }

    protected abstract boolean charArrayCompare(char[] chars);

    public boolean isBlankInput() {
<span class="fc" id="L4901">        for (int i = 0;; ++i) {</span>
<span class="fc" id="L4902">            char chLocal = charAt(i);</span>
<span class="fc bfc" id="L4903" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L4904">                token = JSONToken.EOF;</span>
<span class="fc" id="L4905">                break;</span>
            }

<span class="fc bfc" id="L4908" title="All 2 branches covered.">            if (!isWhitespace(chLocal)) {</span>
<span class="fc" id="L4909">                return false;</span>
            }
        }

<span class="fc" id="L4913">        return true;</span>
    }

    public final void skipWhitespace() {
<span class="fc" id="L4917">        for (;;) {</span>
<span class="fc bfc" id="L4918" title="All 2 branches covered.">            if (ch &lt;= '/') {</span>
<span class="fc bfc" id="L4919" title="All 2 branches covered.">                if (ch == ' '  ||</span>
<span class="pc bpc" id="L4920" title="1 of 2 branches missed.">                    ch == '\r' ||</span>
<span class="fc bfc" id="L4921" title="All 2 branches covered.">                    ch == '\n' ||</span>
<span class="fc bfc" id="L4922" title="All 2 branches covered.">                    ch == '\t' ||</span>
<span class="pc bpc" id="L4923" title="1 of 2 branches missed.">                    ch == '\f' ||</span>
<span class="pc bpc" id="L4924" title="1 of 2 branches missed.">                    ch == '\b') {</span>
<span class="fc" id="L4925">                    next();</span>
<span class="fc" id="L4926">                    continue;</span>
<span class="fc bfc" id="L4927" title="All 2 branches covered.">                } else if (ch == '/') {</span>
<span class="fc" id="L4928">                    skipComment();</span>
                    continue;
                } else {
                    break;
                }
            } else {
                break;
            }
        }
<span class="fc" id="L4937">    }</span>

    private void scanStringSingleQuote() {
<span class="fc" id="L4940">        np = bp;</span>
<span class="fc" id="L4941">        hasSpecial = false;</span>
        char chLocal;
<span class="fc" id="L4943">        for (;;) {</span>
<span class="fc" id="L4944">            chLocal = next();</span>

<span class="fc bfc" id="L4946" title="All 2 branches covered.">            if (chLocal == '\'') {</span>
<span class="fc" id="L4947">                break;</span>
            }

<span class="fc bfc" id="L4950" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc bfc" id="L4951" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L4952">                    putChar((char) EOI);</span>
<span class="fc" id="L4953">                    continue;</span>
                }
<span class="fc" id="L4955">                throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
            }

<span class="fc bfc" id="L4958" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L4959" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L4960">                    hasSpecial = true;</span>

<span class="pc bpc" id="L4962" title="1 of 2 branches missed.">                    if (sp &gt; sbuf.length) {</span>
<span class="nc" id="L4963">                        char[] newsbuf = new char[sp * 2];</span>
<span class="nc" id="L4964">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L4965">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(offset, offset + count, dest, 0);
<span class="fc" id="L4969">                    this.copyTo(np + 1, sp, sbuf);</span>
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L4973">                chLocal = next();</span>

<span class="fc bfc" id="L4975" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L4977">                        putChar('\0');</span>
<span class="fc" id="L4978">                        break;</span>
                    case '1':
<span class="fc" id="L4980">                        putChar('\1');</span>
<span class="fc" id="L4981">                        break;</span>
                    case '2':
<span class="fc" id="L4983">                        putChar('\2');</span>
<span class="fc" id="L4984">                        break;</span>
                    case '3':
<span class="fc" id="L4986">                        putChar('\3');</span>
<span class="fc" id="L4987">                        break;</span>
                    case '4':
<span class="fc" id="L4989">                        putChar('\4');</span>
<span class="fc" id="L4990">                        break;</span>
                    case '5':
<span class="fc" id="L4992">                        putChar('\5');</span>
<span class="fc" id="L4993">                        break;</span>
                    case '6':
<span class="fc" id="L4995">                        putChar('\6');</span>
<span class="fc" id="L4996">                        break;</span>
                    case '7':
<span class="fc" id="L4998">                        putChar('\7');</span>
<span class="fc" id="L4999">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L5001">                        putChar('\b');</span>
<span class="fc" id="L5002">                        break;</span>
                    case 't': // 9
<span class="fc" id="L5004">                        putChar('\t');</span>
<span class="fc" id="L5005">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L5007">                        putChar('\n');</span>
<span class="fc" id="L5008">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L5010">                        putChar('\u000B');</span>
<span class="fc" id="L5011">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L5014">                        putChar('\f');</span>
<span class="fc" id="L5015">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L5017">                        putChar('\r');</span>
<span class="fc" id="L5018">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L5020">                        putChar('&quot;');</span>
<span class="fc" id="L5021">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L5023">                        putChar('\'');</span>
<span class="fc" id="L5024">                        break;</span>
                    case '/': // 47
<span class="fc" id="L5026">                        putChar('/');</span>
<span class="fc" id="L5027">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L5029">                        putChar('\\');</span>
<span class="fc" id="L5030">                        break;</span>
                    case 'x':
<span class="fc" id="L5032">                        char x1 = next();</span>
<span class="fc" id="L5033">                        char x2 = next();</span>

<span class="pc bpc" id="L5035" title="1 of 6 branches missed.">                        boolean hex1 = (x1 &gt;= '0' &amp;&amp; x1 &lt;= '9')</span>
<span class="pc bpc" id="L5036" title="1 of 4 branches missed.">                                || (x1 &gt;= 'a' &amp;&amp; x1 &lt;= 'f')</span>
<span class="fc bfc" id="L5037" title="All 2 branches covered.">                                || (x1 &gt;= 'A' &amp;&amp; x1 &lt;= 'F');</span>
<span class="pc bpc" id="L5038" title="3 of 6 branches missed.">                        boolean hex2 = (x2 &gt;= '0' &amp;&amp; x2 &lt;= '9')</span>
<span class="pc bpc" id="L5039" title="3 of 4 branches missed.">                                || (x2 &gt;= 'a' &amp;&amp; x2 &lt;= 'f')</span>
<span class="pc bpc" id="L5040" title="1 of 2 branches missed.">                                || (x2 &gt;= 'A' &amp;&amp; x2 &lt;= 'F');</span>
<span class="fc bfc" id="L5041" title="All 4 branches covered.">                        if (!hex1 || !hex2) {</span>
<span class="fc" id="L5042">                            throw new JSONException(&quot;invalid escape character \\x&quot; + x1 + x2);</span>
                        }

<span class="fc" id="L5045">                        putChar((char) (digits[x1] * 16 + digits[x2]));</span>
<span class="fc" id="L5046">                        break;</span>
                    case 'u':
<span class="fc" id="L5048">                        putChar((char) Integer.parseInt(new String(new char[] { next(), next(), next(), next() }), 16));</span>
<span class="fc" id="L5049">                        break;</span>
                    default:
<span class="fc" id="L5051">                        this.ch = chLocal;</span>
<span class="fc" id="L5052">                        throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
                }
                continue;
            }

<span class="fc bfc" id="L5057" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L5058">                sp++;</span>
<span class="fc" id="L5059">                continue;</span>
            }

<span class="fc bfc" id="L5062" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L5063">                putChar(chLocal);</span>
<span class="fc" id="L5064">            } else {</span>
<span class="fc" id="L5065">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L5069">        token = LITERAL_STRING;</span>
<span class="fc" id="L5070">        this.next();</span>
<span class="fc" id="L5071">    }</span>

    /**
     * Append a character to sbuf.
     */
    protected final void putChar(char ch) {
<span class="fc bfc" id="L5077" title="All 2 branches covered.">        if (sp == sbuf.length) {</span>
<span class="fc" id="L5078">            char[] newsbuf = new char[sbuf.length * 2];</span>
<span class="fc" id="L5079">            System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L5080">            sbuf = newsbuf;</span>
        }
<span class="fc" id="L5082">        sbuf[sp++] = ch;</span>
<span class="fc" id="L5083">    }</span>

    public final void scanHex() {
<span class="pc bpc" id="L5086" title="1 of 2 branches missed.">        if (ch != 'x') {</span>
<span class="nc" id="L5087">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }
<span class="fc" id="L5089">        next();</span>
<span class="pc bpc" id="L5090" title="1 of 2 branches missed.">        if (ch != '\'') {</span>
<span class="nc" id="L5091">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }

<span class="fc" id="L5094">        np = bp;</span>
<span class="fc" id="L5095">        next();</span>

<span class="fc bfc" id="L5097" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc" id="L5098">            next();</span>
<span class="fc" id="L5099">            token = JSONToken.HEX;</span>
<span class="fc" id="L5100">            return;</span>
        }

<span class="fc" id="L5103">        for (int i = 0;;++i) {</span>
<span class="fc" id="L5104">            char ch = next();</span>
<span class="pc bpc" id="L5105" title="1 of 8 branches missed.">            if ((ch &gt;= '0' &amp;&amp; ch &lt;= '9') || (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F')) {</span>
<span class="fc" id="L5106">                sp++;</span>
<span class="fc" id="L5107">                continue;</span>
<span class="pc bpc" id="L5108" title="1 of 2 branches missed.">            } else if (ch == '\'') {</span>
<span class="fc" id="L5109">                sp++;</span>
<span class="fc" id="L5110">                next();</span>
<span class="fc" id="L5111">                break;</span>
            } else {
<span class="nc" id="L5113">                throw new JSONException(&quot;illegal state. &quot; + ch);</span>
            }
        }
<span class="fc" id="L5116">        token = JSONToken.HEX;</span>
<span class="fc" id="L5117">    }</span>

    public final void scanNumber() {
<span class="fc" id="L5120">        np = bp;</span>

<span class="fc bfc" id="L5122" title="All 2 branches covered.">        if (ch == '-') {</span>
<span class="fc" id="L5123">            sp++;</span>
<span class="fc" id="L5124">            next();</span>
        }

<span class="fc" id="L5127">        for (;;) {</span>
<span class="fc bfc" id="L5128" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5129">                sp++;</span>
            } else {
                break;
            }
<span class="fc" id="L5133">            next();</span>
        }

<span class="fc" id="L5136">        boolean isDouble = false;</span>

<span class="fc bfc" id="L5138" title="All 2 branches covered.">        if (ch == '.') {</span>
<span class="fc" id="L5139">            sp++;</span>
<span class="fc" id="L5140">            next();</span>
<span class="fc" id="L5141">            isDouble = true;</span>

<span class="fc" id="L5143">            for (;;) {</span>
<span class="fc bfc" id="L5144" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5145">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5149">                next();</span>
            }
        }

<span class="fc bfc" id="L5153" title="All 2 branches covered.">        if (ch == 'L') {</span>
<span class="fc" id="L5154">            sp++;</span>
<span class="fc" id="L5155">            next();</span>
<span class="fc bfc" id="L5156" title="All 2 branches covered.">        } else if (ch == 'S') {</span>
<span class="fc" id="L5157">            sp++;</span>
<span class="fc" id="L5158">            next();</span>
<span class="fc bfc" id="L5159" title="All 2 branches covered.">        } else if (ch == 'B') {</span>
<span class="fc" id="L5160">            sp++;</span>
<span class="fc" id="L5161">            next();</span>
<span class="fc bfc" id="L5162" title="All 2 branches covered.">        } else if (ch == 'F') {</span>
<span class="fc" id="L5163">            sp++;</span>
<span class="fc" id="L5164">            next();</span>
<span class="fc" id="L5165">            isDouble = true;</span>
<span class="fc bfc" id="L5166" title="All 2 branches covered.">        } else if (ch == 'D') {</span>
<span class="fc" id="L5167">            sp++;</span>
<span class="fc" id="L5168">            next();</span>
<span class="fc" id="L5169">            isDouble = true;</span>
<span class="fc bfc" id="L5170" title="All 4 branches covered.">        } else if (ch == 'e' || ch == 'E') {</span>
<span class="fc" id="L5171">            sp++;</span>
<span class="fc" id="L5172">            next();</span>

<span class="fc bfc" id="L5174" title="All 4 branches covered.">            if (ch == '+' || ch == '-') {</span>
<span class="fc" id="L5175">                sp++;</span>
<span class="fc" id="L5176">                next();</span>
            }

<span class="fc" id="L5179">            for (;;) {</span>
<span class="fc bfc" id="L5180" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5181">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5185">                next();</span>
            }

<span class="fc bfc" id="L5188" title="All 4 branches covered.">            if (ch == 'D' || ch == 'F') {</span>
<span class="fc" id="L5189">                sp++;</span>
<span class="fc" id="L5190">                next();</span>
            }

<span class="fc" id="L5193">            isDouble = true;</span>
        }

<span class="fc bfc" id="L5196" title="All 2 branches covered.">        if (isDouble) {</span>
<span class="fc" id="L5197">            token = JSONToken.LITERAL_FLOAT;</span>
<span class="fc" id="L5198">        } else {</span>
<span class="fc" id="L5199">            token = JSONToken.LITERAL_INT;</span>
        }
<span class="fc" id="L5201">    }</span>

    public final long longValue() throws NumberFormatException {
<span class="fc" id="L5204">        long result = 0;</span>
<span class="fc" id="L5205">        boolean negative = false;</span>
        long limit;
        int digit;

<span class="pc bpc" id="L5209" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L5210">            np = 0;</span>
        }

<span class="fc" id="L5213">        int i = np, max = np + sp;</span>

<span class="fc bfc" id="L5215" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L5216">            negative = true;</span>
<span class="fc" id="L5217">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L5218">            i++;</span>
<span class="fc" id="L5219">        } else {</span>
<span class="fc" id="L5220">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L5222">        long multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L5223" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L5224">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L5225">            result = -digit;</span>
        }
<span class="fc bfc" id="L5227" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L5229">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L5231" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L5232">                break;</span>
            }

<span class="fc" id="L5235">            digit = chLocal - '0';</span>
<span class="fc bfc" id="L5236" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L5237">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5239">            result *= 10;</span>
<span class="fc bfc" id="L5240" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L5241">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5243">            result -= digit;</span>
        }

<span class="fc bfc" id="L5246" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L5247" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L5248">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L5250">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L5253">            return -result;</span>
        }
    }

    public final Number decimalValue(boolean decimal) {
<span class="fc" id="L5258">        char chLocal = charAt(np + sp - 1);</span>
        try {
<span class="fc bfc" id="L5260" title="All 2 branches covered.">            if (chLocal == 'F') {</span>
<span class="fc" id="L5261">                return Float.parseFloat(numberString());</span>
            }

<span class="fc bfc" id="L5264" title="All 2 branches covered.">            if (chLocal == 'D') {</span>
<span class="fc" id="L5265">                return Double.parseDouble(numberString());</span>
            }

<span class="fc bfc" id="L5268" title="All 2 branches covered.">            if (decimal) {</span>
<span class="fc" id="L5269">                return decimalValue();</span>
            } else {
<span class="fc" id="L5271">                return doubleValue();</span>
            }
<span class="fc" id="L5273">        } catch (NumberFormatException ex) {</span>
<span class="fc" id="L5274">            throw new JSONException(ex.getMessage() + &quot;, &quot; + info());</span>
        }
    }

    public abstract BigDecimal decimalValue();

    public static boolean isWhitespace(char ch) {
        // 专门调整了判断顺序
<span class="fc bfc" id="L5282" title="All 2 branches covered.">        return ch &lt;= ' '  &amp;&amp;</span>
<span class="fc bfc" id="L5283" title="All 2 branches covered.">              (ch == ' '  ||</span>
<span class="fc bfc" id="L5284" title="All 2 branches covered.">               ch == '\n' ||</span>
<span class="fc bfc" id="L5285" title="All 2 branches covered.">               ch == '\r' ||</span>
<span class="fc bfc" id="L5286" title="All 2 branches covered.">               ch == '\t' ||</span>
<span class="fc bfc" id="L5287" title="All 2 branches covered.">               ch == '\f' ||</span>
<span class="fc bfc" id="L5288" title="All 2 branches covered.">               ch == '\b');</span>
    }

    protected static final long  MULTMIN_RADIX_TEN     = Long.MIN_VALUE / 10;
    protected static final int   INT_MULTMIN_RADIX_TEN = Integer.MIN_VALUE / 10;

<span class="fc" id="L5294">    protected final static int[] digits                = new int[(int) 'f' + 1];</span>

    static {
<span class="fc bfc" id="L5297" title="All 2 branches covered.">        for (int i = '0'; i &lt;= '9'; ++i) {</span>
<span class="fc" id="L5298">            digits[i] = i - '0';</span>
        }

<span class="fc bfc" id="L5301" title="All 2 branches covered.">        for (int i = 'a'; i &lt;= 'f'; ++i) {</span>
<span class="fc" id="L5302">            digits[i] = (i - 'a') + 10;</span>
        }
<span class="fc bfc" id="L5304" title="All 2 branches covered.">        for (int i = 'A'; i &lt;= 'F'; ++i) {</span>
<span class="fc" id="L5305">            digits[i] = (i - 'A') + 10;</span>
        }
<span class="fc" id="L5307">    }</span>

    /**
     * hsf support
     * @param fieldName
     * @param argTypesCount
     * @param typeSymbolTable
     * @return
     */
    public String[] scanFieldStringArray(char[] fieldName, int argTypesCount, SymbolTable typeSymbolTable) {
<span class="nc" id="L5317">        throw new UnsupportedOperationException();</span>
    }

    public boolean matchField2(char[] fieldName) {
<span class="nc" id="L5321">        throw new UnsupportedOperationException();</span>
    }

    public int getFeatures() {
<span class="fc" id="L5325">        return this.features;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>