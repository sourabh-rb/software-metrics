<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSONLexerBase.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fastjson</a> &gt; <a href="index.source.html" class="el_package">com.alibaba.fastjson.parser</a> &gt; <span class="el_source">JSONLexerBase.java</span></div><h1>JSONLexerBase.java</h1><pre class="source lang-java linenums">/*
 * Copyright 1999-2017 Alibaba Group.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.alibaba.fastjson.parser;

import java.io.Closeable;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.*;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONException;
import com.alibaba.fastjson.util.IOUtils;

import static com.alibaba.fastjson.parser.JSONToken.*;

/**
 * @author wenshao[szujobs@hotmail.com]
 */
public abstract class JSONLexerBase implements JSONLexer, Closeable {

    protected void lexError(String key, Object... args) {
<span class="fc" id="L35">        token = ERROR;</span>
<span class="fc" id="L36">    }</span>

    protected int                            token;
    protected int                            pos;
    protected int                            features;

    protected char                           ch;
    protected int                            bp;

    protected int                            eofPos;

    /**
     * A character buffer for literals.
     */
    protected char[]                         sbuf;
    protected int                            sp;

    /**
     * number start position
     */
    protected int                            np;

    protected boolean                        hasSpecial;

<span class="fc" id="L60">    protected Calendar                       calendar           = null;</span>
<span class="fc" id="L61">    protected TimeZone                       timeZone           = JSON.defaultTimeZone;</span>
<span class="fc" id="L62">    protected Locale                         locale             = JSON.defaultLocale;</span>

<span class="fc" id="L64">    public int                               matchStat          = UNKNOWN;</span>

<span class="fc" id="L66">    private final static ThreadLocal&lt;char[]&gt; SBUF_LOCAL         = new ThreadLocal&lt;char[]&gt;();</span>

<span class="fc" id="L68">    protected String                         stringDefaultValue = null;</span>

<span class="fc" id="L70">    public JSONLexerBase(int features){</span>
<span class="fc" id="L71">        this.features = features;</span>

<span class="fc bfc" id="L73" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L74">            stringDefaultValue = &quot;&quot;;</span>
        }

<span class="fc" id="L77">        sbuf = SBUF_LOCAL.get();</span>

<span class="fc bfc" id="L79" title="All 2 branches covered.">        if (sbuf == null) {</span>
<span class="fc" id="L80">            sbuf = new char[512];</span>
        }
<span class="fc" id="L82">    }</span>

    public final int matchStat() {
<span class="fc" id="L85">        return matchStat;</span>
    }

    /**
     * internal method, don't invoke
     * @param token
     */
    public void setToken(int token) {
<span class="fc" id="L93">        this.token = token;</span>
<span class="fc" id="L94">    }</span>

    public final void nextToken() {
<span class="fc" id="L97">        sp = 0;</span>

        for (;;) {
<span class="fc" id="L100">            pos = bp;</span>

<span class="fc bfc" id="L102" title="All 2 branches covered.">            if (ch == '/') {</span>
<span class="fc" id="L103">                skipComment();</span>
<span class="fc" id="L104">                continue;</span>
            }

<span class="fc bfc" id="L107" title="All 2 branches covered.">            if (ch == '&quot;') {</span>
<span class="fc" id="L108">                scanString();</span>
<span class="fc" id="L109">                return;</span>
            }

<span class="fc bfc" id="L112" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L113">                next();</span>
<span class="fc" id="L114">                token = COMMA;</span>
<span class="fc" id="L115">                return;</span>
            }

<span class="fc bfc" id="L118" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L119">                scanNumber();</span>
<span class="fc" id="L120">                return;</span>
            }

<span class="fc bfc" id="L123" title="All 2 branches covered.">            if (ch == '-') {</span>
<span class="fc" id="L124">                scanNumber();</span>
<span class="fc" id="L125">                return;</span>
            }

<span class="fc bfc" id="L128" title="All 18 branches covered.">            switch (ch) {</span>
                case '\'':
<span class="fc bfc" id="L130" title="All 2 branches covered.">                    if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L131">                        throw new JSONException(&quot;Feature.AllowSingleQuotes is false&quot;);</span>
                    }
<span class="fc" id="L133">                    scanStringSingleQuote();</span>
<span class="fc" id="L134">                    return;</span>
                case ' ':
                case '\t':
                case '\b':
                case '\f':
                case '\n':
                case '\r':
<span class="fc" id="L141">                    next();</span>
<span class="fc" id="L142">                    break;</span>
                case 't': // true
<span class="fc" id="L144">                    scanTrue();</span>
<span class="fc" id="L145">                    return;</span>
                case 'f': // false
<span class="fc" id="L147">                    scanFalse();</span>
<span class="fc" id="L148">                    return;</span>
                case 'n': // new,null
<span class="fc" id="L150">                    scanNullOrNew();</span>
<span class="fc" id="L151">                    return;</span>
                case 'T':
                case 'N': // NULL
                case 'S':
                case 'u': // undefined
<span class="fc" id="L156">                    scanIdent();</span>
<span class="fc" id="L157">                    return;</span>
                case '(':
<span class="fc" id="L159">                    next();</span>
<span class="fc" id="L160">                    token = LPAREN;</span>
<span class="fc" id="L161">                    return;</span>
                case ')':
<span class="fc" id="L163">                    next();</span>
<span class="fc" id="L164">                    token = RPAREN;</span>
<span class="fc" id="L165">                    return;</span>
                case '[':
<span class="fc" id="L167">                    next();</span>
<span class="fc" id="L168">                    token = LBRACKET;</span>
<span class="fc" id="L169">                    return;</span>
                case ']':
<span class="fc" id="L171">                    next();</span>
<span class="fc" id="L172">                    token = RBRACKET;</span>
<span class="fc" id="L173">                    return;</span>
                case '{':
<span class="fc" id="L175">                    next();</span>
<span class="fc" id="L176">                    token = LBRACE;</span>
<span class="fc" id="L177">                    return;</span>
                case '}':
<span class="fc" id="L179">                    next();</span>
<span class="fc" id="L180">                    token = RBRACE;</span>
<span class="fc" id="L181">                    return;</span>
                case ':':
<span class="fc" id="L183">                    next();</span>
<span class="fc" id="L184">                    token = COLON;</span>
<span class="fc" id="L185">                    return;</span>
                case ';':
<span class="fc" id="L187">                    next();</span>
<span class="fc" id="L188">                    token = SEMI;</span>
<span class="fc" id="L189">                    return;</span>
                case '.':
<span class="fc" id="L191">                    next();</span>
<span class="fc" id="L192">                    token = DOT;</span>
<span class="fc" id="L193">                    return;</span>
                case '+':
<span class="fc" id="L195">                    next();</span>
<span class="fc" id="L196">                    scanNumber();</span>
<span class="fc" id="L197">                    return;</span>
                case 'x':
<span class="fc" id="L199">                    scanHex();</span>
<span class="fc" id="L200">                    return;</span>
                default:
<span class="fc bfc" id="L202" title="All 2 branches covered.">                    if (isEOF()) { // JLS</span>
<span class="fc bfc" id="L203" title="All 2 branches covered.">                        if (token == EOF) {</span>
<span class="fc" id="L204">                            throw new JSONException(&quot;EOF error&quot;);</span>
                        }

<span class="fc" id="L207">                        token = EOF;</span>
<span class="fc" id="L208">                        eofPos = pos = bp;</span>
                    } else {
<span class="fc bfc" id="L210" title="All 4 branches covered.">                        if (ch &lt;= 31 || ch == 127) {</span>
<span class="fc" id="L211">                            next();</span>
<span class="fc" id="L212">                            break;</span>
                        }

<span class="fc" id="L215">                        lexError(&quot;illegal.char&quot;, String.valueOf((int) ch));</span>
<span class="fc" id="L216">                        next();</span>
                    }

<span class="fc" id="L219">                    return;</span>
            }
        }

    }

    public final void nextToken(int expect) {
<span class="fc" id="L226">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L229" title="All 9 branches covered.">            switch (expect) {</span>
                case JSONToken.LBRACE:
<span class="fc bfc" id="L231" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L232">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L233">                        next();</span>
<span class="fc" id="L234">                        return;</span>
                    }
<span class="fc bfc" id="L236" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L237">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L238">                        next();</span>
<span class="fc" id="L239">                        return;</span>
                    }
                    break;
                case JSONToken.COMMA:
<span class="fc bfc" id="L243" title="All 2 branches covered.">                    if (ch == ',') {</span>
<span class="fc" id="L244">                        token = JSONToken.COMMA;</span>
<span class="fc" id="L245">                        next();</span>
<span class="fc" id="L246">                        return;</span>
                    }

<span class="fc bfc" id="L249" title="All 2 branches covered.">                    if (ch == '}') {</span>
<span class="fc" id="L250">                        token = JSONToken.RBRACE;</span>
<span class="fc" id="L251">                        next();</span>
<span class="fc" id="L252">                        return;</span>
                    }

<span class="fc bfc" id="L255" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L256">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L257">                        next();</span>
<span class="fc" id="L258">                        return;</span>
                    }

<span class="fc bfc" id="L261" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L262">                        token = JSONToken.EOF;</span>
<span class="fc" id="L263">                        return;</span>
                    }
                    break;
                case JSONToken.LITERAL_INT:
<span class="fc bfc" id="L267" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L268">                        pos = bp;</span>
<span class="fc" id="L269">                        scanNumber();</span>
<span class="fc" id="L270">                        return;</span>
                    }

<span class="fc bfc" id="L273" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L274">                        pos = bp;</span>
<span class="fc" id="L275">                        scanString();</span>
<span class="fc" id="L276">                        return;</span>
                    }

<span class="fc bfc" id="L279" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L280">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L281">                        next();</span>
<span class="fc" id="L282">                        return;</span>
                    }

<span class="fc bfc" id="L285" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L286">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L287">                        next();</span>
<span class="fc" id="L288">                        return;</span>
                    }

                    break;
                case JSONToken.LITERAL_STRING:
<span class="fc bfc" id="L293" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L294">                        pos = bp;</span>
<span class="fc" id="L295">                        scanString();</span>
<span class="fc" id="L296">                        return;</span>
                    }

<span class="fc bfc" id="L299" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L300">                        pos = bp;</span>
<span class="fc" id="L301">                        scanNumber();</span>
<span class="fc" id="L302">                        return;</span>
                    }

<span class="fc bfc" id="L305" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L306">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L307">                        next();</span>
<span class="fc" id="L308">                        return;</span>
                    }

<span class="fc bfc" id="L311" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L312">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L313">                        next();</span>
<span class="fc" id="L314">                        return;</span>
                    }
                    break;
                case JSONToken.LBRACKET:
<span class="fc bfc" id="L318" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L319">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L320">                        next();</span>
<span class="fc" id="L321">                        return;</span>
                    }

<span class="fc bfc" id="L324" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L325">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L326">                        next();</span>
<span class="fc" id="L327">                        return;</span>
                    }
                    break;
                case JSONToken.RBRACKET:
<span class="fc bfc" id="L331" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L332">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L333">                        next();</span>
<span class="fc" id="L334">                        return;</span>
                    }
                case JSONToken.EOF:
<span class="fc bfc" id="L337" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L338">                        token = JSONToken.EOF;</span>
<span class="fc" id="L339">                        return;</span>
                    }
                    break;
                case JSONToken.IDENTIFIER:
<span class="fc" id="L343">                    nextIdent();</span>
<span class="fc" id="L344">                    return;</span>
                default:
                    break;
            }

<span class="fc bfc" id="L349" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L350">                next();</span>
<span class="fc" id="L351">                continue;</span>
            }

<span class="fc" id="L354">            nextToken();</span>
<span class="fc" id="L355">            break;</span>
        }
<span class="fc" id="L357">    }</span>

    public final void nextIdent() {
<span class="fc bfc" id="L360" title="All 2 branches covered.">        while (isWhitespace(ch)) {</span>
<span class="fc" id="L361">            next();</span>
        }
<span class="fc bfc" id="L363" title="All 6 branches covered.">        if (ch == '_' || ch == '$' || Character.isLetter(ch)) {</span>
<span class="fc" id="L364">            scanIdent();</span>
        } else {
<span class="fc" id="L366">            nextToken();</span>
        }
<span class="fc" id="L368">    }</span>

    public final void nextTokenWithColon() {
<span class="fc" id="L371">        nextTokenWithChar(':');</span>
<span class="fc" id="L372">    }</span>

    public final void nextTokenWithChar(char expect) {
<span class="fc" id="L375">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L378" title="All 2 branches covered.">            if (ch == expect) {</span>
<span class="fc" id="L379">                next();</span>
<span class="fc" id="L380">                nextToken();</span>
<span class="fc" id="L381">                return;</span>
            }

<span class="fc bfc" id="L384" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L385">                next();</span>
<span class="fc" id="L386">                continue;</span>
            }

<span class="fc" id="L389">            throw new JSONException(&quot;not match &quot; + expect + &quot; - &quot; + ch + &quot;, info : &quot; + this.info());</span>
        }
    }

    public final int token() {
<span class="fc" id="L394">        return token;</span>
    }

    public final String tokenName() {
<span class="fc" id="L398">        return JSONToken.name(token);</span>
    }

    public final int pos() {
<span class="fc" id="L402">        return pos;</span>
    }

    public final String stringDefaultValue() {
<span class="fc" id="L406">        return stringDefaultValue;</span>
    }

    public final Number integerValue() throws NumberFormatException {
<span class="fc" id="L410">        long result = 0;</span>
<span class="fc" id="L411">        boolean negative = false;</span>
<span class="fc bfc" id="L412" title="All 2 branches covered.">        if (np == -1) {</span>
<span class="fc" id="L413">            np = 0;</span>
        }
<span class="fc" id="L415">        int i = np, max = np + sp;</span>
        long limit;
        long multmin;
        int digit;

<span class="fc" id="L420">        char type = ' ';</span>

<span class="fc bfc" id="L422" title="All 4 branches covered.">        switch (charAt(max - 1)) {</span>
            case 'L':
<span class="fc" id="L424">                max--;</span>
<span class="fc" id="L425">                type = 'L';</span>
<span class="fc" id="L426">                break;</span>
            case 'S':
<span class="fc" id="L428">                max--;</span>
<span class="fc" id="L429">                type = 'S';</span>
<span class="fc" id="L430">                break;</span>
            case 'B':
<span class="fc" id="L432">                max--;</span>
<span class="fc" id="L433">                type = 'B';</span>
<span class="fc" id="L434">                break;</span>
            default:
                break;
        }

<span class="fc bfc" id="L439" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L440">            negative = true;</span>
<span class="fc" id="L441">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L442">            i++;</span>
        } else {
<span class="fc" id="L444">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L446">        multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L447" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L448">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L449">            result = -digit;</span>
        }
<span class="fc bfc" id="L451" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L453">            digit = charAt(i++) - '0';</span>
<span class="fc bfc" id="L454" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L455">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L457">            result *= 10;</span>
<span class="fc bfc" id="L458" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L459">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L461">            result -= digit;</span>
        }

<span class="fc bfc" id="L464" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L465" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc bfc" id="L466" title="All 4 branches covered.">                if (result &gt;= Integer.MIN_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L467" title="All 2 branches covered.">                    if (type == 'S') {</span>
<span class="fc" id="L468">                        return (short) result;</span>
                    }

<span class="fc bfc" id="L471" title="All 2 branches covered.">                    if (type == 'B') {</span>
<span class="fc" id="L472">                        return (byte) result;</span>
                    }

<span class="fc" id="L475">                    return (int) result;</span>
                }
<span class="fc" id="L477">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L479">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L482">            result = -result;</span>
<span class="fc bfc" id="L483" title="All 4 branches covered.">            if (result &lt;= Integer.MAX_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L484" title="All 2 branches covered.">                if (type == 'S') {</span>
<span class="fc" id="L485">                    return (short) result;</span>
                }

<span class="fc bfc" id="L488" title="All 2 branches covered.">                if (type == 'B') {</span>
<span class="fc" id="L489">                    return (byte) result;</span>
                }

<span class="fc" id="L492">                return (int) result;</span>
            }
<span class="fc" id="L494">            return result;</span>
        }
    }

    public final void nextTokenWithColon(int expect) {
<span class="fc" id="L499">        nextTokenWithChar(':');</span>
<span class="fc" id="L500">    }</span>

    public float floatValue() {
<span class="fc" id="L503">        String strVal = numberString();</span>
<span class="fc" id="L504">        float floatValue = Float.parseFloat(strVal);</span>
<span class="fc bfc" id="L505" title="All 4 branches covered.">        if (floatValue == 0 || floatValue == Float.POSITIVE_INFINITY) {</span>
<span class="fc" id="L506">            char c0 = strVal.charAt(0);</span>
<span class="pc bpc" id="L507" title="1 of 4 branches missed.">            if (c0 &gt; '0' &amp;&amp; c0 &lt;= '9') {</span>
<span class="fc" id="L508">                throw new JSONException(&quot;float overflow : &quot; + strVal);</span>
            }
        }
<span class="fc" id="L511">        return floatValue;</span>
    }

    public double doubleValue() {
<span class="fc" id="L515">        return Double.parseDouble(numberString());</span>
    }

    public void config(Feature feature, boolean state) {
<span class="fc" id="L519">        features = Feature.config(features, feature, state);</span>

<span class="fc bfc" id="L521" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L522">            stringDefaultValue = &quot;&quot;;</span>
        }
<span class="fc" id="L524">    }</span>

    public final boolean isEnabled(Feature feature) {
<span class="fc" id="L527">        return isEnabled(feature.mask);</span>
    }

    public final boolean isEnabled(int feature) {
<span class="fc bfc" id="L531" title="All 2 branches covered.">        return (this.features &amp; feature) != 0;</span>
    }

    public final boolean isEnabled(int features, int feature) {
<span class="pc bpc" id="L535" title="1 of 4 branches missed.">        return (this.features &amp; feature) != 0 || (features &amp; feature) != 0;</span>
    }

    public abstract String numberString();

    public abstract boolean isEOF();

    public final char getCurrent() {
<span class="fc" id="L543">        return ch;</span>
    }

    public abstract char charAt(int index);

    // public final char next() {
    // ch = doNext();
    //// if (ch == '/' &amp;&amp; (this.features &amp; Feature.AllowComment.mask) != 0) {
    //// skipComment();
    //// }
    // return ch;
    // }

    public abstract char next();

    protected void skipComment() {
<span class="fc" id="L559">        next();</span>
<span class="fc bfc" id="L560" title="All 2 branches covered.">        if (ch == '/') {</span>
            for (;;) {
<span class="fc" id="L562">                next();</span>
<span class="fc bfc" id="L563" title="All 2 branches covered.">                if (ch == '\n') {</span>
<span class="fc" id="L564">                    next();</span>
<span class="fc" id="L565">                    return;</span>
<span class="fc bfc" id="L566" title="All 2 branches covered.">                } else if (ch == EOI) {</span>
<span class="fc" id="L567">                    return;</span>
                }
            }
<span class="fc bfc" id="L570" title="All 2 branches covered.">        } else if (ch == '*') {</span>
<span class="fc" id="L571">            next();</span>

<span class="pc bpc" id="L573" title="1 of 2 branches missed.">            for (; ch != EOI;) {</span>
<span class="fc bfc" id="L574" title="All 2 branches covered.">                if (ch == '*') {</span>
<span class="fc" id="L575">                    next();</span>
<span class="fc bfc" id="L576" title="All 2 branches covered.">                    if (ch == '/') {</span>
<span class="fc" id="L577">                        next();</span>
<span class="fc" id="L578">                        return;</span>
                    } else {
                        continue;
                    }
                }
<span class="fc" id="L583">                next();</span>
            }
        } else {
<span class="fc" id="L586">            throw new JSONException(&quot;invalid comment&quot;);</span>
        }
<span class="nc" id="L588">    }</span>

    public final String scanSymbol(final SymbolTable symbolTable) {
<span class="fc" id="L591">        skipWhitespace();</span>

<span class="fc bfc" id="L593" title="All 2 branches covered.">        if (ch == '&quot;') {</span>
<span class="fc" id="L594">            return scanSymbol(symbolTable, '&quot;');</span>
        }

<span class="fc bfc" id="L597" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc bfc" id="L598" title="All 2 branches covered.">            if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L599">                throw new JSONException(&quot;syntax error&quot;);</span>
            }

<span class="fc" id="L602">            return scanSymbol(symbolTable, '\'');</span>
        }

<span class="fc bfc" id="L605" title="All 2 branches covered.">        if (ch == '}') {</span>
<span class="fc" id="L606">            next();</span>
<span class="fc" id="L607">            token = JSONToken.RBRACE;</span>
<span class="fc" id="L608">            return null;</span>
        }

<span class="fc bfc" id="L611" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L612">            next();</span>
<span class="fc" id="L613">            token = JSONToken.COMMA;</span>
<span class="fc" id="L614">            return null;</span>
        }

<span class="fc bfc" id="L617" title="All 2 branches covered.">        if (ch == EOI) {</span>
<span class="fc" id="L618">            token = JSONToken.EOF;</span>
<span class="fc" id="L619">            return null;</span>
        }

<span class="fc bfc" id="L622" title="All 2 branches covered.">        if (!isEnabled(Feature.AllowUnQuotedFieldNames)) {</span>
<span class="fc" id="L623">            throw new JSONException(&quot;syntax error&quot;);</span>
        }

<span class="fc" id="L626">        return scanSymbolUnQuoted(symbolTable);</span>
    }

    // public abstract String scanSymbol(final SymbolTable symbolTable, final char quote);

    protected abstract void arrayCopy(int srcPos, char[] dest, int destPos, int length);

    public final String scanSymbol(final SymbolTable symbolTable, final char quote) {
<span class="fc" id="L634">        int hash = 0;</span>

<span class="fc" id="L636">        np = bp;</span>
<span class="fc" id="L637">        sp = 0;</span>
<span class="fc" id="L638">        boolean hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L641">            chLocal = next();</span>

<span class="fc bfc" id="L643" title="All 2 branches covered.">            if (chLocal == quote) {</span>
<span class="fc" id="L644">                break;</span>
            }

<span class="fc bfc" id="L647" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L648">                throw new JSONException(&quot;unclosed.str&quot;);</span>
            }

<span class="fc bfc" id="L651" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L652" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L653">                    hasSpecial = true;</span>

<span class="fc bfc" id="L655" title="All 2 branches covered.">                    if (sp &gt;= sbuf.length) {</span>
<span class="fc" id="L656">                        int newCapcity = sbuf.length * 2;</span>
<span class="pc bpc" id="L657" title="1 of 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L658">                            newCapcity = sp;</span>
                        }
<span class="fc" id="L660">                        char[] newsbuf = new char[newCapcity];</span>
<span class="fc" id="L661">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L662">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(this.buf, np + 1, sbuf, 0, sp);
<span class="fc" id="L667">                    arrayCopy(np + 1, sbuf, 0, sp);</span>
                }

<span class="fc" id="L670">                chLocal = next();</span>

<span class="fc bfc" id="L672" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L674">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L675">                        putChar('\0');</span>
<span class="fc" id="L676">                        break;</span>
                    case '1':
<span class="fc" id="L678">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L679">                        putChar('\1');</span>
<span class="fc" id="L680">                        break;</span>
                    case '2':
<span class="fc" id="L682">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L683">                        putChar('\2');</span>
<span class="fc" id="L684">                        break;</span>
                    case '3':
<span class="fc" id="L686">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L687">                        putChar('\3');</span>
<span class="fc" id="L688">                        break;</span>
                    case '4':
<span class="fc" id="L690">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L691">                        putChar('\4');</span>
<span class="fc" id="L692">                        break;</span>
                    case '5':
<span class="fc" id="L694">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L695">                        putChar('\5');</span>
<span class="fc" id="L696">                        break;</span>
                    case '6':
<span class="fc" id="L698">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L699">                        putChar('\6');</span>
<span class="fc" id="L700">                        break;</span>
                    case '7':
<span class="fc" id="L702">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L703">                        putChar('\7');</span>
<span class="fc" id="L704">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L706">                        hash = 31 * hash + (int) '\b';</span>
<span class="fc" id="L707">                        putChar('\b');</span>
<span class="fc" id="L708">                        break;</span>
                    case 't': // 9
<span class="fc" id="L710">                        hash = 31 * hash + (int) '\t';</span>
<span class="fc" id="L711">                        putChar('\t');</span>
<span class="fc" id="L712">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L714">                        hash = 31 * hash + (int) '\n';</span>
<span class="fc" id="L715">                        putChar('\n');</span>
<span class="fc" id="L716">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L718">                        hash = 31 * hash + (int) '\u000B';</span>
<span class="fc" id="L719">                        putChar('\u000B');</span>
<span class="fc" id="L720">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L723">                        hash = 31 * hash + (int) '\f';</span>
<span class="fc" id="L724">                        putChar('\f');</span>
<span class="fc" id="L725">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L727">                        hash = 31 * hash + (int) '\r';</span>
<span class="fc" id="L728">                        putChar('\r');</span>
<span class="fc" id="L729">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L731">                        hash = 31 * hash + (int) '&quot;';</span>
<span class="fc" id="L732">                        putChar('&quot;');</span>
<span class="fc" id="L733">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L735">                        hash = 31 * hash + (int) '\'';</span>
<span class="fc" id="L736">                        putChar('\'');</span>
<span class="fc" id="L737">                        break;</span>
                    case '/': // 47
<span class="fc" id="L739">                        hash = 31 * hash + (int) '/';</span>
<span class="fc" id="L740">                        putChar('/');</span>
<span class="fc" id="L741">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L743">                        hash = 31 * hash + (int) '\\';</span>
<span class="fc" id="L744">                        putChar('\\');</span>
<span class="fc" id="L745">                        break;</span>
                    case 'x':
<span class="fc" id="L747">                        char x1 = ch = next();</span>
<span class="fc" id="L748">                        char x2 = ch = next();</span>

<span class="fc" id="L750">                        int x_val = digits[x1] * 16 + digits[x2];</span>
<span class="fc" id="L751">                        char x_char = (char) x_val;</span>
<span class="fc" id="L752">                        hash = 31 * hash + (int) x_char;</span>
<span class="fc" id="L753">                        putChar(x_char);</span>
<span class="fc" id="L754">                        break;</span>
                    case 'u':
<span class="fc" id="L756">                        char c1 = chLocal = next();</span>
<span class="fc" id="L757">                        char c2 = chLocal = next();</span>
<span class="fc" id="L758">                        char c3 = chLocal = next();</span>
<span class="fc" id="L759">                        char c4 = chLocal = next();</span>
<span class="fc" id="L760">                        int val = Integer.parseInt(new String(new char[] { c1, c2, c3, c4 }), 16);</span>
<span class="fc" id="L761">                        hash = 31 * hash + val;</span>
<span class="fc" id="L762">                        putChar((char) val);</span>
<span class="fc" id="L763">                        break;</span>
                    default:
<span class="fc" id="L765">                        this.ch = chLocal;</span>
<span class="fc" id="L766">                        throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
                }
                continue;
            }

<span class="fc" id="L771">            hash = 31 * hash + chLocal;</span>

<span class="fc bfc" id="L773" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L774">                sp++;</span>
<span class="fc" id="L775">                continue;</span>
            }

<span class="fc bfc" id="L778" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L779">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L781">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L785">        token = LITERAL_STRING;</span>

        String value;
<span class="fc bfc" id="L788" title="All 2 branches covered.">        if (!hasSpecial) {</span>
            // return this.text.substring(np + 1, np + 1 + sp).intern();
            int offset;
<span class="pc bpc" id="L791" title="1 of 2 branches missed.">            if (np == -1) {</span>
<span class="nc" id="L792">                offset = 0;</span>
            } else {
<span class="fc" id="L794">                offset = np + 1;</span>
            }
<span class="fc" id="L796">            value = addSymbol(offset, sp, hash, symbolTable);</span>
<span class="fc" id="L797">        } else {</span>
<span class="fc" id="L798">            value = symbolTable.addSymbol(sbuf, 0, sp, hash);</span>
        }

<span class="fc" id="L801">        sp = 0;</span>
<span class="fc" id="L802">        this.next();</span>

<span class="fc" id="L804">        return value;</span>
    }

    public final void resetStringPosition() {
<span class="fc" id="L808">        this.sp = 0;</span>
<span class="fc" id="L809">    }</span>

    public String info() {
<span class="fc" id="L812">        return &quot;&quot;;</span>
    }

    public final String scanSymbolUnQuoted(final SymbolTable symbolTable) {
<span class="pc bpc" id="L816" title="2 of 6 branches missed.">        if (token == JSONToken.ERROR &amp;&amp; pos == 0 &amp;&amp; bp == 1) {</span>
<span class="fc" id="L817">            bp = 0; // adjust</span>
        }
<span class="fc" id="L819">        final boolean[] firstIdentifierFlags = IOUtils.firstIdentifierFlags;</span>
<span class="fc" id="L820">        final char first = ch;</span>

<span class="pc bpc" id="L822" title="1 of 4 branches missed.">        final boolean firstFlag = ch &gt;= firstIdentifierFlags.length || firstIdentifierFlags[first];</span>
<span class="fc bfc" id="L823" title="All 2 branches covered.">        if (!firstFlag) {</span>
<span class="fc" id="L824">            throw new JSONException(&quot;illegal identifier : &quot; + ch //</span>
<span class="fc" id="L825">                    + info());</span>
        }

<span class="fc" id="L828">        final boolean[] identifierFlags = IOUtils.identifierFlags;</span>

<span class="fc" id="L830">        int hash = first;</span>

<span class="fc" id="L832">        np = bp;</span>
<span class="fc" id="L833">        sp = 1;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L836">            chLocal = next();</span>

<span class="pc bpc" id="L838" title="1 of 2 branches missed.">            if (chLocal &lt; identifierFlags.length) {</span>
<span class="fc bfc" id="L839" title="All 2 branches covered.">                if (!identifierFlags[chLocal]) {</span>
<span class="fc" id="L840">                    break;</span>
                }
            }

<span class="fc" id="L844">            hash = 31 * hash + chLocal;</span>

<span class="fc" id="L846">            sp++;</span>
<span class="fc" id="L847">            continue;</span>
        }

<span class="fc" id="L850">        this.ch = charAt(bp);</span>
<span class="fc" id="L851">        token = JSONToken.IDENTIFIER;</span>

<span class="fc" id="L853">        final int NULL_HASH = 3392903;</span>
<span class="pc bpc" id="L854" title="3 of 10 branches missed.">        if (sp == 4 &amp;&amp; hash == NULL_HASH &amp;&amp; charAt(np) == 'n' &amp;&amp; charAt(np + 1) == 'u' &amp;&amp; charAt(np + 2) == 'l'</span>
<span class="pc bpc" id="L855" title="1 of 2 branches missed.">                &amp;&amp; charAt(np + 3) == 'l') {</span>
<span class="fc" id="L856">            return null;</span>
        }

        // return text.substring(np, np + sp).intern();

<span class="pc bpc" id="L861" title="1 of 2 branches missed.">        if (symbolTable == null) {</span>
<span class="nc" id="L862">            return subString(np, sp);</span>
        }

<span class="fc" id="L865">        return this.addSymbol(np, sp, hash, symbolTable);</span>
        // return symbolTable.addSymbol(buf, np, sp, hash);
    }

    protected abstract void copyTo(int offset, int count, char[] dest);

    public final void scanString() {
<span class="fc" id="L872">        np = bp;</span>
<span class="fc" id="L873">        hasSpecial = false;</span>
        char ch;
        for (;;) {
<span class="fc" id="L876">            ch = next();</span>

<span class="fc bfc" id="L878" title="All 2 branches covered.">            if (ch == '\&quot;') {</span>
<span class="fc" id="L879">                break;</span>
            }

<span class="fc bfc" id="L882" title="All 2 branches covered.">            if (ch == EOI) {</span>
<span class="fc bfc" id="L883" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L884">                    putChar((char) EOI);</span>
<span class="fc" id="L885">                    continue;</span>
                }
<span class="fc" id="L887">                throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
            }

<span class="fc bfc" id="L890" title="All 2 branches covered.">            if (ch == '\\') {</span>
<span class="fc bfc" id="L891" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L892">                    hasSpecial = true;</span>

<span class="pc bpc" id="L894" title="1 of 2 branches missed.">                    if (sp &gt;= sbuf.length) {</span>
<span class="nc" id="L895">                        int newCapcity = sbuf.length * 2;</span>
<span class="nc bnc" id="L896" title="All 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L897">                            newCapcity = sp;</span>
                        }
<span class="nc" id="L899">                        char[] newsbuf = new char[newCapcity];</span>
<span class="nc" id="L900">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L901">                        sbuf = newsbuf;</span>
                    }

<span class="fc" id="L904">                    copyTo(np + 1, sp, sbuf);</span>
                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L909">                ch = next();</span>

<span class="fc bfc" id="L911" title="All 21 branches covered.">                switch (ch) {</span>
                    case '0':
<span class="fc" id="L913">                        putChar('\0');</span>
<span class="fc" id="L914">                        break;</span>
                    case '1':
<span class="fc" id="L916">                        putChar('\1');</span>
<span class="fc" id="L917">                        break;</span>
                    case '2':
<span class="fc" id="L919">                        putChar('\2');</span>
<span class="fc" id="L920">                        break;</span>
                    case '3':
<span class="fc" id="L922">                        putChar('\3');</span>
<span class="fc" id="L923">                        break;</span>
                    case '4':
<span class="fc" id="L925">                        putChar('\4');</span>
<span class="fc" id="L926">                        break;</span>
                    case '5':
<span class="fc" id="L928">                        putChar('\5');</span>
<span class="fc" id="L929">                        break;</span>
                    case '6':
<span class="fc" id="L931">                        putChar('\6');</span>
<span class="fc" id="L932">                        break;</span>
                    case '7':
<span class="fc" id="L934">                        putChar('\7');</span>
<span class="fc" id="L935">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L937">                        putChar('\b');</span>
<span class="fc" id="L938">                        break;</span>
                    case 't': // 9
<span class="fc" id="L940">                        putChar('\t');</span>
<span class="fc" id="L941">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L943">                        putChar('\n');</span>
<span class="fc" id="L944">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L946">                        putChar('\u000B');</span>
<span class="fc" id="L947">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L950">                        putChar('\f');</span>
<span class="fc" id="L951">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L953">                        putChar('\r');</span>
<span class="fc" id="L954">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L956">                        putChar('&quot;');</span>
<span class="fc" id="L957">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L959">                        putChar('\'');</span>
<span class="fc" id="L960">                        break;</span>
                    case '/': // 47
<span class="fc" id="L962">                        putChar('/');</span>
<span class="fc" id="L963">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L965">                        putChar('\\');</span>
<span class="fc" id="L966">                        break;</span>
                    case 'x':
<span class="fc" id="L968">                        char x1 = ch = next();</span>
<span class="fc" id="L969">                        char x2 = ch = next();</span>

<span class="fc" id="L971">                        int x_val = digits[x1] * 16 + digits[x2];</span>
<span class="fc" id="L972">                        char x_char = (char) x_val;</span>
<span class="fc" id="L973">                        putChar(x_char);</span>
<span class="fc" id="L974">                        break;</span>
                    case 'u':
<span class="fc" id="L976">                        char u1 = ch = next();</span>
<span class="fc" id="L977">                        char u2 = ch = next();</span>
<span class="fc" id="L978">                        char u3 = ch = next();</span>
<span class="fc" id="L979">                        char u4 = ch = next();</span>
<span class="fc" id="L980">                        int val = Integer.parseInt(new String(new char[] { u1, u2, u3, u4 }), 16);</span>
<span class="fc" id="L981">                        putChar((char) val);</span>
<span class="fc" id="L982">                        break;</span>
                    default:
<span class="fc" id="L984">                        this.ch = ch;</span>
<span class="fc" id="L985">                        throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
                }
                continue;
            }

<span class="fc bfc" id="L990" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L991">                sp++;</span>
<span class="fc" id="L992">                continue;</span>
            }

<span class="fc bfc" id="L995" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L996">                putChar(ch);</span>
            } else {
<span class="fc" id="L998">                sbuf[sp++] = ch;</span>
            }
        }

<span class="fc" id="L1002">        token = JSONToken.LITERAL_STRING;</span>
<span class="fc" id="L1003">        this.ch = next();</span>
<span class="fc" id="L1004">    }</span>

    public Calendar getCalendar() {
<span class="fc" id="L1007">        return this.calendar;</span>
    }

    public TimeZone getTimeZone() {
<span class="fc" id="L1011">        return timeZone;</span>
    }

    public void setTimeZone(TimeZone timeZone) {
<span class="fc" id="L1015">        this.timeZone = timeZone;</span>
<span class="fc" id="L1016">    }</span>

    public Locale getLocale() {
<span class="fc" id="L1019">        return locale;</span>
    }

    public void setLocale(Locale locale) {
<span class="fc" id="L1023">        this.locale = locale;</span>
<span class="fc" id="L1024">    }</span>

    public final int intValue() {
<span class="pc bpc" id="L1027" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L1028">            np = 0;</span>
        }

<span class="fc" id="L1031">        int result = 0;</span>
<span class="fc" id="L1032">        boolean negative = false;</span>
<span class="fc" id="L1033">        int i = np, max = np + sp;</span>
        int limit;
        int digit;

<span class="fc bfc" id="L1037" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L1038">            negative = true;</span>
<span class="fc" id="L1039">            limit = Integer.MIN_VALUE;</span>
<span class="fc" id="L1040">            i++;</span>
        } else {
<span class="fc" id="L1042">            limit = -Integer.MAX_VALUE;</span>
        }
<span class="fc" id="L1044">        long multmin = INT_MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L1045" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L1046">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L1047">            result = -digit;</span>
        }
<span class="fc bfc" id="L1049" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L1051">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L1053" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L1054">                break;</span>
            }

<span class="fc" id="L1057">            digit = chLocal - '0';</span>

<span class="fc bfc" id="L1059" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L1060">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1062">            result *= 10;</span>
<span class="fc bfc" id="L1063" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L1064">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1066">            result -= digit;</span>
<span class="fc" id="L1067">        }</span>

<span class="fc bfc" id="L1069" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L1070" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L1071">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L1073">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L1076">            return -result;</span>
        }
    }

    public abstract byte[] bytesValue();

    public void close() {
<span class="fc bfc" id="L1083" title="All 2 branches covered.">        if (sbuf.length &lt;= 1024 * 8) {</span>
<span class="fc" id="L1084">            SBUF_LOCAL.set(sbuf);</span>
        }
<span class="fc" id="L1086">        this.sbuf = null;</span>
<span class="fc" id="L1087">    }</span>

    public final boolean isRef() {
<span class="fc bfc" id="L1090" title="All 2 branches covered.">        if (sp != 4) {</span>
<span class="fc" id="L1091">            return false;</span>
        }

<span class="fc bfc" id="L1094" title="All 2 branches covered.">        return charAt(np + 1) == '$' //</span>
<span class="fc bfc" id="L1095" title="All 2 branches covered.">                &amp;&amp; charAt(np + 2) == 'r' //</span>
<span class="fc bfc" id="L1096" title="All 2 branches covered.">                &amp;&amp; charAt(np + 3) == 'e' //</span>
<span class="fc bfc" id="L1097" title="All 2 branches covered.">                &amp;&amp; charAt(np + 4) == 'f';</span>
    }

<span class="fc" id="L1100">    protected final static char[] typeFieldName = (&quot;\&quot;&quot; + JSON.DEFAULT_TYPE_KEY + &quot;\&quot;:\&quot;&quot;).toCharArray();</span>

    public final int scanType(String type) {
<span class="fc" id="L1103">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1105" title="All 2 branches covered.">        if (!charArrayCompare(typeFieldName)) {</span>
<span class="fc" id="L1106">            return NOT_MATCH_NAME;</span>
        }

<span class="fc" id="L1109">        int bpLocal = this.bp + typeFieldName.length;</span>

<span class="fc" id="L1111">        final int typeLength = type.length();</span>
<span class="fc bfc" id="L1112" title="All 2 branches covered.">        for (int i = 0; i &lt; typeLength; ++i) {</span>
<span class="fc bfc" id="L1113" title="All 2 branches covered.">            if (type.charAt(i) != charAt(bpLocal + i)) {</span>
<span class="fc" id="L1114">                return NOT_MATCH;</span>
            }
        }
<span class="fc" id="L1117">        bpLocal += typeLength;</span>
<span class="fc bfc" id="L1118" title="All 2 branches covered.">        if (charAt(bpLocal) != '&quot;') {</span>
<span class="fc" id="L1119">            return NOT_MATCH;</span>
        }

<span class="fc" id="L1122">        this.ch = charAt(++bpLocal);</span>

<span class="fc bfc" id="L1124" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L1125">            this.ch = charAt(++bpLocal);</span>
<span class="fc" id="L1126">            this.bp = bpLocal;</span>
<span class="fc" id="L1127">            token = JSONToken.COMMA;</span>
<span class="fc" id="L1128">            return VALUE;</span>
<span class="pc bpc" id="L1129" title="1 of 2 branches missed.">        } else if (ch == '}') {</span>
<span class="fc" id="L1130">            ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1131" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L1132">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1133">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1134" title="All 2 branches covered.">            } else if (ch == ']') {</span>
<span class="fc" id="L1135">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1136">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1137" title="All 2 branches covered.">            } else if (ch == '}') {</span>
<span class="fc" id="L1138">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1139">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1140" title="All 2 branches covered.">            } else if (ch == EOI) {</span>
<span class="fc" id="L1141">                token = JSONToken.EOF;</span>
            } else {
<span class="fc" id="L1143">                return NOT_MATCH;</span>
            }
<span class="fc" id="L1145">            matchStat = END;</span>
        }

<span class="fc" id="L1148">        this.bp = bpLocal;</span>
<span class="fc" id="L1149">        return matchStat;</span>
    }

    public final boolean matchField(char[] fieldName) {
        for (;;) {
<span class="fc bfc" id="L1154" title="All 2 branches covered.">            if (!charArrayCompare(fieldName)) {</span>
<span class="fc bfc" id="L1155" title="All 2 branches covered.">                if (isWhitespace(ch)) {</span>
<span class="fc" id="L1156">                    next();</span>
<span class="fc" id="L1157">                    continue;</span>
                }
<span class="fc" id="L1159">                return false;</span>
            } else {
                break;
            }
        }

<span class="fc" id="L1165">        bp = bp + fieldName.length;</span>
<span class="fc" id="L1166">        ch = charAt(bp);</span>

<span class="fc bfc" id="L1168" title="All 2 branches covered.">        if (ch == '{') {</span>
<span class="fc" id="L1169">            next();</span>
<span class="fc" id="L1170">            token = JSONToken.LBRACE;</span>
<span class="fc bfc" id="L1171" title="All 2 branches covered.">        } else if (ch == '[') {</span>
<span class="fc" id="L1172">            next();</span>
<span class="fc" id="L1173">            token = JSONToken.LBRACKET;</span>
<span class="pc bpc" id="L1174" title="3 of 8 branches missed.">        } else if (ch == 'S' &amp;&amp; charAt(bp + 1) == 'e' &amp;&amp; charAt(bp + 2) == 't' &amp;&amp; charAt(bp + 3) == '[') {</span>
<span class="fc" id="L1175">            bp += 3;</span>
<span class="fc" id="L1176">            ch = charAt(bp);</span>
<span class="fc" id="L1177">            token = JSONToken.SET;</span>
        } else {
<span class="fc" id="L1179">            nextToken();</span>
        }

<span class="fc" id="L1182">        return true;</span>
    }

    public int matchField(long fieldNameHash) {
<span class="nc" id="L1186">        throw new UnsupportedOperationException();</span>
    }

    public boolean seekArrayToItem(int index) {
<span class="nc" id="L1190">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long fieldNameHash, boolean deepScan) {
<span class="nc" id="L1194">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long[] fieldNameHash) {
<span class="nc" id="L1198">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToFieldDeepScan(long fieldNameHash) {
<span class="nc" id="L1202">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject() {
<span class="nc" id="L1206">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject(boolean valid) {
<span class="nc" id="L1210">        throw new UnsupportedOperationException();</span>
    }

    public void skipArray() {
<span class="nc" id="L1214">        throw new UnsupportedOperationException();</span>
    }

    public abstract int indexOf(char ch, int startIndex);

    public abstract String addSymbol(int offset, int len, int hash, final SymbolTable symbolTable);

    public String scanFieldString(char[] fieldName) {
<span class="fc" id="L1222">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1224" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1225">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1226">            return stringDefaultValue();</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1231">        int offset = fieldName.length;</span>
<span class="fc" id="L1232">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1234" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1235">            matchStat = NOT_MATCH;</span>

<span class="fc" id="L1237">            return stringDefaultValue();</span>
        }

        final String strVal;
        {
<span class="fc" id="L1242">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L1243">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1244" title="All 2 branches covered.">            if (endIndex == -1) {</span>
<span class="fc" id="L1245">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L1248">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L1249">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1250" title="All 2 branches covered.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="fc" id="L1252">                    int slashCount = 0;</span>
<span class="pc bpc" id="L1253" title="1 of 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1254" title="All 2 branches covered.">                        if (charAt(i) == '\\') {</span>
<span class="fc" id="L1255">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="fc bfc" id="L1260" title="All 2 branches covered.">                    if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1261">                        break;</span>
                    }
<span class="fc" id="L1263">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1264">                }</span>

<span class="fc" id="L1266">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="fc" id="L1267">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="fc" id="L1269">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L1272">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L1273">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1274">            strVal = stringVal;</span>
        }

<span class="fc bfc" id="L1277" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1278">            bp += offset;</span>
<span class="fc" id="L1279">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1280">            matchStat = VALUE;</span>
<span class="fc" id="L1281">            return strVal;</span>
        }

<span class="pc bpc" id="L1284" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L1285">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1286" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1287">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1288">                bp += offset;</span>
<span class="fc" id="L1289">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1290" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1291">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1292">                bp += offset;</span>
<span class="fc" id="L1293">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1294" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1295">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1296">                bp += offset;</span>
<span class="fc" id="L1297">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1298" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1299">                token = JSONToken.EOF;</span>
<span class="fc" id="L1300">                bp += (offset - 1);</span>
<span class="fc" id="L1301">                ch = EOI;</span>
            } else {
<span class="fc" id="L1303">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1304">                return stringDefaultValue();</span>
            }
<span class="fc" id="L1306">            matchStat = END;</span>
        } else {
<span class="nc" id="L1308">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1309">            return stringDefaultValue();</span>
        }

<span class="fc" id="L1312">        return strVal;</span>
    }

    public String scanString(char expectNextChar) {
<span class="fc" id="L1316">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1318">        int offset = 0;</span>
<span class="fc" id="L1319">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1321" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1322" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1323">                offset += 3;</span>
<span class="fc" id="L1324">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1326">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1327">                return null;</span>
            }

<span class="fc bfc" id="L1330" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1331">                bp += offset;</span>
<span class="fc" id="L1332">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1333">                matchStat = VALUE;</span>
<span class="fc" id="L1334">                return null;</span>
            } else {
<span class="fc" id="L1336">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1337">                return null;</span>
            }
        }



        final String strVal;
        for (;;) {
<span class="fc bfc" id="L1345" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1346">                int startIndex = bp + offset;</span>
<span class="fc" id="L1347">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1348" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1349">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1352">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1353" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (; ; ) {
<span class="fc" id="L1355">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1356" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1357" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1358">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1363" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1364">                            break;</span>
                        }
<span class="fc" id="L1366">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1367">                    }</span>

<span class="fc" id="L1369">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1370">                    char[] chars = sub_chars(bp + 1, chars_len);</span>

<span class="fc" id="L1372">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1375">                offset += (endIndex - startIndex + 1);</span>
<span class="fc" id="L1376">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1377">                strVal = stringVal;</span>
<span class="fc" id="L1378">                break;</span>
<span class="fc bfc" id="L1379" title="All 2 branches covered.">            } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1380">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1381">                continue;</span>
            } else {
<span class="fc" id="L1383">                matchStat = NOT_MATCH;</span>

<span class="fc" id="L1385">                return stringDefaultValue();</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1390" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1391">                bp += offset;</span>
<span class="fc" id="L1392">                this.ch = charAt(bp);</span>
<span class="fc" id="L1393">                matchStat = VALUE;</span>
<span class="fc" id="L1394">                return strVal;</span>
<span class="pc bpc" id="L1395" title="1 of 2 branches missed.">            } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L1396">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1397">                continue;</span>
            } else {
<span class="fc" id="L1399">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1400">                return strVal;</span>
            }
        }
    }

    public long scanFieldSymbol(char[] fieldName) {
<span class="nc" id="L1406">        matchStat = UNKNOWN;</span>

<span class="nc bnc" id="L1408" title="All 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1409">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1410">            return 0;</span>
        }

<span class="nc" id="L1413">        int offset = fieldName.length;</span>
<span class="nc" id="L1414">        char chLocal = charAt(bp + (offset++));</span>

<span class="nc bnc" id="L1416" title="All 2 branches missed.">        if (chLocal != '&quot;') {</span>
<span class="nc" id="L1417">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1418">            return 0;</span>
        }

<span class="nc" id="L1421">        long hash = 0xcbf29ce484222325L;</span>
        for (;;) {
<span class="nc" id="L1423">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1424" title="All 2 branches missed.">            if (chLocal == '\&quot;') {</span>
<span class="nc" id="L1425">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1426">                break;</span>
            }

<span class="nc" id="L1429">            hash ^= chLocal;</span>
<span class="nc" id="L1430">            hash *= 0x100000001b3L;</span>

<span class="nc bnc" id="L1432" title="All 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1433">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1434">                return 0;</span>
            }
        }

<span class="nc bnc" id="L1438" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L1439">            bp += offset;</span>
<span class="nc" id="L1440">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L1441">            matchStat = VALUE;</span>
<span class="nc" id="L1442">            return hash;</span>
        }

<span class="nc bnc" id="L1445" title="All 2 branches missed.">        if (chLocal == '}') {</span>
<span class="nc" id="L1446">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1447" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L1448">                token = JSONToken.COMMA;</span>
<span class="nc" id="L1449">                bp += offset;</span>
<span class="nc" id="L1450">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1451" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L1452">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L1453">                bp += offset;</span>
<span class="nc" id="L1454">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1455" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L1456">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L1457">                bp += offset;</span>
<span class="nc" id="L1458">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1459" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L1460">                token = JSONToken.EOF;</span>
<span class="nc" id="L1461">                bp += (offset - 1);</span>
<span class="nc" id="L1462">                ch = EOI;</span>
            } else {
<span class="nc" id="L1464">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1465">                return 0;</span>
            }
<span class="nc" id="L1467">            matchStat = END;</span>
        } else {
<span class="nc" id="L1469">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1470">            return 0;</span>
        }

<span class="nc" id="L1473">        return hash;</span>
    }

    public long scanEnumSymbol(char[] fieldName) {
<span class="fc" id="L1477">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1479" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1480">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1481">            return 0;</span>
        }

<span class="fc" id="L1484">        int offset = fieldName.length;</span>
<span class="fc" id="L1485">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1487" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1488">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1489">            return 0;</span>
        }

<span class="fc" id="L1492">        long hash = 0xcbf29ce484222325L;</span>
        for (;;) {
<span class="fc" id="L1494">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1495" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
<span class="fc" id="L1496">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1497">                break;</span>
            }

<span class="fc bfc" id="L1500" title="All 4 branches covered.">            hash ^= ((chLocal &gt;= 'A' &amp;&amp; chLocal &lt;= 'Z') ? (chLocal + 32) : chLocal);</span>
<span class="fc" id="L1501">            hash *= 0x100000001b3L;</span>

<span class="fc bfc" id="L1503" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc" id="L1504">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1505">                return 0;</span>
            }
        }

<span class="fc bfc" id="L1509" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1510">            bp += offset;</span>
<span class="fc" id="L1511">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1512">            matchStat = VALUE;</span>
<span class="fc" id="L1513">            return hash;</span>
        }

<span class="fc bfc" id="L1516" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1517">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1518" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1519">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1520">                bp += offset;</span>
<span class="fc" id="L1521">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1522" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1523">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1524">                bp += offset;</span>
<span class="fc" id="L1525">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1526" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1527">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1528">                bp += offset;</span>
<span class="fc" id="L1529">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1530" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1531">                token = JSONToken.EOF;</span>
<span class="fc" id="L1532">                bp += (offset - 1);</span>
<span class="fc" id="L1533">                ch = EOI;</span>
            } else {
<span class="fc" id="L1535">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1536">                return 0;</span>
            }
<span class="fc" id="L1538">            matchStat = END;</span>
        } else {
<span class="fc" id="L1540">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1541">            return 0;</span>
        }

<span class="fc" id="L1544">        return hash;</span>
    }

    @SuppressWarnings({ &quot;unchecked&quot;, &quot;rawtypes&quot; })
    public Enum&lt;?&gt; scanEnum(Class&lt;?&gt; enumClass, final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1549">        String name = scanSymbolWithSeperator(symbolTable, serperator);</span>
<span class="fc bfc" id="L1550" title="All 2 branches covered.">        if (name == null) {</span>
<span class="fc" id="L1551">            return null;</span>
        }
<span class="fc" id="L1553">        return Enum.valueOf((Class&lt;? extends Enum&gt;) enumClass, name);</span>
    }

    public String scanSymbolWithSeperator(final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1557">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1559">        int offset = 0;</span>
<span class="fc" id="L1560">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1562" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1563" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1564">                offset += 3;</span>
<span class="fc" id="L1565">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1567">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1568">                return null;</span>
            }

<span class="fc bfc" id="L1571" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1572">                bp += offset;</span>
<span class="fc" id="L1573">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1574">                matchStat = VALUE;</span>
<span class="fc" id="L1575">                return null;</span>
            } else {
<span class="fc" id="L1577">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1578">                return null;</span>
            }
        }

<span class="fc bfc" id="L1582" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1583">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1584">            return null;</span>
        }

        String strVal;
        // int start = index;
<span class="fc" id="L1589">        int hash = 0;</span>
        for (;;) {
<span class="fc" id="L1591">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1592" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
                // bp = index;
                // this.ch = chLocal = charAt(bp);
<span class="fc" id="L1595">                int start = bp + 0 + 1;</span>
<span class="fc" id="L1596">                int len = bp + offset - start - 1;</span>
<span class="fc" id="L1597">                strVal = addSymbol(start, len, hash, symbolTable);</span>
<span class="fc" id="L1598">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1599">                break;</span>
            }

<span class="fc" id="L1602">            hash = 31 * hash + chLocal;</span>

<span class="pc bpc" id="L1604" title="1 of 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1605">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1606">                return null;</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1611" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1612">                bp += offset;</span>
<span class="fc" id="L1613">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1614">                matchStat = VALUE;</span>
<span class="fc" id="L1615">                return strVal;</span>
            } else {
<span class="pc bpc" id="L1617" title="1 of 2 branches missed.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1618">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1619">                    continue;</span>
                }

<span class="nc" id="L1622">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1623">                return strVal;</span>
            }
        }
    }

    public Collection&lt;String&gt; newCollectionByType(Class&lt;?&gt; type){
<span class="fc bfc" id="L1629" title="All 2 branches covered.">        if (type.isAssignableFrom(HashSet.class)) {</span>
<span class="fc" id="L1630">            HashSet&lt;String&gt; list = new HashSet&lt;String&gt;();</span>
<span class="fc" id="L1631">            return list;</span>
<span class="fc bfc" id="L1632" title="All 2 branches covered.">        } else if (type.isAssignableFrom(ArrayList.class)) {</span>
<span class="fc" id="L1633">            ArrayList&lt;String&gt; list2 = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L1634">            return list2;</span>
        } else {
            try {
<span class="fc" id="L1637">                Collection&lt;String&gt; list = (Collection&lt;String&gt;) type.newInstance();</span>
<span class="fc" id="L1638">                return list;</span>
<span class="fc" id="L1639">            } catch (Exception e) {</span>
<span class="fc" id="L1640">                throw new JSONException(e.getMessage(), e);</span>
            }
        }
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    public Collection&lt;String&gt; scanFieldStringArray(char[] fieldName, Class&lt;?&gt; type) {
<span class="fc" id="L1647">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1649" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1650">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1651">            return null;</span>
        }

<span class="fc" id="L1654">        Collection&lt;String&gt; list = newCollectionByType(type);</span>

//        if (type.isAssignableFrom(HashSet.class)) {
//            list = new HashSet&lt;String&gt;();
//        } else if (type.isAssignableFrom(ArrayList.class)) {
//            list = new ArrayList&lt;String&gt;();
//        } else {
//            try {
//                list = (Collection&lt;String&gt;) type.newInstance();
//            } catch (Exception e) {
//                throw new JSONException(e.getMessage(), e);
//            }
//        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1670">        int offset = fieldName.length;</span>
<span class="fc" id="L1671">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1673" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1674">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1675">            return null;</span>
        }

<span class="fc" id="L1678">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
            // int start = index;
<span class="fc bfc" id="L1682" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1683">                int startIndex = bp + offset;</span>
<span class="fc" id="L1684">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1685" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1686">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1689">                int startIndex2 = bp + offset; // must re compute</span>
<span class="fc" id="L1690">                String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1691" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="fc" id="L1693">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1694" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1695" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1696">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1701" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1702">                            break;</span>
                        }
<span class="fc" id="L1704">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1705">                    }</span>

<span class="fc" id="L1707">                    int chars_len = endIndex - (bp + offset);</span>
<span class="fc" id="L1708">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1710">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1713">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1714">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1716">                list.add(stringVal);</span>
<span class="fc bfc" id="L1717" title="All 2 branches covered.">            } else if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1718" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1719" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1720" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1721">                offset += 3;</span>
<span class="fc" id="L1722">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1723">                list.add(null);</span>
<span class="fc bfc" id="L1724" title="All 4 branches covered.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1725">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1726">                break;</span>
            } else {
<span class="fc" id="L1728">                throw new JSONException(&quot;illega str&quot;);</span>
            }

<span class="fc bfc" id="L1731" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1732">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1733">                continue;</span>
            }

<span class="fc bfc" id="L1736" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1737">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1738">                break;</span>
            }

<span class="fc" id="L1741">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1742">            return null;</span>
        }

<span class="fc bfc" id="L1745" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1746">            bp += offset;</span>
<span class="fc" id="L1747">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1748">            matchStat = VALUE;</span>
<span class="fc" id="L1749">            return list;</span>
        }

<span class="fc bfc" id="L1752" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1753">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1754" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1755">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1756">                bp += offset;</span>
<span class="fc" id="L1757">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1758" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1759">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1760">                bp += offset;</span>
<span class="fc" id="L1761">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1762" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1763">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1764">                bp += offset;</span>
<span class="fc" id="L1765">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1766" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1767">                bp += (offset - 1);</span>
<span class="fc" id="L1768">                token = JSONToken.EOF;</span>
<span class="fc" id="L1769">                this.ch = EOI;</span>
            } else {
<span class="fc" id="L1771">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1772">                return null;</span>
            }
<span class="fc" id="L1774">            matchStat = END;</span>
        } else {
<span class="fc" id="L1776">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1777">            return null;</span>
        }

<span class="fc" id="L1780">        return list;</span>
    }

    public void scanStringArray(Collection&lt;String&gt; list, char seperator) {
<span class="fc" id="L1784">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1786">        int offset = 0;</span>
<span class="fc" id="L1787">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1789" title="All 2 branches covered.">        if (chLocal == 'n'</span>
<span class="fc bfc" id="L1790" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset) == 'u'</span>
<span class="fc bfc" id="L1791" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 1) == 'l'</span>
<span class="fc bfc" id="L1792" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 2) == 'l'</span>
<span class="fc bfc" id="L1793" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 3) == seperator</span>
        ) {
<span class="fc" id="L1795">            bp += 5;</span>
<span class="fc" id="L1796">            ch = charAt(bp);</span>
<span class="fc" id="L1797">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L1798">            return;</span>
        }

<span class="fc bfc" id="L1801" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1802">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1803">            return;</span>
        }

<span class="fc" id="L1806">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
<span class="fc bfc" id="L1809" title="All 2 branches covered.">            if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1810" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1811" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1812" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1813">                offset += 3;</span>
<span class="fc" id="L1814">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1815">                list.add(null);</span>
<span class="pc bpc" id="L1816" title="1 of 4 branches missed.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1817">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1818">                break;</span>
<span class="fc bfc" id="L1819" title="All 2 branches covered.">            } else if (chLocal != '&quot;') {</span>
<span class="fc" id="L1820">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1821">                return;</span>
            } else {
<span class="fc" id="L1823">                int startIndex = bp + offset;</span>
<span class="fc" id="L1824">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1825" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1826">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1829">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1830" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="fc" id="L1832">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1833" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1834" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1835">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1840" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1841">                            break;</span>
                        }
<span class="fc" id="L1843">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1844">                    }</span>

<span class="fc" id="L1846">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1847">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1849">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1852">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1853">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1854">                list.add(stringVal);</span>
            }

<span class="fc bfc" id="L1857" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1858">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1859">                continue;</span>
            }

<span class="fc bfc" id="L1862" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1863">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1864">                break;</span>
            }

<span class="fc" id="L1867">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1868">            return;</span>
        }

<span class="fc bfc" id="L1871" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L1872">            bp += offset;</span>
<span class="fc" id="L1873">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1874">            matchStat = VALUE;</span>
<span class="fc" id="L1875">            return;</span>
        } else {
<span class="fc" id="L1877">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1878">            return;</span>
        }
    }

    public int scanFieldInt(char[] fieldName) {
<span class="fc" id="L1883">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1885" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1886">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1887">            return 0;</span>
        }

<span class="fc" id="L1890">        int offset = fieldName.length;</span>
<span class="fc" id="L1891">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1893" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L1894" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L1895">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="pc bpc" id="L1899" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1900">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L1902">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1903" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1904">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L1905" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L1906">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1907">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L1912" title="All 4 branches covered.">            if (value &lt; 0 //</span>
                    || offset &gt; 11 + 3 + fieldName.length) {
<span class="pc bpc" id="L1914" title="1 of 6 branches missed.">                if (value != Integer.MIN_VALUE //</span>
                        || offset != 17 //
                        || !negative) {
<span class="fc" id="L1917">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1918">                    return 0;</span>
                }
            }
        } else {
<span class="fc" id="L1922">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1923">            return 0;</span>
        }

<span class="fc bfc" id="L1926" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1927">            bp += offset;</span>
<span class="fc" id="L1928">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1929">            matchStat = VALUE;</span>
<span class="fc" id="L1930">            token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L1931" title="All 2 branches covered.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L1934" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1935">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1936" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1937">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1938">                bp += offset;</span>
<span class="fc" id="L1939">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1940" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1941">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1942">                bp += offset;</span>
<span class="fc" id="L1943">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1944" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1945">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1946">                bp += offset;</span>
<span class="fc" id="L1947">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1948" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1949">                token = JSONToken.EOF;</span>
<span class="fc" id="L1950">                bp += (offset - 1);</span>
<span class="fc" id="L1951">                ch = EOI;</span>
            } else {
<span class="fc" id="L1953">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1954">                return 0;</span>
            }
<span class="fc" id="L1956">            matchStat = END;</span>
        } else {
<span class="fc" id="L1958">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1959">            return 0;</span>
        }

<span class="fc bfc" id="L1962" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public final int[] scanFieldIntArray(char[] fieldName) {
<span class="fc" id="L1966">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L1968" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1969">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1970">            return null;</span>
        }

<span class="fc" id="L1973">        int offset = fieldName.length;</span>
<span class="fc" id="L1974">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1976" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1977">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1978">            return null;</span>
        }
<span class="fc" id="L1980">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1982">        int[] array = new int[16];</span>
<span class="fc" id="L1983">        int arrayIndex = 0;</span>

<span class="pc bpc" id="L1985" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L1986">            chLocal = charAt(bp + (offset++));</span>
        } else {
            for (;;) {
<span class="fc" id="L1989">                boolean nagative = false;</span>
<span class="pc bpc" id="L1990" title="1 of 2 branches missed.">                if (chLocal == '-') {</span>
<span class="nc" id="L1991">                    chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1992">                    nagative = true;</span>
                }
<span class="pc bpc" id="L1994" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1995">                    int value = chLocal - '0';</span>
                    for (; ; ) {
<span class="fc" id="L1997">                        chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1999" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2000">                            value = value * 10 + (chLocal - '0');</span>
                        } else {
                            break;
                        }
                    }

<span class="pc bpc" id="L2006" title="1 of 2 branches missed.">                    if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L2007">                        int[] tmp = new int[array.length * 3 / 2];</span>
<span class="nc" id="L2008">                        System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L2009">                        array = tmp;</span>
                    }
<span class="pc bpc" id="L2011" title="1 of 2 branches missed.">                    array[arrayIndex++] = nagative ? -value : value;</span>

<span class="fc bfc" id="L2013" title="All 2 branches covered.">                    if (chLocal == ',') {</span>
<span class="fc" id="L2014">                        chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2015" title="1 of 2 branches missed.">                    } else if (chLocal == ']') {</span>
<span class="fc" id="L2016">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2017">                        break;</span>
                    }
<span class="fc" id="L2019">                } else {</span>
<span class="fc" id="L2020">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2021">                    return null;</span>
                }
<span class="fc" id="L2023">            }</span>
        }


<span class="pc bpc" id="L2027" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L2028">            int[] tmp = new int[arrayIndex];</span>
<span class="fc" id="L2029">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L2030">            array = tmp;</span>
        }

<span class="pc bpc" id="L2033" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L2034">            bp += (offset - 1);</span>
<span class="nc" id="L2035">            this.next();</span>
<span class="nc" id="L2036">            matchStat = VALUE;</span>
<span class="nc" id="L2037">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2038">            return array;</span>
        }

<span class="pc bpc" id="L2041" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2042">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2043" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2044">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2045">                bp += (offset - 1);</span>
<span class="fc" id="L2046">                this.next();</span>
<span class="fc bfc" id="L2047" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2048">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2049">                bp += (offset - 1);</span>
<span class="fc" id="L2050">                this.next();</span>
<span class="pc bpc" id="L2051" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L2052">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L2053">                bp += (offset - 1);</span>
<span class="nc" id="L2054">                this.next();</span>
<span class="pc bpc" id="L2055" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2056">                bp += (offset - 1);</span>
<span class="fc" id="L2057">                token = JSONToken.EOF;</span>
<span class="fc" id="L2058">                ch = EOI;</span>
            } else {
<span class="nc" id="L2060">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2061">                return null;</span>
            }
<span class="fc" id="L2063">            matchStat = END;</span>
        } else {
<span class="nc" id="L2065">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2066">            return null;</span>
        }

<span class="fc" id="L2069">        return array;</span>
    }

    public boolean scanBoolean(char expectNext) {
<span class="fc" id="L2073">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2075">        int offset = 0;</span>
<span class="fc" id="L2076">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2078">        boolean value = false;</span>
<span class="fc bfc" id="L2079" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2080" title="All 2 branches covered.">            if (charAt(bp + offset) == 'r' //</span>
<span class="fc bfc" id="L2081" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'u' //</span>
<span class="fc bfc" id="L2082" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'e') {</span>
<span class="fc" id="L2083">                offset += 3;</span>
<span class="fc" id="L2084">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2085">                value = true;</span>
            } else {
<span class="fc" id="L2087">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2088">                return false;</span>
            }
<span class="fc bfc" id="L2090" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2091" title="All 2 branches covered.">            if (charAt(bp + offset) == 'a' //</span>
<span class="fc bfc" id="L2092" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L2093" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 's' //</span>
<span class="fc bfc" id="L2094" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 3) == 'e') {</span>
<span class="fc" id="L2095">                offset += 4;</span>
<span class="fc" id="L2096">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2097">                value = false;</span>
            } else {
<span class="fc" id="L2099">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2100">                return false;</span>
            }
<span class="fc bfc" id="L2102" title="All 2 branches covered.">        } else if (chLocal == '1') {</span>
<span class="fc" id="L2103">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2104">            value = true;</span>
<span class="pc bpc" id="L2105" title="1 of 2 branches missed.">        } else if (chLocal == '0') {</span>
<span class="fc" id="L2106">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2107">            value = false;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2111" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2112">                bp += offset;</span>
<span class="fc" id="L2113">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2114">                matchStat = VALUE;</span>
<span class="fc" id="L2115">                return value;</span>
            } else {
<span class="fc bfc" id="L2117" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2118">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2119">                    continue;</span>
                }
<span class="fc" id="L2121">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2122">                return value;</span>
            }
        }
    }

    public int scanInt(char expectNext) {
<span class="fc" id="L2128">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2130">        int offset = 0;</span>
<span class="fc" id="L2131">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2133" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2134" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2135">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2138" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2139" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2140">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="fc bfc" id="L2144" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2145">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2147">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2148" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2149">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2150" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2151">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2152">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L2157" title="All 2 branches covered.">            if (value &lt; 0) {</span>
<span class="fc" id="L2158">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2159">                return 0;</span>
            }
<span class="pc bpc" id="L2161" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2162">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2163">            value = 0;</span>
<span class="fc" id="L2164">            offset += 3;</span>
<span class="fc" id="L2165">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2167" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2168">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2172" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2173">                    bp += offset;</span>
<span class="fc" id="L2174">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2175">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2176">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2177">                    return value;</span>
<span class="fc bfc" id="L2178" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2179">                    bp += offset;</span>
<span class="fc" id="L2180">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2181">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2182">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2183">                    return value;</span>
<span class="pc bpc" id="L2184" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2185">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2186">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2190">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2191">            return 0;</span>
        } else {
<span class="fc" id="L2193">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2194">            return 0;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2198" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2199">                bp += offset;</span>
<span class="fc" id="L2200">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2201">                matchStat = VALUE;</span>
<span class="fc" id="L2202">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2203" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2205" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2206">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2207">                    continue;</span>
                }
<span class="fc" id="L2209">                matchStat = NOT_MATCH;</span>
<span class="fc bfc" id="L2210" title="All 2 branches covered.">                return negative ? -value : value;</span>
            }
        }
    }

    public boolean scanFieldBoolean(char[] fieldName) {
<span class="fc" id="L2216">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2218" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2219">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2220">            return false;</span>
        }

<span class="fc" id="L2223">        int offset = fieldName.length;</span>
<span class="fc" id="L2224">        char chLocal = charAt(bp + (offset++));</span>

        boolean value;
<span class="fc bfc" id="L2227" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2228" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'r') {</span>
<span class="fc" id="L2229">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2230">                return false;</span>
            }
<span class="fc bfc" id="L2232" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'u') {</span>
<span class="fc" id="L2233">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2234">                return false;</span>
            }
<span class="fc bfc" id="L2236" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2237">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2238">                return false;</span>
            }

<span class="fc" id="L2241">            value = true;</span>
<span class="fc bfc" id="L2242" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2243" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'a') {</span>
<span class="fc" id="L2244">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2245">                return false;</span>
            }
<span class="fc bfc" id="L2247" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'l') {</span>
<span class="fc" id="L2248">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2249">                return false;</span>
            }
<span class="fc bfc" id="L2251" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 's') {</span>
<span class="fc" id="L2252">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2253">                return false;</span>
            }
<span class="fc bfc" id="L2255" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2256">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2257">                return false;</span>
            }

<span class="fc" id="L2260">            value = false;</span>
        } else {
<span class="fc" id="L2262">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2263">            return false;</span>
        }

<span class="fc" id="L2266">        chLocal = charAt(bp + offset++);</span>
<span class="fc bfc" id="L2267" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2268">            bp += offset;</span>
<span class="fc" id="L2269">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2270">            matchStat = VALUE;</span>
<span class="fc" id="L2271">            token = JSONToken.COMMA;</span>

<span class="fc" id="L2273">            return value;</span>
        }

<span class="pc bpc" id="L2276" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2277">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2278" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2279">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2280">                bp += offset;</span>
<span class="fc" id="L2281">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2282" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2283">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2284">                bp += offset;</span>
<span class="fc" id="L2285">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2286" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2287">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2288">                bp += offset;</span>
<span class="fc" id="L2289">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2290" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2291">                token = JSONToken.EOF;</span>
<span class="fc" id="L2292">                bp += (offset - 1);</span>
<span class="fc" id="L2293">                ch = EOI;</span>
            } else {
<span class="fc" id="L2295">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2296">                return false;</span>
            }
<span class="fc" id="L2298">            matchStat = END;</span>
        } else {
<span class="nc" id="L2300">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2301">            return false;</span>
        }

<span class="fc" id="L2304">        return value;</span>
    }

    public long scanFieldLong(char[] fieldName) {
<span class="fc" id="L2308">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2310" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2311">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2312">            return 0;</span>
        }

<span class="fc" id="L2315">        int offset = fieldName.length;</span>
<span class="fc" id="L2316">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2318">        boolean negative = false;</span>
<span class="fc bfc" id="L2319" title="All 2 branches covered.">        if (chLocal == '-') {</span>
<span class="fc" id="L2320">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2321">            negative = true;</span>
        }

        long value;
<span class="fc bfc" id="L2325" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2326">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2328">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2329" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2330">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2331" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2332">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2333">                    return 0;</span>
                } else {
                    break;
                }
            }

<span class="pc bpc" id="L2339" title="2 of 8 branches missed.">            boolean valid = offset - fieldName.length &lt; 21</span>
                    &amp;&amp; (value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative));
<span class="fc bfc" id="L2341" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2342">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2343">                return 0;</span>
            }
<span class="fc" id="L2345">        } else {</span>
<span class="fc" id="L2346">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2347">            return 0;</span>
        }

<span class="fc bfc" id="L2350" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2351">            bp += offset;</span>
<span class="fc" id="L2352">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2353">            matchStat = VALUE;</span>
<span class="fc" id="L2354">            token = JSONToken.COMMA;</span>
<span class="pc bpc" id="L2355" title="1 of 2 branches missed.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L2358" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2359">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2360" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2361">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2362">                bp += offset;</span>
<span class="fc" id="L2363">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2364" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2365">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2366">                bp += offset;</span>
<span class="fc" id="L2367">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2368" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2369">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2370">                bp += offset;</span>
<span class="fc" id="L2371">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2372" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2373">                token = JSONToken.EOF;</span>
<span class="fc" id="L2374">                bp += (offset - 1);</span>
<span class="fc" id="L2375">                ch = EOI;</span>
            } else {
<span class="fc" id="L2377">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2378">                return 0;</span>
            }
<span class="fc" id="L2380">            matchStat = END;</span>
        } else {
<span class="fc" id="L2382">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2383">            return 0;</span>
        }

<span class="fc bfc" id="L2386" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public long scanLong(char expectNextChar) {
<span class="fc" id="L2390">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2392">        int offset = 0;</span>
<span class="fc" id="L2393">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2394" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2395" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2396">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2399" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2400" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2401">            chLocal = charAt(bp + (offset++));</span>
        }

        long value;
<span class="fc bfc" id="L2405" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2406">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2408">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2409" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2410">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2411" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2412">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2413">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="pc bpc" id="L2418" title="1 of 6 branches missed.">            boolean valid = value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative);</span>
<span class="fc bfc" id="L2419" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2420">                String val = subString(bp, offset - 1);</span>
<span class="fc" id="L2421">                throw new NumberFormatException(val);</span>
            }
<span class="pc bpc" id="L2423" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2424">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2425">            value = 0;</span>
<span class="fc" id="L2426">            offset += 3;</span>
<span class="fc" id="L2427">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2429" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2430">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2434" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2435">                    bp += offset;</span>
<span class="fc" id="L2436">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2437">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2438">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2439">                    return value;</span>
<span class="fc bfc" id="L2440" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2441">                    bp += offset;</span>
<span class="fc" id="L2442">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2443">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2444">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2445">                    return value;</span>
<span class="pc bpc" id="L2446" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2447">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2448">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2452">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2453">            return 0;</span>
        } else {
<span class="fc" id="L2455">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2456">            return 0;</span>
        }

<span class="fc bfc" id="L2459" title="All 2 branches covered.">        if (quote) {</span>
<span class="pc bpc" id="L2460" title="1 of 2 branches missed.">            if (chLocal != '&quot;') {</span>
<span class="nc" id="L2461">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2462">                return 0;</span>
            } else {
<span class="fc" id="L2464">                chLocal = charAt(bp + (offset++));</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L2469" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L2470">                bp += offset;</span>
<span class="fc" id="L2471">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2472">                matchStat = VALUE;</span>
<span class="fc" id="L2473">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2474" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2476" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2477">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2478">                    continue;</span>
                }

<span class="fc" id="L2481">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2482">                return value;</span>
            }
        }
    }

    public final float scanFieldFloat(char[] fieldName) {
<span class="fc" id="L2488">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2490" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2491">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2492">            return 0;</span>
        }

<span class="fc" id="L2495">        int offset = fieldName.length;</span>
<span class="fc" id="L2496">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2498" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2499" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2500">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2503" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2504" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2505">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="fc bfc" id="L2509" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2510">            long intVal = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2512">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2513" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2514">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2515">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2521">            long power = 1;</span>
<span class="fc bfc" id="L2522" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2523" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2524">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2525" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2526">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2527">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L2529">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2530" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2531">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2532">                            power *= 10;</span>
<span class="fc" id="L2533">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2539">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2540">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2544" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2545" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2546">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2547" title="1 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2548">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="pc bpc" id="L2551" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2552">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L2560" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2561" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2562">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2563">                    return 0;</span>
                } else {
<span class="fc" id="L2565">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2567">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L2568">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2570">                start = bp + fieldName.length;</span>
<span class="fc" id="L2571">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2574" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2575">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2576" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2577">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L2580">                String text = this.subString(start, count);</span>
<span class="fc" id="L2581">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2583" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2584">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2585">            value = 0;</span>
<span class="fc" id="L2586">            offset += 3;</span>
<span class="fc" id="L2587">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2589" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2590">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2594" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2595">                    bp += offset;</span>
<span class="fc" id="L2596">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2597">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2598">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2599">                    return value;</span>
<span class="fc bfc" id="L2600" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L2601">                    bp += offset;</span>
<span class="fc" id="L2602">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2603">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2604">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L2605">                    return value;</span>
<span class="pc bpc" id="L2606" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2607">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2608">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2612">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2613">            return 0;</span>
        } else {
<span class="fc" id="L2615">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2616">            return 0;</span>
        }

<span class="fc bfc" id="L2619" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2620">            bp += offset;</span>
<span class="fc" id="L2621">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2622">            matchStat = VALUE;</span>
<span class="fc" id="L2623">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2624">            return value;</span>
        }

<span class="fc bfc" id="L2627" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2628">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2629" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2630">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2631">                bp += offset;</span>
<span class="fc" id="L2632">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2633" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2634">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2635">                bp += offset;</span>
<span class="fc" id="L2636">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2637" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2638">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2639">                bp += offset;</span>
<span class="fc" id="L2640">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2641" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2642">                bp += (offset - 1);</span>
<span class="fc" id="L2643">                token = JSONToken.EOF;</span>
<span class="fc" id="L2644">                ch = EOI;</span>
            } else {
<span class="fc" id="L2646">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2647">                return 0;</span>
            }
<span class="fc" id="L2649">            matchStat = END;</span>
        } else {
<span class="fc" id="L2651">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2652">            return 0;</span>
        }

<span class="fc" id="L2655">        return value;</span>
    }

    public final float scanFloat(char seperator) {
<span class="fc" id="L2659">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2661">        int offset = 0;</span>
<span class="fc" id="L2662">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2663" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2664" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2665">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2668" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2669" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2670">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="pc bpc" id="L2674" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2675">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="fc" id="L2677">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2678" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2679">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2680">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2686">            long power = 1;</span>
<span class="fc bfc" id="L2687" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2688" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2689">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2690" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2691">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2692">                    power = 10;</span>
                    for (; ; ) {
<span class="fc" id="L2694">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2695" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2696">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2697">                            power *= 10;</span>
<span class="fc" id="L2698">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2704">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2705">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2709" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2710" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2711">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2712" title="2 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2713">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="pc bpc" id="L2716" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2717">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }
//            int start, count;
//            if (quote) {
//                if (chLocal != '&quot;') {
//                    matchStat = NOT_MATCH;
//                    return 0;
//                } else {
//                    chLocal = charAt(bp + (offset++));
//                }
//                start = bp + 1;
//                count = bp + offset - start - 2;
//            } else {
//                start = bp;
//                count = bp + offset - start - 1;
//            }
//            String text = this.subString(start, count);
//            value = Float.parseFloat(text);
            int start, count;
<span class="fc bfc" id="L2740" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2741" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2742">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2743">                    return 0;</span>
                } else {
<span class="fc" id="L2745">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2747">                start = bp + 1;</span>
<span class="fc" id="L2748">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2750">                start = bp;</span>
<span class="fc" id="L2751">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2754" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2755">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2756" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2757">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L2760">                String text = this.subString(start, count);</span>
<span class="fc" id="L2761">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2763" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2764">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2765">            value = 0;</span>
<span class="fc" id="L2766">            offset += 3;</span>
<span class="fc" id="L2767">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2769" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2770">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2774" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2775">                    bp += offset;</span>
<span class="fc" id="L2776">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2777">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2778">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2779">                    return value;</span>
<span class="fc bfc" id="L2780" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2781">                    bp += offset;</span>
<span class="fc" id="L2782">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2783">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2784">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2785">                    return value;</span>
<span class="pc bpc" id="L2786" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2787">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2788">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2792">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2793">            return 0;</span>
        } else {
<span class="fc" id="L2795">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2796">            return 0;</span>
        }

<span class="fc bfc" id="L2799" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L2800">            bp += offset;</span>
<span class="fc" id="L2801">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2802">            matchStat = VALUE;</span>
<span class="fc" id="L2803">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2804">            return value;</span>
        } else {
<span class="fc" id="L2806">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2807">            return value;</span>
        }
    }

    public double scanDouble(char seperator) {
<span class="fc" id="L2812">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2814">        int offset = 0;</span>
<span class="fc" id="L2815">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2816" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L2817" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="fc" id="L2818">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L2821" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L2822" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2823">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="pc bpc" id="L2827" title="2 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2828">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="nc" id="L2830">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2831" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2832">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2833">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc" id="L2839">            long power = 1;</span>
<span class="nc bnc" id="L2840" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2841" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2842">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2843" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2844">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2845">                    power = 10;</span>
                    for (; ; ) {
<span class="nc" id="L2847">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2848" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2849">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2850">                            power *= 10;</span>
<span class="nc" id="L2851">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L2857">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2858">                    return 0;</span>
                }
            }

<span class="nc bnc" id="L2862" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L2863" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2864">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2865" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2866">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="nc bnc" id="L2869" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2870">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L2878" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L2879" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2880">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2881">                    return 0;</span>
                } else {
<span class="nc" id="L2883">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L2885">                start = bp + 1;</span>
<span class="nc" id="L2886">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L2888">                start = bp;</span>
<span class="nc" id="L2889">                count = bp + offset - start - 1;</span>
            }

<span class="nc bnc" id="L2892" title="All 4 branches missed.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="nc" id="L2893">                value = ((double) intVal) / power;</span>
<span class="nc bnc" id="L2894" title="All 2 branches missed.">                if (negative) {</span>
<span class="nc" id="L2895">                    value = -value;</span>
                }
            } else {
<span class="nc" id="L2898">                String text = this.subString(start, count);</span>
<span class="nc" id="L2899">                value = Double.parseDouble(text);</span>
            }
<span class="pc bpc" id="L2901" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2902">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2903">            value = 0;</span>
<span class="fc" id="L2904">            offset += 3;</span>
<span class="fc" id="L2905">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2907" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2908">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2912" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2913">                    bp += offset;</span>
<span class="fc" id="L2914">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2915">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2916">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2917">                    return value;</span>
<span class="fc bfc" id="L2918" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2919">                    bp += offset;</span>
<span class="fc" id="L2920">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2921">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2922">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2923">                    return value;</span>
<span class="pc bpc" id="L2924" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2925">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2926">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2930">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2931">            return 0;</span>
        } else {
<span class="nc" id="L2933">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2934">            return 0;</span>
        }

<span class="nc bnc" id="L2937" title="All 2 branches missed.">        if (chLocal == seperator) {</span>
<span class="nc" id="L2938">            bp += offset;</span>
<span class="nc" id="L2939">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L2940">            matchStat = VALUE;</span>
<span class="nc" id="L2941">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2942">            return value;</span>
        } else {
<span class="nc" id="L2944">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2945">            return value;</span>
        }
    }

    public BigDecimal scanDecimal(char seperator) {
<span class="nc" id="L2950">        matchStat = UNKNOWN;</span>

<span class="nc" id="L2952">        int offset = 0;</span>
<span class="nc" id="L2953">        char chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2954" title="All 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="nc bnc" id="L2955" title="All 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L2956">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="nc bnc" id="L2959" title="All 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="nc bnc" id="L2960" title="All 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2961">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="nc bnc" id="L2965" title="All 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="nc" id="L2967">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2968" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2969">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc bnc" id="L2975" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2976" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2977">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2978" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="nc" id="L2980">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2981" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2982">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L2988">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2989">                    return null;</span>
                }
            }

<span class="nc bnc" id="L2993" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L2994" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2995">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2996" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2997">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L3000" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3001">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L3009" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3010" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3011">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3012">                    return null;</span>
                } else {
<span class="nc" id="L3014">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3016">                start = bp + 1;</span>
<span class="nc" id="L3017">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L3019">                start = bp;</span>
<span class="nc" id="L3020">                count = bp + offset - start - 1;</span>
            }

<span class="nc" id="L3023">            char[] chars = this.sub_chars(start, count);</span>
<span class="nc" id="L3024">            value = new BigDecimal(chars);</span>
<span class="nc bnc" id="L3025" title="All 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="nc" id="L3026">            matchStat = VALUE_NULL;</span>
<span class="nc" id="L3027">            value = null;</span>
<span class="nc" id="L3028">            offset += 3;</span>
<span class="nc" id="L3029">            chLocal = charAt(bp + offset++);</span>

<span class="nc bnc" id="L3031" title="All 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3032">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="nc bnc" id="L3036" title="All 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3037">                    bp += offset;</span>
<span class="nc" id="L3038">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3039">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3040">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3041">                    return value;</span>
<span class="nc bnc" id="L3042" title="All 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="nc" id="L3043">                    bp += offset;</span>
<span class="nc" id="L3044">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3045">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3046">                    token = JSONToken.RBRACE;</span>
<span class="nc" id="L3047">                    return value;</span>
<span class="nc bnc" id="L3048" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3049">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3050">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3054">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3055">            return null;</span>
        } else {
<span class="nc" id="L3057">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3058">            return null;</span>
        }

<span class="nc bnc" id="L3061" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3062">            bp += offset;</span>
<span class="nc" id="L3063">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L3064">            matchStat = VALUE;</span>
<span class="nc" id="L3065">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3066">            return value;</span>
        }

<span class="nc bnc" id="L3069" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L3070">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3071" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3072">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3073">                bp += offset;</span>
<span class="nc" id="L3074">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3075" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3076">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3077">                bp += offset;</span>
<span class="nc" id="L3078">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3079" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3080">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3081">                bp += offset;</span>
<span class="nc" id="L3082">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3083" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L3084">                token = JSONToken.EOF;</span>
<span class="nc" id="L3085">                bp += (offset - 1);</span>
<span class="nc" id="L3086">                ch = EOI;</span>
            } else {
<span class="nc" id="L3088">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3089">                return null;</span>
            }
<span class="nc" id="L3091">            matchStat = END;</span>
        } else {
<span class="nc" id="L3093">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3094">            return null;</span>
        }

<span class="nc" id="L3097">        return value;</span>
    }

    public final float[] scanFieldFloatArray(char[] fieldName) {
<span class="fc" id="L3101">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3103" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3104">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3105">            return null;</span>
        }

<span class="fc" id="L3108">        int offset = fieldName.length;</span>
<span class="fc" id="L3109">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3110" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L3111">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3112">            return null;</span>
        }
<span class="fc" id="L3114">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3116">        float[] array = new float[16];</span>
<span class="fc" id="L3117">        int arrayIndex = 0;</span>

        for (;;) {
<span class="fc" id="L3120">            int start = bp + offset - 1;</span>

<span class="fc bfc" id="L3122" title="All 2 branches covered.">            boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3123" title="All 2 branches covered.">            if (negative) {</span>
<span class="fc" id="L3124">                chLocal = charAt(bp + (offset++));</span>
            }

<span class="pc bpc" id="L3127" title="1 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3128">                int intVal = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L3130">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3131" title="3 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3132">                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3133">                        continue;</span>
                    } else {
                        break;
                    }
                }

<span class="fc" id="L3139">                int power = 1;</span>
<span class="fc bfc" id="L3140" title="All 2 branches covered.">                boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3141" title="All 2 branches covered.">                if (small) {</span>
<span class="fc" id="L3142">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3143">                    power = 10;</span>
<span class="pc bpc" id="L3144" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3145">                        intVal = intVal * 10 + (chLocal - '0');</span>
                        for (; ; ) {
<span class="fc" id="L3147">                            chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L3149" title="All 4 branches covered.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3150">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3151">                                power *= 10;</span>
<span class="fc" id="L3152">                                continue;</span>
                            } else {
                                break;
                            }
                        }
                    } else {
<span class="nc" id="L3158">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3159">                        return null;</span>
                    }
                }

<span class="pc bpc" id="L3163" title="1 of 4 branches missed.">                boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3164" title="All 2 branches covered.">                if (exp) {</span>
<span class="fc" id="L3165">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3166" title="2 of 4 branches missed.">                    if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3167">                        chLocal = charAt(bp + (offset++));</span>
                    }
                    for (;;) {
<span class="pc bpc" id="L3170" title="1 of 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3171">                            chLocal = charAt(bp + (offset++));</span>
                        } else {
                            break;
                        }
                    }
                }

<span class="fc" id="L3178">                int count = bp + offset - start - 1;</span>

                float value;
<span class="fc bfc" id="L3181" title="All 4 branches covered.">                if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3182">                    value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3183" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3184">                        value = -value;</span>
                    }
                } else {
<span class="fc" id="L3187">                    String text = this.subString(start, count);</span>
<span class="fc" id="L3188">                    value = Float.parseFloat(text);</span>
                }

<span class="pc bpc" id="L3191" title="1 of 2 branches missed.">                if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3192">                    float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3193">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3194">                    array = tmp;</span>
                }
<span class="fc" id="L3196">                array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3198" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3199">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3200" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3201">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3202">                    break;</span>
                }
<span class="fc" id="L3204">            } else {</span>
<span class="fc" id="L3205">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3206">                return null;</span>
            }
<span class="fc" id="L3208">        }</span>


<span class="pc bpc" id="L3211" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L3212">            float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3213">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3214">            array = tmp;</span>
        }

<span class="pc bpc" id="L3217" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3218">            bp += (offset - 1);</span>
<span class="nc" id="L3219">            this.next();</span>
<span class="nc" id="L3220">            matchStat = VALUE;</span>
<span class="nc" id="L3221">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3222">            return array;</span>
        }

<span class="pc bpc" id="L3225" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3226">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3227" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3228">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3229">                bp += (offset - 1);</span>
<span class="nc" id="L3230">                this.next();</span>
<span class="pc bpc" id="L3231" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3232">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3233">                bp += (offset - 1);</span>
<span class="nc" id="L3234">                this.next();</span>
<span class="pc bpc" id="L3235" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3236">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3237">                bp += (offset - 1);</span>
<span class="nc" id="L3238">                this.next();</span>
<span class="pc bpc" id="L3239" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3240">                bp += (offset - 1);</span>
<span class="fc" id="L3241">                token = JSONToken.EOF;</span>
<span class="fc" id="L3242">                ch = EOI;</span>
            } else {
<span class="nc" id="L3244">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3245">                return null;</span>
            }
<span class="fc" id="L3247">            matchStat = END;</span>
        } else {
<span class="nc" id="L3249">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3250">            return null;</span>
        }

<span class="fc" id="L3253">        return array;</span>
    }

    public final float[][] scanFieldFloatArray2(char[] fieldName) {
<span class="fc" id="L3257">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3259" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3260">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3261">            return null;</span>
        }

<span class="fc" id="L3264">        int offset = fieldName.length;</span>
<span class="fc" id="L3265">        char chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3267" title="1 of 2 branches missed.">        if (chLocal != '[') {</span>
<span class="nc" id="L3268">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3269">            return null;</span>
        }
<span class="fc" id="L3271">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3273">        float[][] arrayarray = new float[16][];</span>
<span class="fc" id="L3274">        int arrayarrayIndex = 0;</span>

        for (;;) {
<span class="fc bfc" id="L3277" title="All 2 branches covered.">            if (chLocal == '[') {</span>
<span class="fc" id="L3278">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3280">                float[] array = new float[16];</span>
<span class="fc" id="L3281">                int arrayIndex = 0;</span>

                for (; ; ) {
<span class="fc" id="L3284">                    int start = bp + offset - 1;</span>
<span class="fc bfc" id="L3285" title="All 2 branches covered.">                    boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3286" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3287">                        chLocal = charAt(bp + (offset++));</span>
                    }

<span class="pc bpc" id="L3290" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3291">                        int intVal = chLocal - '0';</span>
                        for (; ; ) {
<span class="fc" id="L3293">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3295" title="3 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3296">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3297">                                continue;</span>
                            } else {
                                break;
                            }
                        }

<span class="fc" id="L3303">                        int power = 1;</span>
<span class="fc bfc" id="L3304" title="All 2 branches covered.">                        if (chLocal == '.') {</span>
<span class="fc" id="L3305">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3307" title="2 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3308">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3309">                                power = 10;</span>
                                for (; ; ) {
<span class="fc" id="L3311">                                    chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3313" title="1 of 4 branches missed.">                                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3314">                                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3315">                                        power *= 10;</span>
<span class="nc" id="L3316">                                        continue;</span>
                                    } else {
                                        break;
                                    }
                                }
                            } else {
<span class="nc" id="L3322">                                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3323">                                return null;</span>
                            }
                        }

<span class="pc bpc" id="L3327" title="2 of 4 branches missed.">                        boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3328" title="1 of 2 branches missed.">                        if (exp) {</span>
<span class="nc" id="L3329">                            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3330" title="All 4 branches missed.">                            if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3331">                                chLocal = charAt(bp + (offset++));</span>
                            }
                            for (;;) {
<span class="nc bnc" id="L3334" title="All 4 branches missed.">                                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3335">                                    chLocal = charAt(bp + (offset++));</span>
                                } else {
                                    break;
                                }
                            }
                        }

<span class="fc" id="L3342">                        int count = bp + offset - start - 1;</span>
                        float value;
<span class="pc bpc" id="L3344" title="2 of 4 branches missed.">                        if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3345">                            value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3346" title="All 2 branches covered.">                            if (negative) {</span>
<span class="fc" id="L3347">                                value = -value;</span>
                            }
                        } else {
<span class="nc" id="L3350">                            String text = this.subString(start, count);</span>
<span class="nc" id="L3351">                            value = Float.parseFloat(text);</span>
                        }

<span class="pc bpc" id="L3354" title="1 of 2 branches missed.">                        if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3355">                            float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3356">                            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3357">                            array = tmp;</span>
                        }
<span class="fc" id="L3359">                        array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3361" title="All 2 branches covered.">                        if (chLocal == ',') {</span>
<span class="fc" id="L3362">                            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3363" title="1 of 2 branches missed.">                        } else if (chLocal == ']') {</span>
<span class="fc" id="L3364">                            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3365">                            break;</span>
                        }
<span class="fc" id="L3367">                    } else {</span>
<span class="nc" id="L3368">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3369">                        return null;</span>
                    }
<span class="fc" id="L3371">                }</span>

                // compact
<span class="pc bpc" id="L3374" title="1 of 2 branches missed.">                if (arrayIndex != array.length) {</span>
<span class="fc" id="L3375">                    float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3376">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3377">                    array = tmp;</span>
                }

<span class="pc bpc" id="L3380" title="1 of 2 branches missed.">                if (arrayarrayIndex &gt;= arrayarray.length) {</span>
<span class="nc" id="L3381">                    float[][] tmp = new float[arrayarray.length * 3 / 2][];</span>
<span class="nc" id="L3382">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3383">                    arrayarray = tmp;</span>
                }
<span class="fc" id="L3385">                arrayarray[arrayarrayIndex++] = array;</span>

<span class="pc bpc" id="L3387" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3388">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3389" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3390">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3391">                    break;</span>
                }
<span class="nc" id="L3393">            } else {</span>
                break;
            }
        }

        // compact
<span class="pc bpc" id="L3399" title="1 of 2 branches missed.">        if (arrayarrayIndex != arrayarray.length) {</span>
<span class="fc" id="L3400">            float[][] tmp = new float[arrayarrayIndex][];</span>
<span class="fc" id="L3401">            System.arraycopy(arrayarray, 0, tmp, 0, arrayarrayIndex);</span>
<span class="fc" id="L3402">            arrayarray = tmp;</span>
        }

<span class="pc bpc" id="L3405" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3406">            bp += (offset - 1);</span>
<span class="nc" id="L3407">            this.next();</span>
<span class="nc" id="L3408">            matchStat = VALUE;</span>
<span class="nc" id="L3409">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3410">            return arrayarray;</span>
        }

<span class="fc bfc" id="L3413" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3414">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3415" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3416">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3417">                bp += (offset - 1);</span>
<span class="nc" id="L3418">                this.next();</span>
<span class="pc bpc" id="L3419" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3420">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3421">                bp += (offset - 1);</span>
<span class="nc" id="L3422">                this.next();</span>
<span class="pc bpc" id="L3423" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3424">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3425">                bp += (offset - 1);</span>
<span class="nc" id="L3426">                this.next();</span>
<span class="pc bpc" id="L3427" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3428">                bp += (offset - 1);</span>
<span class="fc" id="L3429">                token = JSONToken.EOF;</span>
<span class="fc" id="L3430">                ch = EOI;</span>
            } else {
<span class="nc" id="L3432">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3433">                return null;</span>
            }
<span class="fc" id="L3435">            matchStat = END;</span>
        } else {
<span class="fc" id="L3437">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3438">            return null;</span>
        }

<span class="fc" id="L3441">        return arrayarray;</span>
    }

    public final double scanFieldDouble(char[] fieldName) {
<span class="fc" id="L3445">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3447" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3448">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3449">            return 0;</span>
        }

<span class="fc" id="L3452">        int offset = fieldName.length;</span>
<span class="fc" id="L3453">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3454" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3455" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3456">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L3459" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3460" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L3461">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="fc bfc" id="L3465" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3466">            long intVal = chLocal - '0';</span>

            for (;;) {
<span class="fc" id="L3469">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3470" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3471">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3472">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L3478">            long power = 1;</span>
<span class="fc bfc" id="L3479" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3480" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3481">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3482" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3483">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3484">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L3486">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3487" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3488">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3489">                            power *= 10;</span>
<span class="fc" id="L3490">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L3496">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3497">                    return 0;</span>
                }
            }

<span class="fc bfc" id="L3501" title="All 4 branches covered.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3502" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L3503">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3504" title="All 4 branches covered.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3505">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="fc bfc" id="L3508" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3509">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L3517" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L3518" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3519">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3520">                    return 0;</span>
                } else {
<span class="fc" id="L3522">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L3524">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L3525">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3527">                start = bp + fieldName.length;</span>
<span class="fc" id="L3528">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L3531" title="All 4 branches covered.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L3532">                value = ((double) intVal) / power;</span>
<span class="fc bfc" id="L3533" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L3534">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L3537">                String text = this.subString(start, count);</span>
<span class="fc" id="L3538">                value = Double.parseDouble(text);</span>
            }
<span class="pc bpc" id="L3540" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3541">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3542">            value = 0;</span>
<span class="fc" id="L3543">            offset += 3;</span>
<span class="fc" id="L3544">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3546" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L3547">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L3551" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3552">                    bp += offset;</span>
<span class="fc" id="L3553">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3554">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3555">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L3556">                    return value;</span>
<span class="fc bfc" id="L3557" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3558">                    bp += offset;</span>
<span class="fc" id="L3559">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3560">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3561">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3562">                    return value;</span>
<span class="pc bpc" id="L3563" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L3564">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L3565">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3569">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3570">            return 0;</span>
        } else {
<span class="fc" id="L3572">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3573">            return 0;</span>
        }

<span class="fc bfc" id="L3576" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3577">            bp += offset;</span>
<span class="fc" id="L3578">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3579">            matchStat = VALUE;</span>
<span class="fc" id="L3580">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3581">            return value;</span>
        }

<span class="fc bfc" id="L3584" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3585">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3586" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L3587">                token = JSONToken.COMMA;</span>
<span class="fc" id="L3588">                bp += offset;</span>
<span class="fc" id="L3589">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3590" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3591">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3592">                bp += offset;</span>
<span class="fc" id="L3593">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3594" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L3595">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L3596">                bp += offset;</span>
<span class="fc" id="L3597">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3598" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3599">                token = JSONToken.EOF;</span>
<span class="fc" id="L3600">                bp += (offset - 1);</span>
<span class="fc" id="L3601">                ch = EOI;</span>
            } else {
<span class="fc" id="L3603">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3604">                return 0;</span>
            }
<span class="fc" id="L3606">            matchStat = END;</span>
        } else {
<span class="fc" id="L3608">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3609">            return 0;</span>
        }

<span class="fc" id="L3612">        return value;</span>
    }

    public BigDecimal scanFieldDecimal(char[] fieldName) {
<span class="fc" id="L3616">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3618" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3619">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3620">            return null;</span>
        }

<span class="fc" id="L3623">        int offset = fieldName.length;</span>
<span class="fc" id="L3624">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3625" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3626" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3627">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3630" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3631" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3632">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="pc bpc" id="L3636" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="fc" id="L3638">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3639" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3640">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc bfc" id="L3646" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3647" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3648">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3649" title="2 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="fc" id="L3651">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3652" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3653">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3659">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3660">                    return null;</span>
                }
            }

<span class="pc bpc" id="L3664" title="2 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3665" title="1 of 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3666">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3667" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3668">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L3671" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3672">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="pc bpc" id="L3680" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3681" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3682">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3683">                    return null;</span>
                } else {
<span class="nc" id="L3685">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3687">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3688">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3690">                start = bp + fieldName.length;</span>
<span class="fc" id="L3691">                count = bp + offset - start - 1;</span>
            }

<span class="fc" id="L3694">            char[] chars = this.sub_chars(start, count);</span>
<span class="fc" id="L3695">            value = new BigDecimal(chars);</span>
<span class="pc bpc" id="L3696" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3697">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3698">            value = null;</span>
<span class="fc" id="L3699">            offset += 3;</span>
<span class="fc" id="L3700">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3702" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3703">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3707" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3708">                    bp += offset;</span>
<span class="nc" id="L3709">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3710">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3711">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3712">                    return value;</span>
<span class="pc bpc" id="L3713" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3714">                    bp += offset;</span>
<span class="fc" id="L3715">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3716">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3717">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3718">                    return value;</span>
<span class="nc bnc" id="L3719" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3720">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3721">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3725">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3726">            return null;</span>
        } else {
<span class="fc" id="L3728">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3729">            return null;</span>
        }

<span class="fc bfc" id="L3732" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3733">            bp += offset;</span>
<span class="fc" id="L3734">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3735">            matchStat = VALUE;</span>
<span class="fc" id="L3736">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3737">            return value;</span>
        }

<span class="pc bpc" id="L3740" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3741">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3742" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3743">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3744">                bp += offset;</span>
<span class="nc" id="L3745">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3746" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3747">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3748">                bp += offset;</span>
<span class="fc" id="L3749">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3750" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3751">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3752">                bp += offset;</span>
<span class="nc" id="L3753">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3754" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3755">                token = JSONToken.EOF;</span>
<span class="fc" id="L3756">                bp += (offset - 1);</span>
<span class="fc" id="L3757">                ch = EOI;</span>
            } else {
<span class="nc" id="L3759">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3760">                return null;</span>
            }
<span class="fc" id="L3762">            matchStat = END;</span>
        } else {
<span class="nc" id="L3764">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3765">            return null;</span>
        }

<span class="fc" id="L3768">        return value;</span>
    }

    public BigInteger scanFieldBigInteger(char[] fieldName) {
<span class="fc" id="L3772">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3774" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3775">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3776">            return null;</span>
        }

<span class="fc" id="L3779">        int offset = fieldName.length;</span>
<span class="fc" id="L3780">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3781" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L3782" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L3783">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3786" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3787" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3788">            chLocal = charAt(bp + (offset++));</span>
        }

        BigInteger value;
<span class="pc bpc" id="L3792" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3793">            long intVal = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L3795">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3796" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3797">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3798">                    continue;</span>
                } else {
                    break;
                }
            }

            int start, count;
<span class="pc bpc" id="L3805" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3806" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3807">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3808">                    return null;</span>
                } else {
<span class="nc" id="L3810">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3812">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3813">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3815">                start = bp + fieldName.length;</span>
<span class="fc" id="L3816">                count = bp + offset - start - 1;</span>
            }

<span class="pc bpc" id="L3819" title="3 of 6 branches missed.">            if (count &lt; 20 || (negative &amp;&amp; count &lt; 21)) {</span>
<span class="pc bpc" id="L3820" title="1 of 2 branches missed.">                value = BigInteger.valueOf(negative ? -intVal : intVal);</span>
            } else {

//            char[] chars = this.sub_chars(negative ? start + 1 : start, count);
//            value = new BigInteger(chars, )
<span class="fc" id="L3825">                String strVal = this.subString(start, count);</span>
<span class="fc" id="L3826">                value = new BigInteger(strVal);</span>
            }
<span class="pc bpc" id="L3828" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3829">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3830">            value = null;</span>
<span class="fc" id="L3831">            offset += 3;</span>
<span class="fc" id="L3832">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3834" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3835">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3839" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3840">                    bp += offset;</span>
<span class="nc" id="L3841">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3842">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3843">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3844">                    return value;</span>
<span class="pc bpc" id="L3845" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3846">                    bp += offset;</span>
<span class="fc" id="L3847">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3848">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3849">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3850">                    return value;</span>
<span class="nc bnc" id="L3851" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3852">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3853">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3857">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3858">            return null;</span>
        } else {
<span class="nc" id="L3860">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3861">            return null;</span>
        }

<span class="fc bfc" id="L3864" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3865">            bp += offset;</span>
<span class="fc" id="L3866">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3867">            matchStat = VALUE;</span>
<span class="fc" id="L3868">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3869">            return value;</span>
        }

<span class="fc bfc" id="L3872" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3873">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3874" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3875">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3876">                bp += offset;</span>
<span class="nc" id="L3877">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3878" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3879">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3880">                bp += offset;</span>
<span class="nc" id="L3881">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3882" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3883">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3884">                bp += offset;</span>
<span class="nc" id="L3885">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3886" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3887">                token = JSONToken.EOF;</span>
<span class="fc" id="L3888">                bp += (offset - 1);</span>
<span class="fc" id="L3889">                ch = EOI;</span>
            } else {
<span class="nc" id="L3891">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3892">                return null;</span>
            }
<span class="fc" id="L3894">            matchStat = END;</span>
        } else {
<span class="fc" id="L3896">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3897">            return null;</span>
        }

<span class="fc" id="L3900">        return value;</span>
    }

    public java.util.Date scanFieldDate(char[] fieldName) {
<span class="fc" id="L3904">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3906" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3907">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3908">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L3913">        int offset = fieldName.length;</span>
<span class="fc" id="L3914">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L3917" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L3918">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L3919">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L3920" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L3921">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L3924">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L3925">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L3926" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L3928">                    int slashCount = 0;</span>
<span class="nc bnc" id="L3929" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L3930" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L3931">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L3936" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L3937">                        break;</span>
                    }
<span class="nc" id="L3939">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L3940">                }</span>

<span class="nc" id="L3942">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="nc" id="L3943">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="nc" id="L3945">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L3948">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L3949">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3951">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="fc bfc" id="L3953" title="All 2 branches covered.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L3954">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L3955">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L3956">                } else {</span>
<span class="fc" id="L3957">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3958">                    return null;</span>
                }
            } finally {
<span class="fc" id="L3961">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L3963" title="3 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L3964">            long millis = 0;</span>

<span class="fc" id="L3966">            boolean negative = false;</span>
<span class="pc bpc" id="L3967" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L3968">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L3969">                negative = true;</span>
            }

<span class="pc bpc" id="L3972" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3973">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L3975">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3976" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3977">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L3984" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L3985">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3986">                return null;</span>
            }

<span class="pc bpc" id="L3989" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L3990">                millis = -millis;</span>
            }

<span class="fc" id="L3993">            dateVal = new java.util.Date(millis);</span>
<span class="fc" id="L3994">        } else {</span>
<span class="nc" id="L3995">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3996">            return null;</span>
        }

<span class="fc bfc" id="L3999" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4000">            bp += offset;</span>
<span class="fc" id="L4001">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4002">            matchStat = VALUE;</span>
<span class="fc" id="L4003">            return dateVal;</span>
        }

<span class="pc bpc" id="L4006" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4007">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4008" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4009">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4010">                bp += offset;</span>
<span class="nc" id="L4011">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4012" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4013">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4014">                bp += offset;</span>
<span class="nc" id="L4015">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4016" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4017">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4018">                bp += offset;</span>
<span class="nc" id="L4019">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4020" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4021">                token = JSONToken.EOF;</span>
<span class="fc" id="L4022">                bp += (offset - 1);</span>
<span class="fc" id="L4023">                ch = EOI;</span>
            } else {
<span class="nc" id="L4025">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4026">                return null;</span>
            }
<span class="fc" id="L4028">            matchStat = END;</span>
        } else {
<span class="nc" id="L4030">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4031">            return null;</span>
        }

<span class="fc" id="L4034">        return dateVal;</span>
    }

    public java.util.Date scanDate(char seperator) {
<span class="fc" id="L4038">        matchStat = UNKNOWN;</span>

<span class="fc" id="L4040">        int offset = 0;</span>
<span class="fc" id="L4041">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L4044" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L4045">            int startIndex = bp + 1;</span>
<span class="fc" id="L4046">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4047" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4048">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4051">            int startIndex2 = bp + 1; // must re compute</span>
<span class="fc" id="L4052">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L4053" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L4055">                    int slashCount = 0;</span>
<span class="nc bnc" id="L4056" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L4057" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L4058">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L4063" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L4064">                        break;</span>
                    }
<span class="nc" id="L4066">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L4067">                }</span>

<span class="nc" id="L4069">                int chars_len = endIndex - (bp + 1);</span>
<span class="nc" id="L4070">                char[] chars = sub_chars( bp + 1, chars_len);</span>

<span class="nc" id="L4072">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L4075">            offset += (endIndex - (bp + 1) + 1);</span>
<span class="fc" id="L4076">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L4078">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="pc bpc" id="L4080" title="1 of 2 branches missed.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L4081">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L4082">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L4083">                } else {</span>
<span class="nc" id="L4084">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L4085">                    return null;</span>
                }
            } finally {
<span class="fc" id="L4088">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L4090" title="2 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L4091">            long millis = 0;</span>

<span class="fc" id="L4093">            boolean negative = false;</span>
<span class="pc bpc" id="L4094" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L4095">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4096">                negative = true;</span>
            }

<span class="pc bpc" id="L4099" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4100">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L4102">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L4103" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4104">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4111" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4112">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4113">                return null;</span>
            }

<span class="pc bpc" id="L4116" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4117">                millis = -millis;</span>
            }

<span class="fc" id="L4120">            dateVal = new java.util.Date(millis);</span>
<span class="pc bpc" id="L4121" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L4122">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L4123">            dateVal = null;</span>
<span class="fc" id="L4124">            offset += 3;</span>
<span class="fc" id="L4125">            chLocal = charAt(bp + offset++);</span>
        } else {
<span class="nc" id="L4127">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4128">            return null;</span>
        }

<span class="fc bfc" id="L4131" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4132">            bp += offset;</span>
<span class="fc" id="L4133">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4134">            matchStat = VALUE;</span>
<span class="fc" id="L4135">            token = JSONToken.COMMA;</span>
<span class="fc" id="L4136">            return dateVal;</span>
        }

<span class="pc bpc" id="L4139" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="fc" id="L4140">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4141" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4142">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4143">                bp += offset;</span>
<span class="nc" id="L4144">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4145" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4146">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4147">                bp += offset;</span>
<span class="nc" id="L4148">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4149" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4150">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4151">                bp += offset;</span>
<span class="nc" id="L4152">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4153" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4154">                token = JSONToken.EOF;</span>
<span class="fc" id="L4155">                bp += (offset - 1);</span>
<span class="fc" id="L4156">                ch = EOI;</span>
            } else {
<span class="nc" id="L4158">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4159">                return null;</span>
            }
<span class="fc" id="L4161">            matchStat = END;</span>
        } else {
<span class="nc" id="L4163">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4164">            return null;</span>
        }

<span class="fc" id="L4167">        return dateVal;</span>
    }

    public java.util.UUID scanFieldUUID(char[] fieldName) {
<span class="fc" id="L4171">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L4173" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L4174">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4175">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L4180">        int offset = fieldName.length;</span>
<span class="fc" id="L4181">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="fc bfc" id="L4184" title="All 2 branches covered.">        if (chLocal == '&quot;') {</span>
<span class="fc" id="L4185">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L4186">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4187" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4188">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4191">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L4192">            int len = endIndex - startIndex2;</span>
<span class="pc bpc" id="L4193" title="1 of 2 branches missed.">            if (len == 36) {</span>
<span class="fc" id="L4194">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="fc bfc" id="L4195" title="All 2 branches covered.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="fc" id="L4196">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4198" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4199">                        num = ch - '0';</span>
<span class="pc bpc" id="L4200" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4201">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4202" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4203">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4205">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4206">                        return null;</span>
                    }

<span class="fc" id="L4209">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4210">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4212" title="All 2 branches covered.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="fc" id="L4213">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4215" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4216">                        num = ch - '0';</span>
<span class="pc bpc" id="L4217" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4218">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4219" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4220">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4222">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4223">                        return null;</span>
                    }

<span class="fc" id="L4226">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4227">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4229" title="All 2 branches covered.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="fc" id="L4230">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4232" title="2 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4233">                        num = ch - '0';</span>
<span class="nc bnc" id="L4234" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4235">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4236" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4237">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4239">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4240">                        return null;</span>
                    }

<span class="fc" id="L4243">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4244">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4246" title="All 2 branches covered.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="fc" id="L4247">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4249" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4250">                        num = ch - '0';</span>
<span class="pc bpc" id="L4251" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4252">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4253" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4254">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4256">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4257">                        return null;</span>
                    }

<span class="fc" id="L4260">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4261">                    leastSigBits |= num;</span>
                }
<span class="fc bfc" id="L4263" title="All 2 branches covered.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="fc" id="L4264">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4266" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4267">                        num = ch - '0';</span>
<span class="pc bpc" id="L4268" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4269">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4270" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4271">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4273">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4274">                        return null;</span>
                    }

<span class="fc" id="L4277">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4278">                    leastSigBits |= num;</span>
                }
<span class="fc" id="L4280">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="fc" id="L4282">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L4283">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bnc" id="L4284" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4285">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4286" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4287">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4289" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4290">                        num = ch - '0';</span>
<span class="nc bnc" id="L4291" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4292">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4293" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4294">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4296">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4297">                        return null;</span>
                    }

<span class="nc" id="L4300">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4301">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4303" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4304">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4306" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4307">                        num = ch - '0';</span>
<span class="nc bnc" id="L4308" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4309">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4310" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4311">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4313">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4314">                        return null;</span>
                    }

<span class="nc" id="L4317">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4318">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4321">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4323">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="nc" id="L4324">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4325">            } else {</span>
<span class="nc" id="L4326">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4327">                return null;</span>
            }
<span class="pc bpc" id="L4329" title="1 of 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="pc bpc" id="L4330" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="pc bpc" id="L4331" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="pc bpc" id="L4332" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="fc" id="L4333">            uuid = null;</span>
<span class="fc" id="L4334">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4336">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4337">            return null;</span>
        }

<span class="pc bpc" id="L4340" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4341">            bp += offset;</span>
<span class="nc" id="L4342">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4343">            matchStat = VALUE;</span>
<span class="nc" id="L4344">            return uuid;</span>
        }

<span class="pc bpc" id="L4347" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4348">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4349" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4350">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4351">                bp += offset;</span>
<span class="nc" id="L4352">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4353" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4354">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4355">                bp += offset;</span>
<span class="nc" id="L4356">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4357" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4358">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4359">                bp += offset;</span>
<span class="nc" id="L4360">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4361" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4362">                token = JSONToken.EOF;</span>
<span class="fc" id="L4363">                bp += (offset - 1);</span>
<span class="fc" id="L4364">                ch = EOI;</span>
            } else {
<span class="nc" id="L4366">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4367">                return null;</span>
            }
<span class="fc" id="L4369">            matchStat = END;</span>
        } else {
<span class="nc" id="L4371">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4372">            return null;</span>
        }

<span class="fc" id="L4375">        return uuid;</span>
    }

    public java.util.UUID scanUUID(char seperator) {
<span class="nc" id="L4379">        matchStat = UNKNOWN;</span>

        // int index = bp + fieldName.length;

<span class="nc" id="L4383">        int offset = 0;</span>
<span class="nc" id="L4384">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="nc bnc" id="L4387" title="All 2 branches missed.">        if (chLocal == '&quot;') {</span>
<span class="nc" id="L4388">            int startIndex = bp + 1;</span>
<span class="nc" id="L4389">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="nc bnc" id="L4390" title="All 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4391">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="nc" id="L4394">            int startIndex2 = bp + 1; // must re compute</span>
<span class="nc" id="L4395">            int len = endIndex - startIndex2;</span>
<span class="nc bnc" id="L4396" title="All 2 branches missed.">            if (len == 36) {</span>
<span class="nc" id="L4397">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4398" title="All 2 branches missed.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="nc" id="L4399">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4401" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4402">                        num = ch - '0';</span>
<span class="nc bnc" id="L4403" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4404">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4405" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4406">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4408">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4409">                        return null;</span>
                    }

<span class="nc" id="L4412">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4413">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4415" title="All 2 branches missed.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="nc" id="L4416">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4418" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4419">                        num = ch - '0';</span>
<span class="nc bnc" id="L4420" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4421">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4422" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4423">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4425">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4426">                        return null;</span>
                    }

<span class="nc" id="L4429">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4430">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4432" title="All 2 branches missed.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="nc" id="L4433">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4435" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4436">                        num = ch - '0';</span>
<span class="nc bnc" id="L4437" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4438">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4439" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4440">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4442">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4443">                        return null;</span>
                    }

<span class="nc" id="L4446">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4447">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4449" title="All 2 branches missed.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="nc" id="L4450">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4452" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4453">                        num = ch - '0';</span>
<span class="nc bnc" id="L4454" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4455">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4456" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4457">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4459">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4460">                        return null;</span>
                    }

<span class="nc" id="L4463">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4464">                    leastSigBits |= num;</span>
                }
<span class="nc bnc" id="L4466" title="All 2 branches missed.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="nc" id="L4467">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4469" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4470">                        num = ch - '0';</span>
<span class="nc bnc" id="L4471" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4472">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4473" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4474">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4476">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4477">                        return null;</span>
                    }

<span class="nc" id="L4480">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4481">                    leastSigBits |= num;</span>
                }
<span class="nc" id="L4483">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4485">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4486">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4487" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4488">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4489" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4490">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4492" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4493">                        num = ch - '0';</span>
<span class="nc bnc" id="L4494" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4495">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4496" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4497">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4499">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4500">                        return null;</span>
                    }

<span class="nc" id="L4503">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4504">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4506" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4507">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4509" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4510">                        num = ch - '0';</span>
<span class="nc bnc" id="L4511" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4512">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4513" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4514">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4516">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4517">                        return null;</span>
                    }

<span class="nc" id="L4520">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4521">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4524">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4526">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4527">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4528">            } else {</span>
<span class="nc" id="L4529">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4530">                return null;</span>
            }
<span class="nc bnc" id="L4532" title="All 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="nc bnc" id="L4533" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="nc bnc" id="L4534" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="nc bnc" id="L4535" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="nc" id="L4536">            uuid = null;</span>
<span class="nc" id="L4537">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4539">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4540">            return null;</span>
        }

<span class="nc bnc" id="L4543" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4544">            bp += offset;</span>
<span class="nc" id="L4545">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4546">            matchStat = VALUE;</span>
<span class="nc" id="L4547">            return uuid;</span>
        }

<span class="nc bnc" id="L4550" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L4551">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4552" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4553">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4554">                bp += offset;</span>
<span class="nc" id="L4555">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4556" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4557">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4558">                bp += offset;</span>
<span class="nc" id="L4559">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4560" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4561">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4562">                bp += offset;</span>
<span class="nc" id="L4563">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4564" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L4565">                token = JSONToken.EOF;</span>
<span class="nc" id="L4566">                bp += (offset - 1);</span>
<span class="nc" id="L4567">                ch = EOI;</span>
            } else {
<span class="nc" id="L4569">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4570">                return null;</span>
            }
<span class="nc" id="L4572">            matchStat = END;</span>
        } else {
<span class="nc" id="L4574">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4575">            return null;</span>
        }

<span class="nc" id="L4578">        return uuid;</span>
    }

    public final void scanTrue() {
<span class="fc bfc" id="L4582" title="All 2 branches covered.">        if (ch != 't') {</span>
<span class="fc" id="L4583">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4585">        next();</span>

<span class="fc bfc" id="L4587" title="All 2 branches covered.">        if (ch != 'r') {</span>
<span class="fc" id="L4588">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4590">        next();</span>

<span class="fc bfc" id="L4592" title="All 2 branches covered.">        if (ch != 'u') {</span>
<span class="fc" id="L4593">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4595">        next();</span>

<span class="fc bfc" id="L4597" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4598">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4600">        next();</span>

<span class="pc bpc" id="L4602" title="1 of 24 branches missed.">        if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                || ch == '\f' || ch == '\b' || ch == ':' || ch == '/') {
<span class="fc" id="L4604">            token = JSONToken.TRUE;</span>
        } else {
<span class="fc" id="L4606">            throw new JSONException(&quot;scan true error&quot;);</span>
        }
<span class="fc" id="L4608">    }</span>

    public final void scanNullOrNew() {
<span class="fc bfc" id="L4611" title="All 2 branches covered.">        if (ch != 'n') {</span>
<span class="fc" id="L4612">            throw new JSONException(&quot;error parse null or new&quot;);</span>
        }
<span class="fc" id="L4614">        next();</span>

<span class="fc bfc" id="L4616" title="All 2 branches covered.">        if (ch == 'u') {</span>
<span class="fc" id="L4617">            next();</span>
<span class="fc bfc" id="L4618" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4619">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4621">            next();</span>

<span class="fc bfc" id="L4623" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4624">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4626">            next();</span>

<span class="fc bfc" id="L4628" title="All 20 branches covered.">            if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                    || ch == '\f' || ch == '\b') {
<span class="fc" id="L4630">                token = JSONToken.NULL;</span>
            } else {
<span class="fc" id="L4632">                throw new JSONException(&quot;scan null error&quot;);</span>
            }
<span class="fc" id="L4634">            return;</span>
        }

<span class="fc bfc" id="L4637" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4638">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4640">        next();</span>

<span class="fc bfc" id="L4642" title="All 2 branches covered.">        if (ch != 'w') {</span>
<span class="fc" id="L4643">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4645">        next();</span>

<span class="fc bfc" id="L4647" title="All 20 branches covered.">        if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                || ch == '\f' || ch == '\b') {
<span class="fc" id="L4649">            token = JSONToken.NEW;</span>
        } else {
<span class="fc" id="L4651">            throw new JSONException(&quot;scan new error&quot;);</span>
        }
<span class="fc" id="L4653">    }</span>

    public final void scanFalse() {
<span class="fc bfc" id="L4656" title="All 2 branches covered.">        if (ch != 'f') {</span>
<span class="fc" id="L4657">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4659">        next();</span>

<span class="fc bfc" id="L4661" title="All 2 branches covered.">        if (ch != 'a') {</span>
<span class="fc" id="L4662">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4664">        next();</span>

<span class="fc bfc" id="L4666" title="All 2 branches covered.">        if (ch != 'l') {</span>
<span class="fc" id="L4667">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4669">        next();</span>

<span class="fc bfc" id="L4671" title="All 2 branches covered.">        if (ch != 's') {</span>
<span class="fc" id="L4672">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4674">        next();</span>

<span class="fc bfc" id="L4676" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4677">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4679">        next();</span>

<span class="pc bpc" id="L4681" title="1 of 24 branches missed.">        if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                || ch == '\f' || ch == '\b' || ch == ':' || ch == '/') {
<span class="fc" id="L4683">            token = JSONToken.FALSE;</span>
        } else {
<span class="fc" id="L4685">            throw new JSONException(&quot;scan false error&quot;);</span>
        }
<span class="fc" id="L4687">    }</span>

    public final void scanIdent() {
<span class="fc" id="L4690">        np = bp - 1;</span>
<span class="fc" id="L4691">        hasSpecial = false;</span>

        for (;;) {
<span class="fc" id="L4694">            sp++;</span>

<span class="fc" id="L4696">            next();</span>
<span class="fc bfc" id="L4697" title="All 2 branches covered.">            if (Character.isLetterOrDigit(ch)) {</span>
<span class="fc" id="L4698">                continue;</span>
            }

<span class="fc" id="L4701">            String ident = stringVal();</span>

<span class="fc bfc" id="L4703" title="All 2 branches covered.">            if (&quot;null&quot;.equalsIgnoreCase(ident)) {</span>
<span class="fc" id="L4704">                token = JSONToken.NULL;</span>
<span class="fc bfc" id="L4705" title="All 2 branches covered.">            } else if (&quot;new&quot;.equals(ident)) {</span>
<span class="fc" id="L4706">                token = JSONToken.NEW;</span>
<span class="fc bfc" id="L4707" title="All 2 branches covered.">            } else if (&quot;true&quot;.equals(ident)) {</span>
<span class="fc" id="L4708">                token = JSONToken.TRUE;</span>
<span class="fc bfc" id="L4709" title="All 2 branches covered.">            } else if (&quot;false&quot;.equals(ident)) {</span>
<span class="fc" id="L4710">                token = JSONToken.FALSE;</span>
<span class="fc bfc" id="L4711" title="All 2 branches covered.">            } else if (&quot;undefined&quot;.equals(ident)) {</span>
<span class="fc" id="L4712">                token = JSONToken.UNDEFINED;</span>
<span class="fc bfc" id="L4713" title="All 2 branches covered.">            } else if (&quot;Set&quot;.equals(ident)) {</span>
<span class="fc" id="L4714">                token = JSONToken.SET;</span>
<span class="fc bfc" id="L4715" title="All 2 branches covered.">            } else if (&quot;TreeSet&quot;.equals(ident)) {</span>
<span class="fc" id="L4716">                token = JSONToken.TREE_SET;</span>
            } else {
<span class="fc" id="L4718">                token = JSONToken.IDENTIFIER;</span>
            }
<span class="fc" id="L4720">            return;</span>
        }
    }

    public abstract String stringVal();

    public abstract String subString(int offset, int count);

    protected abstract char[] sub_chars(int offset, int count);

    public static String readString(char[] chars, int chars_len) {
<span class="fc" id="L4731">        char[] sbuf = new char[chars_len];</span>
<span class="fc" id="L4732">        int len = 0;</span>
<span class="fc bfc" id="L4733" title="All 2 branches covered.">        for (int i = 0; i &lt; chars_len; ++i) {</span>
<span class="fc" id="L4734">            char ch = chars[i];</span>

<span class="fc bfc" id="L4736" title="All 2 branches covered.">            if (ch != '\\') {</span>
<span class="fc" id="L4737">                sbuf[len++] = ch;</span>
<span class="fc" id="L4738">                continue;</span>
            }
<span class="fc" id="L4740">            ch = chars[++i];</span>

<span class="fc bfc" id="L4742" title="All 21 branches covered.">            switch (ch) {</span>
                case '0':
<span class="fc" id="L4744">                    sbuf[len++] = '\0';</span>
<span class="fc" id="L4745">                    break;</span>
                case '1':
<span class="fc" id="L4747">                    sbuf[len++] = '\1';</span>
<span class="fc" id="L4748">                    break;</span>
                case '2':
<span class="fc" id="L4750">                    sbuf[len++] = '\2';</span>
<span class="fc" id="L4751">                    break;</span>
                case '3':
<span class="fc" id="L4753">                    sbuf[len++] = '\3';</span>
<span class="fc" id="L4754">                    break;</span>
                case '4':
<span class="fc" id="L4756">                    sbuf[len++] = '\4';</span>
<span class="fc" id="L4757">                    break;</span>
                case '5':
<span class="fc" id="L4759">                    sbuf[len++] = '\5';</span>
<span class="fc" id="L4760">                    break;</span>
                case '6':
<span class="fc" id="L4762">                    sbuf[len++] = '\6';</span>
<span class="fc" id="L4763">                    break;</span>
                case '7':
<span class="fc" id="L4765">                    sbuf[len++] = '\7';</span>
<span class="fc" id="L4766">                    break;</span>
                case 'b': // 8
<span class="fc" id="L4768">                    sbuf[len++] = '\b';</span>
<span class="fc" id="L4769">                    break;</span>
                case 't': // 9
<span class="fc" id="L4771">                    sbuf[len++] = '\t';</span>
<span class="fc" id="L4772">                    break;</span>
                case 'n': // 10
<span class="fc" id="L4774">                    sbuf[len++] = '\n';</span>
<span class="fc" id="L4775">                    break;</span>
                case 'v': // 11
<span class="fc" id="L4777">                    sbuf[len++] = '\u000B';</span>
<span class="fc" id="L4778">                    break;</span>
                case 'f': // 12
                case 'F':
<span class="fc" id="L4781">                    sbuf[len++] = '\f';</span>
<span class="fc" id="L4782">                    break;</span>
                case 'r': // 13
<span class="fc" id="L4784">                    sbuf[len++] = '\r';</span>
<span class="fc" id="L4785">                    break;</span>
                case '&quot;': // 34
<span class="fc" id="L4787">                    sbuf[len++] = '&quot;';</span>
<span class="fc" id="L4788">                    break;</span>
                case '\'': // 39
<span class="fc" id="L4790">                    sbuf[len++] = '\'';</span>
<span class="fc" id="L4791">                    break;</span>
                case '/': // 47
<span class="fc" id="L4793">                    sbuf[len++] = '/';</span>
<span class="fc" id="L4794">                    break;</span>
                case '\\': // 92
<span class="fc" id="L4796">                    sbuf[len++] = '\\';</span>
<span class="fc" id="L4797">                    break;</span>
                case 'x':
<span class="fc" id="L4799">                    sbuf[len++] = (char) (digits[chars[++i]] * 16 + digits[chars[++i]]);</span>
<span class="fc" id="L4800">                    break;</span>
                case 'u':
<span class="fc" id="L4802">                    sbuf[len++] = (char) Integer.parseInt(new String(new char[] { chars[++i], //</span>
                                    chars[++i], //
                                    chars[++i], //
                                    chars[++i] }),
                            16);
<span class="fc" id="L4807">                    break;</span>
                default:
<span class="fc" id="L4809">                    throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
            }
        }
<span class="fc" id="L4812">        return new String(sbuf, 0, len);</span>
    }

    protected abstract boolean charArrayCompare(char[] chars);

    public boolean isBlankInput() {
<span class="fc" id="L4818">        for (int i = 0;; ++i) {</span>
<span class="fc" id="L4819">            char chLocal = charAt(i);</span>
<span class="fc bfc" id="L4820" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L4821">                token = JSONToken.EOF;</span>
<span class="fc" id="L4822">                break;</span>
            }

<span class="fc bfc" id="L4825" title="All 2 branches covered.">            if (!isWhitespace(chLocal)) {</span>
<span class="fc" id="L4826">                return false;</span>
            }
        }

<span class="fc" id="L4830">        return true;</span>
    }

    public final void skipWhitespace() {
        for (;;) {
<span class="fc bfc" id="L4835" title="All 2 branches covered.">            if (ch &lt;= '/') {</span>
<span class="pc bpc" id="L4836" title="3 of 12 branches missed.">                if (ch == ' ' || ch == '\r' || ch == '\n' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L4837">                    next();</span>
<span class="fc" id="L4838">                    continue;</span>
<span class="fc bfc" id="L4839" title="All 2 branches covered.">                } else if (ch == '/') {</span>
<span class="fc" id="L4840">                    skipComment();</span>
<span class="fc" id="L4841">                    continue;</span>
                } else {
                    break;
                }
            } else {
                break;
            }
        }
<span class="fc" id="L4849">    }</span>

    private void scanStringSingleQuote() {
<span class="fc" id="L4852">        np = bp;</span>
<span class="fc" id="L4853">        hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L4856">            chLocal = next();</span>

<span class="fc bfc" id="L4858" title="All 2 branches covered.">            if (chLocal == '\'') {</span>
<span class="fc" id="L4859">                break;</span>
            }

<span class="fc bfc" id="L4862" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc bfc" id="L4863" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L4864">                    putChar((char) EOI);</span>
<span class="fc" id="L4865">                    continue;</span>
                }
<span class="fc" id="L4867">                throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
            }

<span class="fc bfc" id="L4870" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L4871" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L4872">                    hasSpecial = true;</span>

<span class="pc bpc" id="L4874" title="1 of 2 branches missed.">                    if (sp &gt; sbuf.length) {</span>
<span class="nc" id="L4875">                        char[] newsbuf = new char[sp * 2];</span>
<span class="nc" id="L4876">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L4877">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(offset, offset + count, dest, 0);
<span class="fc" id="L4881">                    this.copyTo(np + 1, sp, sbuf);</span>
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L4885">                chLocal = next();</span>

<span class="fc bfc" id="L4887" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L4889">                        putChar('\0');</span>
<span class="fc" id="L4890">                        break;</span>
                    case '1':
<span class="fc" id="L4892">                        putChar('\1');</span>
<span class="fc" id="L4893">                        break;</span>
                    case '2':
<span class="fc" id="L4895">                        putChar('\2');</span>
<span class="fc" id="L4896">                        break;</span>
                    case '3':
<span class="fc" id="L4898">                        putChar('\3');</span>
<span class="fc" id="L4899">                        break;</span>
                    case '4':
<span class="fc" id="L4901">                        putChar('\4');</span>
<span class="fc" id="L4902">                        break;</span>
                    case '5':
<span class="fc" id="L4904">                        putChar('\5');</span>
<span class="fc" id="L4905">                        break;</span>
                    case '6':
<span class="fc" id="L4907">                        putChar('\6');</span>
<span class="fc" id="L4908">                        break;</span>
                    case '7':
<span class="fc" id="L4910">                        putChar('\7');</span>
<span class="fc" id="L4911">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L4913">                        putChar('\b');</span>
<span class="fc" id="L4914">                        break;</span>
                    case 't': // 9
<span class="fc" id="L4916">                        putChar('\t');</span>
<span class="fc" id="L4917">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L4919">                        putChar('\n');</span>
<span class="fc" id="L4920">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L4922">                        putChar('\u000B');</span>
<span class="fc" id="L4923">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L4926">                        putChar('\f');</span>
<span class="fc" id="L4927">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L4929">                        putChar('\r');</span>
<span class="fc" id="L4930">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L4932">                        putChar('&quot;');</span>
<span class="fc" id="L4933">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L4935">                        putChar('\'');</span>
<span class="fc" id="L4936">                        break;</span>
                    case '/': // 47
<span class="fc" id="L4938">                        putChar('/');</span>
<span class="fc" id="L4939">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L4941">                        putChar('\\');</span>
<span class="fc" id="L4942">                        break;</span>
                    case 'x':
<span class="fc" id="L4944">                        putChar((char) (digits[next()] * 16 + digits[next()]));</span>
<span class="fc" id="L4945">                        break;</span>
                    case 'u':
<span class="fc" id="L4947">                        putChar((char) Integer.parseInt(new String(new char[] { next(), next(), next(), next() }), 16));</span>
<span class="fc" id="L4948">                        break;</span>
                    default:
<span class="fc" id="L4950">                        this.ch = chLocal;</span>
<span class="fc" id="L4951">                        throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
                }
                continue;
            }

<span class="fc bfc" id="L4956" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L4957">                sp++;</span>
<span class="fc" id="L4958">                continue;</span>
            }

<span class="fc bfc" id="L4961" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L4962">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L4964">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L4968">        token = LITERAL_STRING;</span>
<span class="fc" id="L4969">        this.next();</span>
<span class="fc" id="L4970">    }</span>

    /**
     * Append a character to sbuf.
     */
    protected final void putChar(char ch) {
<span class="fc bfc" id="L4976" title="All 2 branches covered.">        if (sp == sbuf.length) {</span>
<span class="fc" id="L4977">            char[] newsbuf = new char[sbuf.length * 2];</span>
<span class="fc" id="L4978">            System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L4979">            sbuf = newsbuf;</span>
        }
<span class="fc" id="L4981">        sbuf[sp++] = ch;</span>
<span class="fc" id="L4982">    }</span>

    public final void scanHex() {
<span class="pc bpc" id="L4985" title="1 of 2 branches missed.">        if (ch != 'x') {</span>
<span class="nc" id="L4986">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }
<span class="fc" id="L4988">        next();</span>
<span class="pc bpc" id="L4989" title="1 of 2 branches missed.">        if (ch != '\'') {</span>
<span class="nc" id="L4990">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }

<span class="fc" id="L4993">        np = bp;</span>
<span class="fc" id="L4994">        next();</span>

<span class="fc bfc" id="L4996" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc" id="L4997">            next();</span>
<span class="fc" id="L4998">            token = JSONToken.HEX;</span>
<span class="fc" id="L4999">            return;</span>
        }

<span class="fc" id="L5002">        for (int i = 0;;++i) {</span>
<span class="fc" id="L5003">            char ch = next();</span>
<span class="pc bpc" id="L5004" title="1 of 8 branches missed.">            if ((ch &gt;= '0' &amp;&amp; ch &lt;= '9') || (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F')) {</span>
<span class="fc" id="L5005">                sp++;</span>
<span class="fc" id="L5006">                continue;</span>
<span class="pc bpc" id="L5007" title="1 of 2 branches missed.">            } else if (ch == '\'') {</span>
<span class="fc" id="L5008">                sp++;</span>
<span class="fc" id="L5009">                next();</span>
<span class="fc" id="L5010">                break;</span>
            } else {
<span class="nc" id="L5012">                throw new JSONException(&quot;illegal state. &quot; + ch);</span>
            }
        }
<span class="fc" id="L5015">        token = JSONToken.HEX;</span>
<span class="fc" id="L5016">    }</span>

    public final void scanNumber() {
<span class="fc" id="L5019">        np = bp;</span>

<span class="fc bfc" id="L5021" title="All 2 branches covered.">        if (ch == '-') {</span>
<span class="fc" id="L5022">            sp++;</span>
<span class="fc" id="L5023">            next();</span>
        }

        for (;;) {
<span class="fc bfc" id="L5027" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5028">                sp++;</span>
            } else {
                break;
            }
<span class="fc" id="L5032">            next();</span>
        }

<span class="fc" id="L5035">        boolean isDouble = false;</span>

<span class="fc bfc" id="L5037" title="All 2 branches covered.">        if (ch == '.') {</span>
<span class="fc" id="L5038">            sp++;</span>
<span class="fc" id="L5039">            next();</span>
<span class="fc" id="L5040">            isDouble = true;</span>

            for (;;) {
<span class="fc bfc" id="L5043" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5044">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5048">                next();</span>
            }
        }

<span class="fc bfc" id="L5052" title="All 2 branches covered.">        if (ch == 'L') {</span>
<span class="fc" id="L5053">            sp++;</span>
<span class="fc" id="L5054">            next();</span>
<span class="fc bfc" id="L5055" title="All 2 branches covered.">        } else if (ch == 'S') {</span>
<span class="fc" id="L5056">            sp++;</span>
<span class="fc" id="L5057">            next();</span>
<span class="fc bfc" id="L5058" title="All 2 branches covered.">        } else if (ch == 'B') {</span>
<span class="fc" id="L5059">            sp++;</span>
<span class="fc" id="L5060">            next();</span>
<span class="fc bfc" id="L5061" title="All 2 branches covered.">        } else if (ch == 'F') {</span>
<span class="fc" id="L5062">            sp++;</span>
<span class="fc" id="L5063">            next();</span>
<span class="fc" id="L5064">            isDouble = true;</span>
<span class="fc bfc" id="L5065" title="All 2 branches covered.">        } else if (ch == 'D') {</span>
<span class="fc" id="L5066">            sp++;</span>
<span class="fc" id="L5067">            next();</span>
<span class="fc" id="L5068">            isDouble = true;</span>
<span class="fc bfc" id="L5069" title="All 4 branches covered.">        } else if (ch == 'e' || ch == 'E') {</span>
<span class="fc" id="L5070">            sp++;</span>
<span class="fc" id="L5071">            next();</span>

<span class="fc bfc" id="L5073" title="All 4 branches covered.">            if (ch == '+' || ch == '-') {</span>
<span class="fc" id="L5074">                sp++;</span>
<span class="fc" id="L5075">                next();</span>
            }

            for (;;) {
<span class="fc bfc" id="L5079" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5080">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5084">                next();</span>
            }

<span class="fc bfc" id="L5087" title="All 4 branches covered.">            if (ch == 'D' || ch == 'F') {</span>
<span class="fc" id="L5088">                sp++;</span>
<span class="fc" id="L5089">                next();</span>
            }

<span class="fc" id="L5092">            isDouble = true;</span>
        }

<span class="fc bfc" id="L5095" title="All 2 branches covered.">        if (isDouble) {</span>
<span class="fc" id="L5096">            token = JSONToken.LITERAL_FLOAT;</span>
        } else {
<span class="fc" id="L5098">            token = JSONToken.LITERAL_INT;</span>
        }
<span class="fc" id="L5100">    }</span>

    public final long longValue() throws NumberFormatException {
<span class="fc" id="L5103">        long result = 0;</span>
<span class="fc" id="L5104">        boolean negative = false;</span>
        long limit;
        int digit;

<span class="pc bpc" id="L5108" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L5109">            np = 0;</span>
        }

<span class="fc" id="L5112">        int i = np, max = np + sp;</span>

<span class="fc bfc" id="L5114" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L5115">            negative = true;</span>
<span class="fc" id="L5116">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L5117">            i++;</span>
        } else {
<span class="fc" id="L5119">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L5121">        long multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L5122" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L5123">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L5124">            result = -digit;</span>
        }
<span class="fc bfc" id="L5126" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L5128">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L5130" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L5131">                break;</span>
            }

<span class="fc" id="L5134">            digit = chLocal - '0';</span>
<span class="fc bfc" id="L5135" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L5136">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5138">            result *= 10;</span>
<span class="fc bfc" id="L5139" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L5140">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5142">            result -= digit;</span>
<span class="fc" id="L5143">        }</span>

<span class="fc bfc" id="L5145" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L5146" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L5147">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L5149">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L5152">            return -result;</span>
        }
    }

    public final Number decimalValue(boolean decimal) {
<span class="fc" id="L5157">        char chLocal = charAt(np + sp - 1);</span>
        try {
<span class="fc bfc" id="L5159" title="All 2 branches covered.">            if (chLocal == 'F') {</span>
<span class="fc" id="L5160">                return Float.parseFloat(numberString());</span>
            }

<span class="fc bfc" id="L5163" title="All 2 branches covered.">            if (chLocal == 'D') {</span>
<span class="fc" id="L5164">                return Double.parseDouble(numberString());</span>
            }

<span class="fc bfc" id="L5167" title="All 2 branches covered.">            if (decimal) {</span>
<span class="fc" id="L5168">                return decimalValue();</span>
            } else {
<span class="fc" id="L5170">                return doubleValue();</span>
            }
<span class="fc" id="L5172">        } catch (NumberFormatException ex) {</span>
<span class="fc" id="L5173">            throw new JSONException(ex.getMessage() + &quot;, &quot; + info());</span>
        }
    }

    public abstract BigDecimal decimalValue();

    public static boolean isWhitespace(char ch) {
        // 专门调整了判断顺序
<span class="fc bfc" id="L5181" title="All 14 branches covered.">        return ch &lt;= ' ' &amp;&amp; (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b');</span>
    }

    protected static final long  MULTMIN_RADIX_TEN     = Long.MIN_VALUE / 10;
    protected static final int   INT_MULTMIN_RADIX_TEN = Integer.MIN_VALUE / 10;

<span class="fc" id="L5187">    protected final static int[] digits                = new int[(int) 'f' + 1];</span>

    static {
<span class="fc bfc" id="L5190" title="All 2 branches covered.">        for (int i = '0'; i &lt;= '9'; ++i) {</span>
<span class="fc" id="L5191">            digits[i] = i - '0';</span>
        }

<span class="fc bfc" id="L5194" title="All 2 branches covered.">        for (int i = 'a'; i &lt;= 'f'; ++i) {</span>
<span class="fc" id="L5195">            digits[i] = (i - 'a') + 10;</span>
        }
<span class="fc bfc" id="L5197" title="All 2 branches covered.">        for (int i = 'A'; i &lt;= 'F'; ++i) {</span>
<span class="fc" id="L5198">            digits[i] = (i - 'A') + 10;</span>
        }
<span class="fc" id="L5200">    }</span>

    /**
     * hsf support
     * @param fieldName
     * @param argTypesCount
     * @param typeSymbolTable
     * @return
     */
    public String[] scanFieldStringArray(char[] fieldName, int argTypesCount, SymbolTable typeSymbolTable) {
<span class="nc" id="L5210">        throw new UnsupportedOperationException();</span>
    }

    public boolean matchField2(char[] fieldName) {
<span class="nc" id="L5214">        throw new UnsupportedOperationException();</span>
    }

    public int getFeatures() {
<span class="fc" id="L5218">        return this.features;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>