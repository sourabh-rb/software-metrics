<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSONLexerBase.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fastjson</a> &gt; <a href="index.source.html" class="el_package">com.alibaba.fastjson.parser</a> &gt; <span class="el_source">JSONLexerBase.java</span></div><h1>JSONLexerBase.java</h1><pre class="source lang-java linenums">/*
 * Copyright 1999-2017 Alibaba Group.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.alibaba.fastjson.parser;

import java.io.Closeable;
import java.lang.reflect.Type;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.math.MathContext;
import java.util.*;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONException;
import com.alibaba.fastjson.annotation.JSONType;
import com.alibaba.fastjson.util.IOUtils;
import com.alibaba.fastjson.util.TypeUtils;

import static com.alibaba.fastjson.parser.JSONToken.*;

/**
 * @author wenshao[szujobs@hotmail.com]
 */
public abstract class JSONLexerBase implements JSONLexer, Closeable {

    protected void lexError(String key, Object... args) {
<span class="fc" id="L39">        token = ERROR;</span>
<span class="fc" id="L40">    }</span>

    protected int                            token;
    protected int                            pos;
    protected int                            features;

    protected char                           ch;
    protected int                            bp;

    protected int                            eofPos;

    /**
     * A character buffer for literals.
     */
    protected char[]                         sbuf;
    protected int                            sp;

    /**
     * number start position
     */
    protected int                            np;

    protected boolean                        hasSpecial;

<span class="fc" id="L64">    protected Calendar                       calendar           = null;</span>
<span class="fc" id="L65">    protected TimeZone                       timeZone           = JSON.defaultTimeZone;</span>
<span class="fc" id="L66">    protected Locale                         locale             = JSON.defaultLocale;</span>

<span class="fc" id="L68">    public int                               matchStat          = UNKNOWN;</span>

<span class="fc" id="L70">    private final static ThreadLocal&lt;char[]&gt; SBUF_LOCAL         = new ThreadLocal&lt;char[]&gt;();</span>

<span class="fc" id="L72">    protected String                         stringDefaultValue = null;</span>

<span class="fc" id="L74">    public JSONLexerBase(int features){</span>
<span class="fc" id="L75">        this.features = features;</span>

<span class="fc bfc" id="L77" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L78">            stringDefaultValue = &quot;&quot;;</span>
        }

<span class="fc" id="L81">        sbuf = SBUF_LOCAL.get();</span>

<span class="fc bfc" id="L83" title="All 2 branches covered.">        if (sbuf == null) {</span>
<span class="fc" id="L84">            sbuf = new char[512];</span>
        }
<span class="fc" id="L86">    }</span>

    public final int matchStat() {
<span class="fc" id="L89">        return matchStat;</span>
    }

    /**
     * internal method, don't invoke
     * @param token
     */
    public void setToken(int token) {
<span class="fc" id="L97">        this.token = token;</span>
<span class="fc" id="L98">    }</span>

    public final void nextToken() {
<span class="fc" id="L101">        sp = 0;</span>

        for (;;) {
<span class="fc" id="L104">            pos = bp;</span>

<span class="fc bfc" id="L106" title="All 2 branches covered.">            if (ch == '/') {</span>
<span class="fc" id="L107">                skipComment();</span>
<span class="fc" id="L108">                continue;</span>
            }

<span class="fc bfc" id="L111" title="All 2 branches covered.">            if (ch == '&quot;') {</span>
<span class="fc" id="L112">                scanString();</span>
<span class="fc" id="L113">                return;</span>
            }

<span class="fc bfc" id="L116" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L117">                next();</span>
<span class="fc" id="L118">                token = COMMA;</span>
<span class="fc" id="L119">                return;</span>
            }

<span class="fc bfc" id="L122" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L123">                scanNumber();</span>
<span class="fc" id="L124">                return;</span>
            }

<span class="fc bfc" id="L127" title="All 2 branches covered.">            if (ch == '-') {</span>
<span class="fc" id="L128">                scanNumber();</span>
<span class="fc" id="L129">                return;</span>
            }

<span class="fc bfc" id="L132" title="All 18 branches covered.">            switch (ch) {</span>
                case '\'':
<span class="fc bfc" id="L134" title="All 2 branches covered.">                    if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L135">                        throw new JSONException(&quot;Feature.AllowSingleQuotes is false&quot;);</span>
                    }
<span class="fc" id="L137">                    scanStringSingleQuote();</span>
<span class="fc" id="L138">                    return;</span>
                case ' ':
                case '\t':
                case '\b':
                case '\f':
                case '\n':
                case '\r':
<span class="fc" id="L145">                    next();</span>
<span class="fc" id="L146">                    break;</span>
                case 't': // true
<span class="fc" id="L148">                    scanTrue();</span>
<span class="fc" id="L149">                    return;</span>
                case 'f': // false
<span class="fc" id="L151">                    scanFalse();</span>
<span class="fc" id="L152">                    return;</span>
                case 'n': // new,null
<span class="fc" id="L154">                    scanNullOrNew();</span>
<span class="fc" id="L155">                    return;</span>
                case 'T':
                case 'N': // NULL
                case 'S':
                case 'u': // undefined
<span class="fc" id="L160">                    scanIdent();</span>
<span class="fc" id="L161">                    return;</span>
                case '(':
<span class="fc" id="L163">                    next();</span>
<span class="fc" id="L164">                    token = LPAREN;</span>
<span class="fc" id="L165">                    return;</span>
                case ')':
<span class="fc" id="L167">                    next();</span>
<span class="fc" id="L168">                    token = RPAREN;</span>
<span class="fc" id="L169">                    return;</span>
                case '[':
<span class="fc" id="L171">                    next();</span>
<span class="fc" id="L172">                    token = LBRACKET;</span>
<span class="fc" id="L173">                    return;</span>
                case ']':
<span class="fc" id="L175">                    next();</span>
<span class="fc" id="L176">                    token = RBRACKET;</span>
<span class="fc" id="L177">                    return;</span>
                case '{':
<span class="fc" id="L179">                    next();</span>
<span class="fc" id="L180">                    token = LBRACE;</span>
<span class="fc" id="L181">                    return;</span>
                case '}':
<span class="fc" id="L183">                    next();</span>
<span class="fc" id="L184">                    token = RBRACE;</span>
<span class="fc" id="L185">                    return;</span>
                case ':':
<span class="fc" id="L187">                    next();</span>
<span class="fc" id="L188">                    token = COLON;</span>
<span class="fc" id="L189">                    return;</span>
                case ';':
<span class="fc" id="L191">                    next();</span>
<span class="fc" id="L192">                    token = SEMI;</span>
<span class="fc" id="L193">                    return;</span>
                case '.':
<span class="fc" id="L195">                    next();</span>
<span class="fc" id="L196">                    token = DOT;</span>
<span class="fc" id="L197">                    return;</span>
                case '+':
<span class="fc" id="L199">                    next();</span>
<span class="fc" id="L200">                    scanNumber();</span>
<span class="fc" id="L201">                    return;</span>
                case 'x':
<span class="fc" id="L203">                    scanHex();</span>
<span class="fc" id="L204">                    return;</span>
                default:
<span class="fc bfc" id="L206" title="All 2 branches covered.">                    if (isEOF()) { // JLS</span>
<span class="fc bfc" id="L207" title="All 2 branches covered.">                        if (token == EOF) {</span>
<span class="fc" id="L208">                            throw new JSONException(&quot;EOF error&quot;);</span>
                        }

<span class="fc" id="L211">                        token = EOF;</span>
<span class="fc" id="L212">                        pos = bp = eofPos;</span>
                    } else {
<span class="fc bfc" id="L214" title="All 4 branches covered.">                        if (ch &lt;= 31 || ch == 127) {</span>
<span class="fc" id="L215">                            next();</span>
<span class="fc" id="L216">                            break;</span>
                        }

<span class="fc" id="L219">                        lexError(&quot;illegal.char&quot;, String.valueOf((int) ch));</span>
<span class="fc" id="L220">                        next();</span>
                    }

<span class="fc" id="L223">                    return;</span>
            }
        }

    }

    public final void nextToken(int expect) {
<span class="fc" id="L230">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L233" title="All 9 branches covered.">            switch (expect) {</span>
                case JSONToken.LBRACE:
<span class="fc bfc" id="L235" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L236">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L237">                        next();</span>
<span class="fc" id="L238">                        return;</span>
                    }
<span class="fc bfc" id="L240" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L241">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L242">                        next();</span>
<span class="fc" id="L243">                        return;</span>
                    }
                    break;
                case JSONToken.COMMA:
<span class="fc bfc" id="L247" title="All 2 branches covered.">                    if (ch == ',') {</span>
<span class="fc" id="L248">                        token = JSONToken.COMMA;</span>
<span class="fc" id="L249">                        next();</span>
<span class="fc" id="L250">                        return;</span>
                    }

<span class="fc bfc" id="L253" title="All 2 branches covered.">                    if (ch == '}') {</span>
<span class="fc" id="L254">                        token = JSONToken.RBRACE;</span>
<span class="fc" id="L255">                        next();</span>
<span class="fc" id="L256">                        return;</span>
                    }

<span class="fc bfc" id="L259" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L260">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L261">                        next();</span>
<span class="fc" id="L262">                        return;</span>
                    }

<span class="fc bfc" id="L265" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L266">                        token = JSONToken.EOF;</span>
<span class="fc" id="L267">                        return;</span>
                    }
                    break;
                case JSONToken.LITERAL_INT:
<span class="fc bfc" id="L271" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L272">                        pos = bp;</span>
<span class="fc" id="L273">                        scanNumber();</span>
<span class="fc" id="L274">                        return;</span>
                    }

<span class="fc bfc" id="L277" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L278">                        pos = bp;</span>
<span class="fc" id="L279">                        scanString();</span>
<span class="fc" id="L280">                        return;</span>
                    }

<span class="fc bfc" id="L283" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L284">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L285">                        next();</span>
<span class="fc" id="L286">                        return;</span>
                    }

<span class="fc bfc" id="L289" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L290">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L291">                        next();</span>
<span class="fc" id="L292">                        return;</span>
                    }

                    break;
                case JSONToken.LITERAL_STRING:
<span class="fc bfc" id="L297" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L298">                        pos = bp;</span>
<span class="fc" id="L299">                        scanString();</span>
<span class="fc" id="L300">                        return;</span>
                    }

<span class="fc bfc" id="L303" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L304">                        pos = bp;</span>
<span class="fc" id="L305">                        scanNumber();</span>
<span class="fc" id="L306">                        return;</span>
                    }

<span class="fc bfc" id="L309" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L310">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L311">                        next();</span>
<span class="fc" id="L312">                        return;</span>
                    }

<span class="fc bfc" id="L315" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L316">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L317">                        next();</span>
<span class="fc" id="L318">                        return;</span>
                    }
                    break;
                case JSONToken.LBRACKET:
<span class="fc bfc" id="L322" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L323">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L324">                        next();</span>
<span class="fc" id="L325">                        return;</span>
                    }

<span class="fc bfc" id="L328" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L329">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L330">                        next();</span>
<span class="fc" id="L331">                        return;</span>
                    }
                    break;
                case JSONToken.RBRACKET:
<span class="fc bfc" id="L335" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L336">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L337">                        next();</span>
<span class="fc" id="L338">                        return;</span>
                    }
                case JSONToken.EOF:
<span class="fc bfc" id="L341" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L342">                        token = JSONToken.EOF;</span>
<span class="fc" id="L343">                        return;</span>
                    }
                    break;
                case JSONToken.IDENTIFIER:
<span class="fc" id="L347">                    nextIdent();</span>
<span class="fc" id="L348">                    return;</span>
                default:
                    break;
            }

<span class="fc bfc" id="L353" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L354">                next();</span>
<span class="fc" id="L355">                continue;</span>
            }

<span class="fc" id="L358">            nextToken();</span>
<span class="fc" id="L359">            break;</span>
        }
<span class="fc" id="L361">    }</span>

    public final void nextIdent() {
<span class="fc bfc" id="L364" title="All 2 branches covered.">        while (isWhitespace(ch)) {</span>
<span class="fc" id="L365">            next();</span>
        }
<span class="fc bfc" id="L367" title="All 6 branches covered.">        if (ch == '_' || ch == '$' || Character.isLetter(ch)) {</span>
<span class="fc" id="L368">            scanIdent();</span>
        } else {
<span class="fc" id="L370">            nextToken();</span>
        }
<span class="fc" id="L372">    }</span>

    public final void nextTokenWithColon() {
<span class="fc" id="L375">        nextTokenWithChar(':');</span>
<span class="fc" id="L376">    }</span>

    public final void nextTokenWithChar(char expect) {
<span class="fc" id="L379">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L382" title="All 2 branches covered.">            if (ch == expect) {</span>
<span class="fc" id="L383">                next();</span>
<span class="fc" id="L384">                nextToken();</span>
<span class="fc" id="L385">                return;</span>
            }

<span class="fc bfc" id="L388" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L389">                next();</span>
<span class="fc" id="L390">                continue;</span>
            }

<span class="fc" id="L393">            throw new JSONException(&quot;not match &quot; + expect + &quot; - &quot; + ch + &quot;, info : &quot; + this.info());</span>
        }
    }

    public final int token() {
<span class="fc" id="L398">        return token;</span>
    }

    public final String tokenName() {
<span class="fc" id="L402">        return JSONToken.name(token);</span>
    }

    public final int pos() {
<span class="fc" id="L406">        return pos;</span>
    }

    public final String stringDefaultValue() {
<span class="fc" id="L410">        return stringDefaultValue;</span>
    }

    public final Number integerValue() throws NumberFormatException {
<span class="fc" id="L414">        long result = 0;</span>
<span class="fc" id="L415">        boolean negative = false;</span>
<span class="fc bfc" id="L416" title="All 2 branches covered.">        if (np == -1) {</span>
<span class="fc" id="L417">            np = 0;</span>
        }
<span class="fc" id="L419">        int i = np, max = np + sp;</span>
        long limit;
        long multmin;
        int digit;

<span class="fc" id="L424">        char type = ' ';</span>

<span class="fc bfc" id="L426" title="All 4 branches covered.">        switch (charAt(max - 1)) {</span>
            case 'L':
<span class="fc" id="L428">                max--;</span>
<span class="fc" id="L429">                type = 'L';</span>
<span class="fc" id="L430">                break;</span>
            case 'S':
<span class="fc" id="L432">                max--;</span>
<span class="fc" id="L433">                type = 'S';</span>
<span class="fc" id="L434">                break;</span>
            case 'B':
<span class="fc" id="L436">                max--;</span>
<span class="fc" id="L437">                type = 'B';</span>
<span class="fc" id="L438">                break;</span>
            default:
                break;
        }

<span class="fc bfc" id="L443" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L444">            negative = true;</span>
<span class="fc" id="L445">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L446">            i++;</span>
        } else {
<span class="fc" id="L448">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L450">        multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L451" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L452">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L453">            result = -digit;</span>
        }
<span class="fc bfc" id="L455" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L457">            digit = charAt(i++) - '0';</span>
<span class="fc bfc" id="L458" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L459">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L461">            result *= 10;</span>
<span class="fc bfc" id="L462" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L463">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L465">            result -= digit;</span>
        }

<span class="fc bfc" id="L468" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L469" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc bfc" id="L470" title="All 4 branches covered.">                if (result &gt;= Integer.MIN_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L471" title="All 2 branches covered.">                    if (type == 'S') {</span>
<span class="fc" id="L472">                        return (short) result;</span>
                    }

<span class="fc bfc" id="L475" title="All 2 branches covered.">                    if (type == 'B') {</span>
<span class="fc" id="L476">                        return (byte) result;</span>
                    }

<span class="fc" id="L479">                    return (int) result;</span>
                }
<span class="fc" id="L481">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L483">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L486">            result = -result;</span>
<span class="fc bfc" id="L487" title="All 4 branches covered.">            if (result &lt;= Integer.MAX_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L488" title="All 2 branches covered.">                if (type == 'S') {</span>
<span class="fc" id="L489">                    return (short) result;</span>
                }

<span class="fc bfc" id="L492" title="All 2 branches covered.">                if (type == 'B') {</span>
<span class="fc" id="L493">                    return (byte) result;</span>
                }

<span class="fc" id="L496">                return (int) result;</span>
            }
<span class="fc" id="L498">            return result;</span>
        }
    }

    public final void nextTokenWithColon(int expect) {
<span class="fc" id="L503">        nextTokenWithChar(':');</span>
<span class="fc" id="L504">    }</span>

    public float floatValue() {
<span class="fc" id="L507">        String strVal = numberString();</span>
<span class="fc" id="L508">        float floatValue = Float.parseFloat(strVal);</span>
<span class="fc bfc" id="L509" title="All 4 branches covered.">        if (floatValue == 0 || floatValue == Float.POSITIVE_INFINITY) {</span>
<span class="fc" id="L510">            char c0 = strVal.charAt(0);</span>
<span class="pc bpc" id="L511" title="1 of 4 branches missed.">            if (c0 &gt; '0' &amp;&amp; c0 &lt;= '9') {</span>
<span class="fc" id="L512">                throw new JSONException(&quot;float overflow : &quot; + strVal);</span>
            }
        }
<span class="fc" id="L515">        return floatValue;</span>
    }

    public double doubleValue() {
<span class="fc" id="L519">        return Double.parseDouble(numberString());</span>
    }

    public void config(Feature feature, boolean state) {
<span class="fc" id="L523">        features = Feature.config(features, feature, state);</span>

<span class="fc bfc" id="L525" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L526">            stringDefaultValue = &quot;&quot;;</span>
        }
<span class="fc" id="L528">    }</span>

    public final boolean isEnabled(Feature feature) {
<span class="fc" id="L531">        return isEnabled(feature.mask);</span>
    }

    public final boolean isEnabled(int feature) {
<span class="fc bfc" id="L535" title="All 2 branches covered.">        return (this.features &amp; feature) != 0;</span>
    }

    public final boolean isEnabled(int features, int feature) {
<span class="pc bpc" id="L539" title="1 of 4 branches missed.">        return (this.features &amp; feature) != 0 || (features &amp; feature) != 0;</span>
    }

    public abstract String numberString();

    public abstract boolean isEOF();

    public final char getCurrent() {
<span class="fc" id="L547">        return ch;</span>
    }

    public abstract char charAt(int index);

    // public final char next() {
    // ch = doNext();
    //// if (ch == '/' &amp;&amp; (this.features &amp; Feature.AllowComment.mask) != 0) {
    //// skipComment();
    //// }
    // return ch;
    // }

    public abstract char next();

    protected void skipComment() {
<span class="fc" id="L563">        next();</span>
<span class="fc bfc" id="L564" title="All 2 branches covered.">        if (ch == '/') {</span>
            for (;;) {
<span class="fc" id="L566">                next();</span>
<span class="fc bfc" id="L567" title="All 2 branches covered.">                if (ch == '\n') {</span>
<span class="fc" id="L568">                    next();</span>
<span class="fc" id="L569">                    return;</span>
<span class="fc bfc" id="L570" title="All 2 branches covered.">                } else if (ch == EOI) {</span>
<span class="fc" id="L571">                    return;</span>
                }
            }
<span class="fc bfc" id="L574" title="All 2 branches covered.">        } else if (ch == '*') {</span>
<span class="fc" id="L575">            next();</span>

<span class="pc bpc" id="L577" title="1 of 2 branches missed.">            for (; ch != EOI;) {</span>
<span class="fc bfc" id="L578" title="All 2 branches covered.">                if (ch == '*') {</span>
<span class="fc" id="L579">                    next();</span>
<span class="fc bfc" id="L580" title="All 2 branches covered.">                    if (ch == '/') {</span>
<span class="fc" id="L581">                        next();</span>
<span class="fc" id="L582">                        return;</span>
                    } else {
                        continue;
                    }
                }
<span class="fc" id="L587">                next();</span>
            }
        } else {
<span class="fc" id="L590">            throw new JSONException(&quot;invalid comment&quot;);</span>
        }
<span class="nc" id="L592">    }</span>

    public final String scanSymbol(final SymbolTable symbolTable) {
<span class="fc" id="L595">        skipWhitespace();</span>

<span class="fc bfc" id="L597" title="All 2 branches covered.">        if (ch == '&quot;') {</span>
<span class="fc" id="L598">            return scanSymbol(symbolTable, '&quot;');</span>
        }

<span class="fc bfc" id="L601" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc bfc" id="L602" title="All 2 branches covered.">            if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L603">                throw new JSONException(&quot;syntax error&quot;);</span>
            }

<span class="fc" id="L606">            return scanSymbol(symbolTable, '\'');</span>
        }

<span class="fc bfc" id="L609" title="All 2 branches covered.">        if (ch == '}') {</span>
<span class="fc" id="L610">            next();</span>
<span class="fc" id="L611">            token = JSONToken.RBRACE;</span>
<span class="fc" id="L612">            return null;</span>
        }

<span class="fc bfc" id="L615" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L616">            next();</span>
<span class="fc" id="L617">            token = JSONToken.COMMA;</span>
<span class="fc" id="L618">            return null;</span>
        }

<span class="fc bfc" id="L621" title="All 2 branches covered.">        if (ch == EOI) {</span>
<span class="fc" id="L622">            token = JSONToken.EOF;</span>
<span class="fc" id="L623">            return null;</span>
        }

<span class="fc bfc" id="L626" title="All 2 branches covered.">        if (!isEnabled(Feature.AllowUnQuotedFieldNames)) {</span>
<span class="fc" id="L627">            throw new JSONException(&quot;syntax error&quot;);</span>
        }

<span class="fc" id="L630">        return scanSymbolUnQuoted(symbolTable);</span>
    }

    // public abstract String scanSymbol(final SymbolTable symbolTable, final char quote);

    protected abstract void arrayCopy(int srcPos, char[] dest, int destPos, int length);

    public final String scanSymbol(final SymbolTable symbolTable, final char quote) {
<span class="fc" id="L638">        int hash = 0;</span>

<span class="fc" id="L640">        np = bp;</span>
<span class="fc" id="L641">        sp = 0;</span>
<span class="fc" id="L642">        boolean hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L645">            chLocal = next();</span>

<span class="fc bfc" id="L647" title="All 2 branches covered.">            if (chLocal == quote) {</span>
<span class="fc" id="L648">                break;</span>
            }

<span class="fc bfc" id="L651" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L652">                throw new JSONException(&quot;unclosed.str&quot;);</span>
            }

<span class="fc bfc" id="L655" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L656" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L657">                    hasSpecial = true;</span>

<span class="fc bfc" id="L659" title="All 2 branches covered.">                    if (sp &gt;= sbuf.length) {</span>
<span class="fc" id="L660">                        int newCapcity = sbuf.length * 2;</span>
<span class="pc bpc" id="L661" title="1 of 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L662">                            newCapcity = sp;</span>
                        }
<span class="fc" id="L664">                        char[] newsbuf = new char[newCapcity];</span>
<span class="fc" id="L665">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L666">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(this.buf, np + 1, sbuf, 0, sp);
<span class="fc" id="L671">                    arrayCopy(np + 1, sbuf, 0, sp);</span>
                }

<span class="fc" id="L674">                chLocal = next();</span>

<span class="fc bfc" id="L676" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L678">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L679">                        putChar('\0');</span>
<span class="fc" id="L680">                        break;</span>
                    case '1':
<span class="fc" id="L682">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L683">                        putChar('\1');</span>
<span class="fc" id="L684">                        break;</span>
                    case '2':
<span class="fc" id="L686">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L687">                        putChar('\2');</span>
<span class="fc" id="L688">                        break;</span>
                    case '3':
<span class="fc" id="L690">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L691">                        putChar('\3');</span>
<span class="fc" id="L692">                        break;</span>
                    case '4':
<span class="fc" id="L694">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L695">                        putChar('\4');</span>
<span class="fc" id="L696">                        break;</span>
                    case '5':
<span class="fc" id="L698">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L699">                        putChar('\5');</span>
<span class="fc" id="L700">                        break;</span>
                    case '6':
<span class="fc" id="L702">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L703">                        putChar('\6');</span>
<span class="fc" id="L704">                        break;</span>
                    case '7':
<span class="fc" id="L706">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L707">                        putChar('\7');</span>
<span class="fc" id="L708">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L710">                        hash = 31 * hash + (int) '\b';</span>
<span class="fc" id="L711">                        putChar('\b');</span>
<span class="fc" id="L712">                        break;</span>
                    case 't': // 9
<span class="fc" id="L714">                        hash = 31 * hash + (int) '\t';</span>
<span class="fc" id="L715">                        putChar('\t');</span>
<span class="fc" id="L716">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L718">                        hash = 31 * hash + (int) '\n';</span>
<span class="fc" id="L719">                        putChar('\n');</span>
<span class="fc" id="L720">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L722">                        hash = 31 * hash + (int) '\u000B';</span>
<span class="fc" id="L723">                        putChar('\u000B');</span>
<span class="fc" id="L724">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L727">                        hash = 31 * hash + (int) '\f';</span>
<span class="fc" id="L728">                        putChar('\f');</span>
<span class="fc" id="L729">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L731">                        hash = 31 * hash + (int) '\r';</span>
<span class="fc" id="L732">                        putChar('\r');</span>
<span class="fc" id="L733">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L735">                        hash = 31 * hash + (int) '&quot;';</span>
<span class="fc" id="L736">                        putChar('&quot;');</span>
<span class="fc" id="L737">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L739">                        hash = 31 * hash + (int) '\'';</span>
<span class="fc" id="L740">                        putChar('\'');</span>
<span class="fc" id="L741">                        break;</span>
                    case '/': // 47
<span class="fc" id="L743">                        hash = 31 * hash + (int) '/';</span>
<span class="fc" id="L744">                        putChar('/');</span>
<span class="fc" id="L745">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L747">                        hash = 31 * hash + (int) '\\';</span>
<span class="fc" id="L748">                        putChar('\\');</span>
<span class="fc" id="L749">                        break;</span>
                    case 'x':
<span class="fc" id="L751">                        char x1 = ch = next();</span>
<span class="fc" id="L752">                        char x2 = ch = next();</span>

<span class="fc" id="L754">                        int x_val = digits[x1] * 16 + digits[x2];</span>
<span class="fc" id="L755">                        char x_char = (char) x_val;</span>
<span class="fc" id="L756">                        hash = 31 * hash + (int) x_char;</span>
<span class="fc" id="L757">                        putChar(x_char);</span>
<span class="fc" id="L758">                        break;</span>
                    case 'u':
<span class="fc" id="L760">                        char c1 = chLocal = next();</span>
<span class="fc" id="L761">                        char c2 = chLocal = next();</span>
<span class="fc" id="L762">                        char c3 = chLocal = next();</span>
<span class="fc" id="L763">                        char c4 = chLocal = next();</span>
<span class="fc" id="L764">                        int val = Integer.parseInt(new String(new char[] { c1, c2, c3, c4 }), 16);</span>
<span class="fc" id="L765">                        hash = 31 * hash + val;</span>
<span class="fc" id="L766">                        putChar((char) val);</span>
<span class="fc" id="L767">                        break;</span>
                    default:
<span class="fc" id="L769">                        this.ch = chLocal;</span>
<span class="fc" id="L770">                        throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
                }
                continue;
            }

<span class="fc" id="L775">            hash = 31 * hash + chLocal;</span>

<span class="fc bfc" id="L777" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L778">                sp++;</span>
<span class="fc" id="L779">                continue;</span>
            }

<span class="fc bfc" id="L782" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L783">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L785">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L789">        token = LITERAL_STRING;</span>

        String value;
<span class="fc bfc" id="L792" title="All 2 branches covered.">        if (!hasSpecial) {</span>
            // return this.text.substring(np + 1, np + 1 + sp).intern();
            int offset;
<span class="pc bpc" id="L795" title="1 of 2 branches missed.">            if (np == -1) {</span>
<span class="nc" id="L796">                offset = 0;</span>
            } else {
<span class="fc" id="L798">                offset = np + 1;</span>
            }
<span class="fc" id="L800">            value = addSymbol(offset, sp, hash, symbolTable);</span>
<span class="fc" id="L801">        } else {</span>
<span class="fc" id="L802">            value = symbolTable.addSymbol(sbuf, 0, sp, hash);</span>
        }

<span class="fc" id="L805">        sp = 0;</span>
<span class="fc" id="L806">        this.next();</span>

<span class="fc" id="L808">        return value;</span>
    }

    public final void resetStringPosition() {
<span class="fc" id="L812">        this.sp = 0;</span>
<span class="fc" id="L813">    }</span>

    public String info() {
<span class="fc" id="L816">        return &quot;&quot;;</span>
    }

    public final String scanSymbolUnQuoted(final SymbolTable symbolTable) {
<span class="pc bpc" id="L820" title="2 of 6 branches missed.">        if (token == JSONToken.ERROR &amp;&amp; pos == 0 &amp;&amp; bp == 1) {</span>
<span class="fc" id="L821">            bp = 0; // adjust</span>
        }
<span class="fc" id="L823">        final boolean[] firstIdentifierFlags = IOUtils.firstIdentifierFlags;</span>
<span class="fc" id="L824">        final char first = ch;</span>

<span class="pc bpc" id="L826" title="1 of 4 branches missed.">        final boolean firstFlag = ch &gt;= firstIdentifierFlags.length || firstIdentifierFlags[first];</span>
<span class="fc bfc" id="L827" title="All 2 branches covered.">        if (!firstFlag) {</span>
<span class="fc" id="L828">            throw new JSONException(&quot;illegal identifier : &quot; + ch //</span>
<span class="fc" id="L829">                    + info());</span>
        }

<span class="fc" id="L832">        final boolean[] identifierFlags = IOUtils.identifierFlags;</span>

<span class="fc" id="L834">        int hash = first;</span>

<span class="fc" id="L836">        np = bp;</span>
<span class="fc" id="L837">        sp = 1;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L840">            chLocal = next();</span>

<span class="pc bpc" id="L842" title="1 of 2 branches missed.">            if (chLocal &lt; identifierFlags.length) {</span>
<span class="fc bfc" id="L843" title="All 2 branches covered.">                if (!identifierFlags[chLocal]) {</span>
<span class="fc" id="L844">                    break;</span>
                }
            }

<span class="fc" id="L848">            hash = 31 * hash + chLocal;</span>

<span class="fc" id="L850">            sp++;</span>
<span class="fc" id="L851">            continue;</span>
        }

<span class="fc" id="L854">        this.ch = charAt(bp);</span>
<span class="fc" id="L855">        token = JSONToken.IDENTIFIER;</span>

<span class="fc" id="L857">        final int NULL_HASH = 3392903;</span>
<span class="pc bpc" id="L858" title="3 of 10 branches missed.">        if (sp == 4 &amp;&amp; hash == NULL_HASH &amp;&amp; charAt(np) == 'n' &amp;&amp; charAt(np + 1) == 'u' &amp;&amp; charAt(np + 2) == 'l'</span>
<span class="pc bpc" id="L859" title="1 of 2 branches missed.">                &amp;&amp; charAt(np + 3) == 'l') {</span>
<span class="fc" id="L860">            return null;</span>
        }

        // return text.substring(np, np + sp).intern();

<span class="pc bpc" id="L865" title="1 of 2 branches missed.">        if (symbolTable == null) {</span>
<span class="nc" id="L866">            return subString(np, sp);</span>
        }

<span class="fc" id="L869">        return this.addSymbol(np, sp, hash, symbolTable);</span>
        // return symbolTable.addSymbol(buf, np, sp, hash);
    }

    protected abstract void copyTo(int offset, int count, char[] dest);

    public final void scanString() {
<span class="fc" id="L876">        np = bp;</span>
<span class="fc" id="L877">        hasSpecial = false;</span>
        char ch;
        for (;;) {
<span class="fc" id="L880">            ch = next();</span>

<span class="fc bfc" id="L882" title="All 2 branches covered.">            if (ch == '\&quot;') {</span>
<span class="fc" id="L883">                break;</span>
            }

<span class="fc bfc" id="L886" title="All 2 branches covered.">            if (ch == EOI) {</span>
<span class="fc bfc" id="L887" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L888">                    putChar((char) EOI);</span>
<span class="fc" id="L889">                    continue;</span>
                }
<span class="fc" id="L891">                throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
            }

<span class="fc bfc" id="L894" title="All 2 branches covered.">            if (ch == '\\') {</span>
<span class="fc bfc" id="L895" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L896">                    hasSpecial = true;</span>

<span class="pc bpc" id="L898" title="1 of 2 branches missed.">                    if (sp &gt;= sbuf.length) {</span>
<span class="nc" id="L899">                        int newCapcity = sbuf.length * 2;</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L901">                            newCapcity = sp;</span>
                        }
<span class="nc" id="L903">                        char[] newsbuf = new char[newCapcity];</span>
<span class="nc" id="L904">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L905">                        sbuf = newsbuf;</span>
                    }

<span class="fc" id="L908">                    copyTo(np + 1, sp, sbuf);</span>
                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L913">                ch = next();</span>

<span class="fc bfc" id="L915" title="All 21 branches covered.">                switch (ch) {</span>
                    case '0':
<span class="fc" id="L917">                        putChar('\0');</span>
<span class="fc" id="L918">                        break;</span>
                    case '1':
<span class="fc" id="L920">                        putChar('\1');</span>
<span class="fc" id="L921">                        break;</span>
                    case '2':
<span class="fc" id="L923">                        putChar('\2');</span>
<span class="fc" id="L924">                        break;</span>
                    case '3':
<span class="fc" id="L926">                        putChar('\3');</span>
<span class="fc" id="L927">                        break;</span>
                    case '4':
<span class="fc" id="L929">                        putChar('\4');</span>
<span class="fc" id="L930">                        break;</span>
                    case '5':
<span class="fc" id="L932">                        putChar('\5');</span>
<span class="fc" id="L933">                        break;</span>
                    case '6':
<span class="fc" id="L935">                        putChar('\6');</span>
<span class="fc" id="L936">                        break;</span>
                    case '7':
<span class="fc" id="L938">                        putChar('\7');</span>
<span class="fc" id="L939">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L941">                        putChar('\b');</span>
<span class="fc" id="L942">                        break;</span>
                    case 't': // 9
<span class="fc" id="L944">                        putChar('\t');</span>
<span class="fc" id="L945">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L947">                        putChar('\n');</span>
<span class="fc" id="L948">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L950">                        putChar('\u000B');</span>
<span class="fc" id="L951">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L954">                        putChar('\f');</span>
<span class="fc" id="L955">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L957">                        putChar('\r');</span>
<span class="fc" id="L958">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L960">                        putChar('&quot;');</span>
<span class="fc" id="L961">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L963">                        putChar('\'');</span>
<span class="fc" id="L964">                        break;</span>
                    case '/': // 47
<span class="fc" id="L966">                        putChar('/');</span>
<span class="fc" id="L967">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L969">                        putChar('\\');</span>
<span class="fc" id="L970">                        break;</span>
                    case 'x':
<span class="fc" id="L972">                        char x1 = ch = next();</span>
<span class="fc" id="L973">                        char x2 = ch = next();</span>

<span class="fc" id="L975">                        int x_val = digits[x1] * 16 + digits[x2];</span>
<span class="fc" id="L976">                        char x_char = (char) x_val;</span>
<span class="fc" id="L977">                        putChar(x_char);</span>
<span class="fc" id="L978">                        break;</span>
                    case 'u':
<span class="fc" id="L980">                        char u1 = ch = next();</span>
<span class="fc" id="L981">                        char u2 = ch = next();</span>
<span class="fc" id="L982">                        char u3 = ch = next();</span>
<span class="fc" id="L983">                        char u4 = ch = next();</span>
<span class="fc" id="L984">                        int val = Integer.parseInt(new String(new char[] { u1, u2, u3, u4 }), 16);</span>
<span class="fc" id="L985">                        putChar((char) val);</span>
<span class="fc" id="L986">                        break;</span>
                    default:
<span class="fc" id="L988">                        this.ch = ch;</span>
<span class="fc" id="L989">                        throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
                }
                continue;
            }

<span class="fc bfc" id="L994" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L995">                sp++;</span>
<span class="fc" id="L996">                continue;</span>
            }

<span class="fc bfc" id="L999" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L1000">                putChar(ch);</span>
            } else {
<span class="fc" id="L1002">                sbuf[sp++] = ch;</span>
            }
        }

<span class="fc" id="L1006">        token = JSONToken.LITERAL_STRING;</span>
<span class="fc" id="L1007">        this.ch = next();</span>
<span class="fc" id="L1008">    }</span>

    public Calendar getCalendar() {
<span class="fc" id="L1011">        return this.calendar;</span>
    }

    public TimeZone getTimeZone() {
<span class="fc" id="L1015">        return timeZone;</span>
    }

    public void setTimeZone(TimeZone timeZone) {
<span class="fc" id="L1019">        this.timeZone = timeZone;</span>
<span class="fc" id="L1020">    }</span>

    public Locale getLocale() {
<span class="fc" id="L1023">        return locale;</span>
    }

    public void setLocale(Locale locale) {
<span class="fc" id="L1027">        this.locale = locale;</span>
<span class="fc" id="L1028">    }</span>

    public final int intValue() {
<span class="pc bpc" id="L1031" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L1032">            np = 0;</span>
        }

<span class="fc" id="L1035">        int result = 0;</span>
<span class="fc" id="L1036">        boolean negative = false;</span>
<span class="fc" id="L1037">        int i = np, max = np + sp;</span>
        int limit;
        int digit;

<span class="fc bfc" id="L1041" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L1042">            negative = true;</span>
<span class="fc" id="L1043">            limit = Integer.MIN_VALUE;</span>
<span class="fc" id="L1044">            i++;</span>
        } else {
<span class="fc" id="L1046">            limit = -Integer.MAX_VALUE;</span>
        }
<span class="fc" id="L1048">        long multmin = INT_MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L1049" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L1050">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L1051">            result = -digit;</span>
        }
<span class="fc bfc" id="L1053" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L1055">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L1057" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L1058">                break;</span>
            }

<span class="fc" id="L1061">            digit = chLocal - '0';</span>

<span class="fc bfc" id="L1063" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L1064">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1066">            result *= 10;</span>
<span class="fc bfc" id="L1067" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L1068">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1070">            result -= digit;</span>
<span class="fc" id="L1071">        }</span>

<span class="fc bfc" id="L1073" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L1074" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L1075">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L1077">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L1080">            return -result;</span>
        }
    }

    public abstract byte[] bytesValue();

    public void close() {
<span class="fc bfc" id="L1087" title="All 2 branches covered.">        if (sbuf.length &lt;= 1024 * 8) {</span>
<span class="fc" id="L1088">            SBUF_LOCAL.set(sbuf);</span>
        }
<span class="fc" id="L1090">        this.sbuf = null;</span>
<span class="fc" id="L1091">    }</span>

    public final boolean isRef() {
<span class="fc bfc" id="L1094" title="All 2 branches covered.">        if (sp != 4) {</span>
<span class="fc" id="L1095">            return false;</span>
        }

<span class="fc bfc" id="L1098" title="All 2 branches covered.">        return charAt(np + 1) == '$' //</span>
<span class="fc bfc" id="L1099" title="All 2 branches covered.">                &amp;&amp; charAt(np + 2) == 'r' //</span>
<span class="fc bfc" id="L1100" title="All 2 branches covered.">                &amp;&amp; charAt(np + 3) == 'e' //</span>
<span class="fc bfc" id="L1101" title="All 2 branches covered.">                &amp;&amp; charAt(np + 4) == 'f';</span>
    }

<span class="fc" id="L1104">    protected final static char[] typeFieldName = (&quot;\&quot;&quot; + JSON.DEFAULT_TYPE_KEY + &quot;\&quot;:\&quot;&quot;).toCharArray();</span>

    public final int scanType(String type) {
<span class="fc" id="L1107">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1109" title="All 2 branches covered.">        if (!charArrayCompare(typeFieldName)) {</span>
<span class="fc" id="L1110">            return NOT_MATCH_NAME;</span>
        }

<span class="fc" id="L1113">        int bpLocal = this.bp + typeFieldName.length;</span>

<span class="fc" id="L1115">        final int typeLength = type.length();</span>
<span class="fc bfc" id="L1116" title="All 2 branches covered.">        for (int i = 0; i &lt; typeLength; ++i) {</span>
<span class="fc bfc" id="L1117" title="All 2 branches covered.">            if (type.charAt(i) != charAt(bpLocal + i)) {</span>
<span class="fc" id="L1118">                return NOT_MATCH;</span>
            }
        }
<span class="fc" id="L1121">        bpLocal += typeLength;</span>
<span class="fc bfc" id="L1122" title="All 2 branches covered.">        if (charAt(bpLocal) != '&quot;') {</span>
<span class="fc" id="L1123">            return NOT_MATCH;</span>
        }

<span class="fc" id="L1126">        this.ch = charAt(++bpLocal);</span>

<span class="fc bfc" id="L1128" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L1129">            this.ch = charAt(++bpLocal);</span>
<span class="fc" id="L1130">            this.bp = bpLocal;</span>
<span class="fc" id="L1131">            token = JSONToken.COMMA;</span>
<span class="fc" id="L1132">            return VALUE;</span>
<span class="pc bpc" id="L1133" title="1 of 2 branches missed.">        } else if (ch == '}') {</span>
<span class="fc" id="L1134">            ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1135" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L1136">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1137">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1138" title="All 2 branches covered.">            } else if (ch == ']') {</span>
<span class="fc" id="L1139">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1140">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1141" title="All 2 branches covered.">            } else if (ch == '}') {</span>
<span class="fc" id="L1142">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1143">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1144" title="All 2 branches covered.">            } else if (ch == EOI) {</span>
<span class="fc" id="L1145">                token = JSONToken.EOF;</span>
            } else {
<span class="fc" id="L1147">                return NOT_MATCH;</span>
            }
<span class="fc" id="L1149">            matchStat = END;</span>
        }

<span class="fc" id="L1152">        this.bp = bpLocal;</span>
<span class="fc" id="L1153">        return matchStat;</span>
    }

    public final boolean matchField(char[] fieldName) {
        for (;;) {
<span class="fc bfc" id="L1158" title="All 2 branches covered.">            if (!charArrayCompare(fieldName)) {</span>
<span class="fc bfc" id="L1159" title="All 2 branches covered.">                if (isWhitespace(ch)) {</span>
<span class="fc" id="L1160">                    next();</span>
<span class="fc" id="L1161">                    continue;</span>
                }
<span class="fc" id="L1163">                return false;</span>
            } else {
                break;
            }
        }

<span class="fc" id="L1169">        bp = bp + fieldName.length;</span>
<span class="fc" id="L1170">        ch = charAt(bp);</span>

<span class="fc bfc" id="L1172" title="All 2 branches covered.">        if (ch == '{') {</span>
<span class="fc" id="L1173">            next();</span>
<span class="fc" id="L1174">            token = JSONToken.LBRACE;</span>
<span class="fc bfc" id="L1175" title="All 2 branches covered.">        } else if (ch == '[') {</span>
<span class="fc" id="L1176">            next();</span>
<span class="fc" id="L1177">            token = JSONToken.LBRACKET;</span>
<span class="pc bpc" id="L1178" title="3 of 8 branches missed.">        } else if (ch == 'S' &amp;&amp; charAt(bp + 1) == 'e' &amp;&amp; charAt(bp + 2) == 't' &amp;&amp; charAt(bp + 3) == '[') {</span>
<span class="fc" id="L1179">            bp += 3;</span>
<span class="fc" id="L1180">            ch = charAt(bp);</span>
<span class="fc" id="L1181">            token = JSONToken.SET;</span>
        } else {
<span class="fc" id="L1183">            nextToken();</span>
        }

<span class="fc" id="L1186">        return true;</span>
    }

    public abstract int indexOf(char ch, int startIndex);

    public abstract String addSymbol(int offset, int len, int hash, final SymbolTable symbolTable);

    public String scanFieldString(char[] fieldName) {
<span class="fc" id="L1194">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1196" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1197">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1198">            return stringDefaultValue();</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1203">        int offset = fieldName.length;</span>
<span class="fc" id="L1204">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1206" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1207">            matchStat = NOT_MATCH;</span>

<span class="fc" id="L1209">            return stringDefaultValue();</span>
        }

        final String strVal;
        {
<span class="fc" id="L1214">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L1215">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1216" title="All 2 branches covered.">            if (endIndex == -1) {</span>
<span class="fc" id="L1217">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L1220">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L1221">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1222" title="All 2 branches covered.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="fc" id="L1224">                    int slashCount = 0;</span>
<span class="pc bpc" id="L1225" title="1 of 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1226" title="All 2 branches covered.">                        if (charAt(i) == '\\') {</span>
<span class="fc" id="L1227">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="fc bfc" id="L1232" title="All 2 branches covered.">                    if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1233">                        break;</span>
                    }
<span class="fc" id="L1235">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1236">                }</span>

<span class="fc" id="L1238">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="fc" id="L1239">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="fc" id="L1241">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L1244">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L1245">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1246">            strVal = stringVal;</span>
        }

<span class="fc bfc" id="L1249" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1250">            bp += offset;</span>
<span class="fc" id="L1251">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1252">            matchStat = VALUE;</span>
<span class="fc" id="L1253">            return strVal;</span>
        }

<span class="pc bpc" id="L1256" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L1257">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1258" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1259">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1260">                bp += offset;</span>
<span class="fc" id="L1261">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1262" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1263">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1264">                bp += offset;</span>
<span class="fc" id="L1265">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1266" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1267">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1268">                bp += offset;</span>
<span class="fc" id="L1269">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1270" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1271">                token = JSONToken.EOF;</span>
<span class="fc" id="L1272">                bp += (offset - 1);</span>
<span class="fc" id="L1273">                ch = EOI;</span>
            } else {
<span class="fc" id="L1275">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1276">                return stringDefaultValue();</span>
            }
<span class="fc" id="L1278">            matchStat = END;</span>
        } else {
<span class="nc" id="L1280">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1281">            return stringDefaultValue();</span>
        }

<span class="fc" id="L1284">        return strVal;</span>
    }

    public String scanString(char expectNextChar) {
<span class="fc" id="L1288">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1290">        int offset = 0;</span>
<span class="fc" id="L1291">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1293" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1294" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1295">                offset += 3;</span>
<span class="fc" id="L1296">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1298">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1299">                return null;</span>
            }

<span class="fc bfc" id="L1302" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1303">                bp += offset;</span>
<span class="fc" id="L1304">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1305">                matchStat = VALUE;</span>
<span class="fc" id="L1306">                return null;</span>
            } else {
<span class="fc" id="L1308">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1309">                return null;</span>
            }
        }



        final String strVal;
        for (;;) {
<span class="fc bfc" id="L1317" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1318">                int startIndex = bp + offset;</span>
<span class="fc" id="L1319">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1320" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1321">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1324">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1325" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (; ; ) {
<span class="fc" id="L1327">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1328" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1329" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1330">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1335" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1336">                            break;</span>
                        }
<span class="fc" id="L1338">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1339">                    }</span>

<span class="fc" id="L1341">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1342">                    char[] chars = sub_chars(bp + 1, chars_len);</span>

<span class="fc" id="L1344">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1347">                offset += (endIndex - startIndex + 1);</span>
<span class="fc" id="L1348">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1349">                strVal = stringVal;</span>
<span class="fc" id="L1350">                break;</span>
<span class="pc bpc" id="L1351" title="1 of 2 branches missed.">            } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L1352">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1353">                continue;</span>
            } else {
<span class="fc" id="L1355">                matchStat = NOT_MATCH;</span>

<span class="fc" id="L1357">                return stringDefaultValue();</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1362" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1363">                bp += offset;</span>
<span class="fc" id="L1364">                this.ch = charAt(bp);</span>
<span class="fc" id="L1365">                matchStat = VALUE;</span>
<span class="fc" id="L1366">                return strVal;</span>
<span class="pc bpc" id="L1367" title="1 of 2 branches missed.">            } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L1368">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1369">                continue;</span>
            } else {
<span class="fc" id="L1371">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1372">                return strVal;</span>
            }
        }
    }

    public long scanFieldSymbol(char[] fieldName) {
<span class="fc" id="L1378">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1380" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1381">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1382">            return 0;</span>
        }

<span class="fc" id="L1385">        int offset = fieldName.length;</span>
<span class="fc" id="L1386">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1388" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1389">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1390">            return 0;</span>
        }

<span class="fc" id="L1393">        long hash = 0xcbf29ce484222325L;</span>
        for (;;) {
<span class="fc" id="L1395">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1396" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
<span class="fc" id="L1397">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1398">                break;</span>
            }

<span class="fc" id="L1401">            hash ^= chLocal;</span>
<span class="fc" id="L1402">            hash *= 0x100000001b3L;</span>

<span class="fc bfc" id="L1404" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc" id="L1405">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1406">                return 0;</span>
            }
        }

<span class="fc bfc" id="L1410" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1411">            bp += offset;</span>
<span class="fc" id="L1412">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1413">            matchStat = VALUE;</span>
<span class="fc" id="L1414">            return hash;</span>
        }

<span class="fc bfc" id="L1417" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1418">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1419" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1420">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1421">                bp += offset;</span>
<span class="fc" id="L1422">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1423" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1424">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1425">                bp += offset;</span>
<span class="fc" id="L1426">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L1427" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L1428">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L1429">                bp += offset;</span>
<span class="nc" id="L1430">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1431" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1432">                token = JSONToken.EOF;</span>
<span class="fc" id="L1433">                bp += (offset - 1);</span>
<span class="fc" id="L1434">                ch = EOI;</span>
            } else {
<span class="fc" id="L1436">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1437">                return 0;</span>
            }
<span class="fc" id="L1439">            matchStat = END;</span>
        } else {
<span class="fc" id="L1441">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1442">            return 0;</span>
        }

<span class="fc" id="L1445">        return hash;</span>
    }

    @SuppressWarnings({ &quot;unchecked&quot;, &quot;rawtypes&quot; })
    public Enum&lt;?&gt; scanEnum(Class&lt;?&gt; enumClass, final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1450">        String name = scanSymbolWithSeperator(symbolTable, serperator);</span>
<span class="fc bfc" id="L1451" title="All 2 branches covered.">        if (name == null) {</span>
<span class="fc" id="L1452">            return null;</span>
        }
<span class="fc" id="L1454">        return Enum.valueOf((Class&lt;? extends Enum&gt;) enumClass, name);</span>
    }

    public String scanSymbolWithSeperator(final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1458">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1460">        int offset = 0;</span>
<span class="fc" id="L1461">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1463" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1464" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1465">                offset += 3;</span>
<span class="fc" id="L1466">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1468">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1469">                return null;</span>
            }

<span class="fc bfc" id="L1472" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1473">                bp += offset;</span>
<span class="fc" id="L1474">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1475">                matchStat = VALUE;</span>
<span class="fc" id="L1476">                return null;</span>
            } else {
<span class="fc" id="L1478">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1479">                return null;</span>
            }
        }

<span class="fc bfc" id="L1483" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1484">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1485">            return null;</span>
        }

        String strVal;
        // int start = index;
<span class="fc" id="L1490">        int hash = 0;</span>
        for (;;) {
<span class="fc" id="L1492">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1493" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
                // bp = index;
                // this.ch = chLocal = charAt(bp);
<span class="fc" id="L1496">                int start = bp + 0 + 1;</span>
<span class="fc" id="L1497">                int len = bp + offset - start - 1;</span>
<span class="fc" id="L1498">                strVal = addSymbol(start, len, hash, symbolTable);</span>
<span class="fc" id="L1499">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1500">                break;</span>
            }

<span class="fc" id="L1503">            hash = 31 * hash + chLocal;</span>

<span class="pc bpc" id="L1505" title="1 of 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1506">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1507">                return null;</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1512" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1513">                bp += offset;</span>
<span class="fc" id="L1514">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1515">                matchStat = VALUE;</span>
<span class="fc" id="L1516">                return strVal;</span>
            } else {
<span class="pc bpc" id="L1518" title="1 of 2 branches missed.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1519">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1520">                    continue;</span>
                }

<span class="nc" id="L1523">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1524">                return strVal;</span>
            }
        }
    }

    public Collection&lt;String&gt; newCollectionByType(Class&lt;?&gt; type){
<span class="fc bfc" id="L1530" title="All 2 branches covered.">        if (type.isAssignableFrom(HashSet.class)) {</span>
<span class="fc" id="L1531">            HashSet&lt;String&gt; list = new HashSet&lt;String&gt;();</span>
<span class="fc" id="L1532">            return list;</span>
<span class="fc bfc" id="L1533" title="All 2 branches covered.">        } else if (type.isAssignableFrom(ArrayList.class)) {</span>
<span class="fc" id="L1534">            ArrayList&lt;String&gt; list2 = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L1535">            return list2;</span>
        } else {
            try {
<span class="fc" id="L1538">                Collection&lt;String&gt; list = (Collection&lt;String&gt;) type.newInstance();</span>
<span class="fc" id="L1539">                return list;</span>
<span class="fc" id="L1540">            } catch (Exception e) {</span>
<span class="fc" id="L1541">                throw new JSONException(e.getMessage(), e);</span>
            }
        }
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    public Collection&lt;String&gt; scanFieldStringArray(char[] fieldName, Class&lt;?&gt; type) {
<span class="fc" id="L1548">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1550" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1551">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1552">            return null;</span>
        }

<span class="fc" id="L1555">        Collection&lt;String&gt; list = newCollectionByType(type);</span>

//        if (type.isAssignableFrom(HashSet.class)) {
//            list = new HashSet&lt;String&gt;();
//        } else if (type.isAssignableFrom(ArrayList.class)) {
//            list = new ArrayList&lt;String&gt;();
//        } else {
//            try {
//                list = (Collection&lt;String&gt;) type.newInstance();
//            } catch (Exception e) {
//                throw new JSONException(e.getMessage(), e);
//            }
//        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1571">        int offset = fieldName.length;</span>
<span class="fc" id="L1572">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1574" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1575">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1576">            return null;</span>
        }

<span class="fc" id="L1579">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
            // int start = index;
<span class="fc bfc" id="L1583" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1584">                int startIndex = bp + offset;</span>
<span class="fc" id="L1585">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1586" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1587">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1590">                int startIndex2 = bp + offset; // must re compute</span>
<span class="fc" id="L1591">                String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1592" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="fc" id="L1594">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1595" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1596" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1597">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1602" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1603">                            break;</span>
                        }
<span class="fc" id="L1605">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1606">                    }</span>

<span class="fc" id="L1608">                    int chars_len = endIndex - (bp + offset);</span>
<span class="fc" id="L1609">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1611">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1614">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1615">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1617">                list.add(stringVal);</span>
<span class="fc bfc" id="L1618" title="All 2 branches covered.">            } else if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1619" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1620" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1621" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1622">                offset += 3;</span>
<span class="fc" id="L1623">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1624">                list.add(null);</span>
<span class="fc bfc" id="L1625" title="All 4 branches covered.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1626">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1627">                break;</span>
            } else {
<span class="fc" id="L1629">                throw new JSONException(&quot;illega str&quot;);</span>
            }

<span class="fc bfc" id="L1632" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1633">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1634">                continue;</span>
            }

<span class="fc bfc" id="L1637" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1638">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1639">                break;</span>
            }

<span class="fc" id="L1642">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1643">            return null;</span>
        }

<span class="fc bfc" id="L1646" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1647">            bp += offset;</span>
<span class="fc" id="L1648">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1649">            matchStat = VALUE;</span>
<span class="fc" id="L1650">            return list;</span>
        }

<span class="fc bfc" id="L1653" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1654">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1655" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1656">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1657">                bp += offset;</span>
<span class="fc" id="L1658">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1659" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1660">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1661">                bp += offset;</span>
<span class="fc" id="L1662">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1663" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1664">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1665">                bp += offset;</span>
<span class="fc" id="L1666">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1667" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1668">                bp += (offset - 1);</span>
<span class="fc" id="L1669">                token = JSONToken.EOF;</span>
<span class="fc" id="L1670">                this.ch = EOI;</span>
            } else {
<span class="fc" id="L1672">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1673">                return null;</span>
            }
<span class="fc" id="L1675">            matchStat = END;</span>
        } else {
<span class="fc" id="L1677">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1678">            return null;</span>
        }

<span class="fc" id="L1681">        return list;</span>
    }

    public void scanStringArray(Collection&lt;String&gt; list, char seperator) {
<span class="fc" id="L1685">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1687">        int offset = 0;</span>
<span class="fc" id="L1688">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1690" title="All 2 branches covered.">        if (chLocal == 'n'</span>
<span class="fc bfc" id="L1691" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset) == 'u'</span>
<span class="fc bfc" id="L1692" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 1) == 'l'</span>
<span class="fc bfc" id="L1693" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 2) == 'l'</span>
<span class="fc bfc" id="L1694" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 3) == seperator</span>
                ) {
<span class="fc" id="L1696">            bp += 5;</span>
<span class="fc" id="L1697">            ch = charAt(bp);</span>
<span class="fc" id="L1698">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L1699">            return;</span>
        }

<span class="fc bfc" id="L1702" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1703">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1704">            return;</span>
        }

<span class="fc" id="L1707">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
<span class="fc bfc" id="L1710" title="All 2 branches covered.">            if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1711" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1712" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1713" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1714">                offset += 3;</span>
<span class="fc" id="L1715">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1716">                list.add(null);</span>
<span class="pc bpc" id="L1717" title="1 of 4 branches missed.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1718">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1719">                break;</span>
<span class="fc bfc" id="L1720" title="All 2 branches covered.">            } else if (chLocal != '&quot;') {</span>
<span class="fc" id="L1721">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1722">                return;</span>
            } else {
<span class="fc" id="L1724">                int startIndex = bp + offset;</span>
<span class="fc" id="L1725">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1726" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1727">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1730">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1731" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="fc" id="L1733">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1734" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1735" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1736">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1741" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1742">                            break;</span>
                        }
<span class="fc" id="L1744">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1745">                    }</span>

<span class="fc" id="L1747">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1748">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1750">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1753">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1754">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1755">                list.add(stringVal);</span>
            }

<span class="fc bfc" id="L1758" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1759">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1760">                continue;</span>
            }

<span class="fc bfc" id="L1763" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1764">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1765">                break;</span>
            }

<span class="fc" id="L1768">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1769">            return;</span>
        }

<span class="fc bfc" id="L1772" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L1773">            bp += offset;</span>
<span class="fc" id="L1774">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1775">            matchStat = VALUE;</span>
<span class="fc" id="L1776">            return;</span>
        } else {
<span class="fc" id="L1778">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1779">            return;</span>
        }
    }

    public int scanFieldInt(char[] fieldName) {
<span class="fc" id="L1784">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1786" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1787">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1788">            return 0;</span>
        }

<span class="fc" id="L1791">        int offset = fieldName.length;</span>
<span class="fc" id="L1792">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1794" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L1795" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L1796">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="pc bpc" id="L1800" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1801">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L1803">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1804" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1805">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L1806" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L1807">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1808">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L1813" title="All 4 branches covered.">            if (value &lt; 0 //</span>
                    || offset &gt; 11 + 3 + fieldName.length) {
<span class="pc bpc" id="L1815" title="1 of 6 branches missed.">                if (value != Integer.MIN_VALUE //</span>
                        || offset != 17 //
                        || !negative) {
<span class="fc" id="L1818">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1819">                    return 0;</span>
                }
            }
        } else {
<span class="fc" id="L1823">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1824">            return 0;</span>
        }

<span class="fc bfc" id="L1827" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1828">            bp += offset;</span>
<span class="fc" id="L1829">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1830">            matchStat = VALUE;</span>
<span class="fc" id="L1831">            token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L1832" title="All 2 branches covered.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L1835" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1836">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1837" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1838">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1839">                bp += offset;</span>
<span class="fc" id="L1840">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1841" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1842">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1843">                bp += offset;</span>
<span class="fc" id="L1844">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1845" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1846">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1847">                bp += offset;</span>
<span class="fc" id="L1848">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1849" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1850">                token = JSONToken.EOF;</span>
<span class="fc" id="L1851">                bp += (offset - 1);</span>
<span class="fc" id="L1852">                ch = EOI;</span>
            } else {
<span class="fc" id="L1854">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1855">                return 0;</span>
            }
<span class="fc" id="L1857">            matchStat = END;</span>
        } else {
<span class="fc" id="L1859">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1860">            return 0;</span>
        }

<span class="fc bfc" id="L1863" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public final int[] scanFieldIntArray(char[] fieldName) {
<span class="fc" id="L1867">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L1869" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1870">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1871">            return null;</span>
        }

<span class="fc" id="L1874">        int offset = fieldName.length;</span>
<span class="fc" id="L1875">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1877" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1878">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1879">            return null;</span>
        }
<span class="fc" id="L1881">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1883">        int[] array = new int[16];</span>
<span class="fc" id="L1884">        int arrayIndex = 0;</span>

<span class="pc bpc" id="L1886" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L1887">            chLocal = charAt(bp + (offset++));</span>
        } else {
            for (;;) {
<span class="fc" id="L1890">                boolean nagative = false;</span>
<span class="pc bpc" id="L1891" title="1 of 2 branches missed.">                if (chLocal == '-') {</span>
<span class="nc" id="L1892">                    chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1893">                    nagative = true;</span>
                }
<span class="pc bpc" id="L1895" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1896">                    int value = chLocal - '0';</span>
                    for (; ; ) {
<span class="fc" id="L1898">                        chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1900" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1901">                            value = value * 10 + (chLocal - '0');</span>
                        } else {
                            break;
                        }
                    }

<span class="pc bpc" id="L1907" title="1 of 2 branches missed.">                    if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L1908">                        int[] tmp = new int[array.length * 3 / 2];</span>
<span class="nc" id="L1909">                        System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L1910">                        array = tmp;</span>
                    }
<span class="pc bpc" id="L1912" title="1 of 2 branches missed.">                    array[arrayIndex++] = nagative ? -value : value;</span>

<span class="fc bfc" id="L1914" title="All 2 branches covered.">                    if (chLocal == ',') {</span>
<span class="fc" id="L1915">                        chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L1916" title="1 of 2 branches missed.">                    } else if (chLocal == ']') {</span>
<span class="fc" id="L1917">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1918">                        break;</span>
                    }
<span class="fc" id="L1920">                } else {</span>
<span class="fc" id="L1921">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1922">                    return null;</span>
                }
<span class="fc" id="L1924">            }</span>
        }


<span class="pc bpc" id="L1928" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L1929">            int[] tmp = new int[arrayIndex];</span>
<span class="fc" id="L1930">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L1931">            array = tmp;</span>
        }

<span class="pc bpc" id="L1934" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L1935">            bp += (offset - 1);</span>
<span class="nc" id="L1936">            this.next();</span>
<span class="nc" id="L1937">            matchStat = VALUE;</span>
<span class="nc" id="L1938">            token = JSONToken.COMMA;</span>
<span class="nc" id="L1939">            return array;</span>
        }

<span class="pc bpc" id="L1942" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L1943">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1944" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1945">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1946">                bp += (offset - 1);</span>
<span class="fc" id="L1947">                this.next();</span>
<span class="fc bfc" id="L1948" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1949">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1950">                bp += (offset - 1);</span>
<span class="fc" id="L1951">                this.next();</span>
<span class="pc bpc" id="L1952" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L1953">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L1954">                bp += (offset - 1);</span>
<span class="nc" id="L1955">                this.next();</span>
<span class="pc bpc" id="L1956" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1957">                bp += (offset - 1);</span>
<span class="fc" id="L1958">                token = JSONToken.EOF;</span>
<span class="fc" id="L1959">                ch = EOI;</span>
            } else {
<span class="nc" id="L1961">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1962">                return null;</span>
            }
<span class="fc" id="L1964">            matchStat = END;</span>
        } else {
<span class="nc" id="L1966">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1967">            return null;</span>
        }

<span class="fc" id="L1970">        return array;</span>
    }

    public boolean scanBoolean(char expectNext) {
<span class="fc" id="L1974">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1976">        int offset = 0;</span>
<span class="fc" id="L1977">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1979">        boolean value = false;</span>
<span class="fc bfc" id="L1980" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L1981" title="All 2 branches covered.">            if (charAt(bp + offset) == 'r' //</span>
<span class="fc bfc" id="L1982" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'u' //</span>
<span class="fc bfc" id="L1983" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'e') {</span>
<span class="fc" id="L1984">                offset += 3;</span>
<span class="fc" id="L1985">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1986">                value = true;</span>
            } else {
<span class="fc" id="L1988">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1989">                return false;</span>
            }
<span class="fc bfc" id="L1991" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L1992" title="All 2 branches covered.">            if (charAt(bp + offset) == 'a' //</span>
<span class="fc bfc" id="L1993" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1994" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 's' //</span>
<span class="fc bfc" id="L1995" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 3) == 'e') {</span>
<span class="fc" id="L1996">                offset += 4;</span>
<span class="fc" id="L1997">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1998">                value = false;</span>
            } else {
<span class="fc" id="L2000">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2001">                return false;</span>
            }
<span class="fc bfc" id="L2003" title="All 2 branches covered.">        } else if (chLocal == '1') {</span>
<span class="fc" id="L2004">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2005">            value = true;</span>
<span class="pc bpc" id="L2006" title="1 of 2 branches missed.">        } else if (chLocal == '0') {</span>
<span class="fc" id="L2007">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2008">            value = false;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2012" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2013">                bp += offset;</span>
<span class="fc" id="L2014">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2015">                matchStat = VALUE;</span>
<span class="fc" id="L2016">                return value;</span>
            } else {
<span class="fc bfc" id="L2018" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2019">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2020">                    continue;</span>
                }
<span class="fc" id="L2022">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2023">                return value;</span>
            }
        }
    }

    public int scanInt(char expectNext) {
<span class="fc" id="L2029">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2031">        int offset = 0;</span>
<span class="fc" id="L2032">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2034" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2035" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2036">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2039" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2040" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2041">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="fc bfc" id="L2045" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2046">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2048">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2049" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2050">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2051" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2052">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2053">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L2058" title="All 2 branches covered.">            if (value &lt; 0) {</span>
<span class="fc" id="L2059">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2060">                return 0;</span>
            }
<span class="pc bpc" id="L2062" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2063">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2064">            value = 0;</span>
<span class="fc" id="L2065">            offset += 3;</span>
<span class="fc" id="L2066">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2068" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2069">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2073" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2074">                    bp += offset;</span>
<span class="fc" id="L2075">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2076">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2077">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2078">                    return value;</span>
<span class="fc bfc" id="L2079" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2080">                    bp += offset;</span>
<span class="fc" id="L2081">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2082">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2083">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2084">                    return value;</span>
<span class="pc bpc" id="L2085" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2086">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2087">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2091">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2092">            return 0;</span>
        } else {
<span class="fc" id="L2094">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2095">            return 0;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2099" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2100">                bp += offset;</span>
<span class="fc" id="L2101">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2102">                matchStat = VALUE;</span>
<span class="fc" id="L2103">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2104" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2106" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2107">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2108">                    continue;</span>
                }
<span class="fc" id="L2110">                matchStat = NOT_MATCH;</span>
<span class="fc bfc" id="L2111" title="All 2 branches covered.">                return negative ? -value : value;</span>
            }
        }
    }

    public boolean scanFieldBoolean(char[] fieldName) {
<span class="fc" id="L2117">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2119" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2120">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2121">            return false;</span>
        }

<span class="fc" id="L2124">        int offset = fieldName.length;</span>
<span class="fc" id="L2125">        char chLocal = charAt(bp + (offset++));</span>

        boolean value;
<span class="fc bfc" id="L2128" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2129" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'r') {</span>
<span class="fc" id="L2130">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2131">                return false;</span>
            }
<span class="fc bfc" id="L2133" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'u') {</span>
<span class="fc" id="L2134">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2135">                return false;</span>
            }
<span class="fc bfc" id="L2137" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2138">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2139">                return false;</span>
            }

<span class="fc" id="L2142">            value = true;</span>
<span class="fc bfc" id="L2143" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2144" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'a') {</span>
<span class="fc" id="L2145">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2146">                return false;</span>
            }
<span class="fc bfc" id="L2148" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'l') {</span>
<span class="fc" id="L2149">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2150">                return false;</span>
            }
<span class="fc bfc" id="L2152" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 's') {</span>
<span class="fc" id="L2153">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2154">                return false;</span>
            }
<span class="fc bfc" id="L2156" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2157">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2158">                return false;</span>
            }

<span class="fc" id="L2161">            value = false;</span>
        } else {
<span class="fc" id="L2163">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2164">            return false;</span>
        }

<span class="fc" id="L2167">        chLocal = charAt(bp + offset++);</span>
<span class="fc bfc" id="L2168" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2169">            bp += offset;</span>
<span class="fc" id="L2170">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2171">            matchStat = VALUE;</span>
<span class="fc" id="L2172">            token = JSONToken.COMMA;</span>

<span class="fc" id="L2174">            return value;</span>
        }

<span class="pc bpc" id="L2177" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2178">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2179" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2180">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2181">                bp += offset;</span>
<span class="fc" id="L2182">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2183" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2184">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2185">                bp += offset;</span>
<span class="fc" id="L2186">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2187" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2188">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2189">                bp += offset;</span>
<span class="fc" id="L2190">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2191" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2192">                token = JSONToken.EOF;</span>
<span class="fc" id="L2193">                bp += (offset - 1);</span>
<span class="fc" id="L2194">                ch = EOI;</span>
            } else {
<span class="fc" id="L2196">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2197">                return false;</span>
            }
<span class="fc" id="L2199">            matchStat = END;</span>
        } else {
<span class="nc" id="L2201">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2202">            return false;</span>
        }

<span class="fc" id="L2205">        return value;</span>
    }

    public long scanFieldLong(char[] fieldName) {
<span class="fc" id="L2209">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2211" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2212">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2213">            return 0;</span>
        }

<span class="fc" id="L2216">        int offset = fieldName.length;</span>
<span class="fc" id="L2217">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2219">        boolean negative = false;</span>
<span class="fc bfc" id="L2220" title="All 2 branches covered.">        if (chLocal == '-') {</span>
<span class="fc" id="L2221">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2222">            negative = true;</span>
        }

        long value;
<span class="fc bfc" id="L2226" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2227">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2229">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2230" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2231">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2232" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2233">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2234">                    return 0;</span>
                } else {
                    break;
                }
            }

<span class="pc bpc" id="L2240" title="2 of 8 branches missed.">            boolean valid = offset - fieldName.length &lt; 21</span>
                    &amp;&amp; (value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative));
<span class="fc bfc" id="L2242" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2243">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2244">                return 0;</span>
            }
<span class="fc" id="L2246">        } else {</span>
<span class="fc" id="L2247">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2248">            return 0;</span>
        }

<span class="fc bfc" id="L2251" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2252">            bp += offset;</span>
<span class="fc" id="L2253">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2254">            matchStat = VALUE;</span>
<span class="fc" id="L2255">            token = JSONToken.COMMA;</span>
<span class="pc bpc" id="L2256" title="1 of 2 branches missed.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L2259" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2260">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2261" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2262">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2263">                bp += offset;</span>
<span class="fc" id="L2264">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2265" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2266">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2267">                bp += offset;</span>
<span class="fc" id="L2268">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2269" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2270">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2271">                bp += offset;</span>
<span class="fc" id="L2272">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2273" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2274">                token = JSONToken.EOF;</span>
<span class="fc" id="L2275">                bp += (offset - 1);</span>
<span class="fc" id="L2276">                ch = EOI;</span>
            } else {
<span class="fc" id="L2278">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2279">                return 0;</span>
            }
<span class="fc" id="L2281">            matchStat = END;</span>
        } else {
<span class="fc" id="L2283">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2284">            return 0;</span>
        }

<span class="fc bfc" id="L2287" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public long scanLong(char expectNextChar) {
<span class="fc" id="L2291">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2293">        int offset = 0;</span>
<span class="fc" id="L2294">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2295" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2296" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2297">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2300" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2301" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2302">            chLocal = charAt(bp + (offset++));</span>
        }

        long value;
<span class="fc bfc" id="L2306" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2307">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2309">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2310" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2311">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2312" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2313">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2314">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="pc bpc" id="L2319" title="1 of 6 branches missed.">            boolean valid = value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative);</span>
<span class="fc bfc" id="L2320" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2321">                String val = subString(bp, offset - 1);</span>
<span class="fc" id="L2322">                throw new NumberFormatException(val);</span>
            }
<span class="pc bpc" id="L2324" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2325">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2326">            value = 0;</span>
<span class="fc" id="L2327">            offset += 3;</span>
<span class="fc" id="L2328">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2330" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2331">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2335" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2336">                    bp += offset;</span>
<span class="fc" id="L2337">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2338">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2339">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2340">                    return value;</span>
<span class="fc bfc" id="L2341" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2342">                    bp += offset;</span>
<span class="fc" id="L2343">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2344">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2345">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2346">                    return value;</span>
<span class="pc bpc" id="L2347" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2348">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2349">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2353">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2354">            return 0;</span>
        } else {
<span class="fc" id="L2356">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2357">            return 0;</span>
        }

<span class="fc bfc" id="L2360" title="All 2 branches covered.">        if (quote) {</span>
<span class="pc bpc" id="L2361" title="1 of 2 branches missed.">            if (chLocal != '&quot;') {</span>
<span class="nc" id="L2362">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2363">                return 0;</span>
            } else {
<span class="fc" id="L2365">                chLocal = charAt(bp + (offset++));</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L2370" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L2371">                bp += offset;</span>
<span class="fc" id="L2372">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2373">                matchStat = VALUE;</span>
<span class="fc" id="L2374">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2375" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2377" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2378">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2379">                    continue;</span>
                }

<span class="fc" id="L2382">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2383">                return value;</span>
            }
        }
    }

    public final float scanFieldFloat(char[] fieldName) {
<span class="fc" id="L2389">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2391" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2392">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2393">            return 0;</span>
        }

<span class="fc" id="L2396">        int offset = fieldName.length;</span>
<span class="fc" id="L2397">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2399" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2400" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2401">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2404" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2405" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2406">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="fc bfc" id="L2410" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2411">            int intVal = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2413">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2414" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2415">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2416">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2422">            int power = 1;</span>
<span class="fc bfc" id="L2423" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2424" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2425">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2426" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2427">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2428">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L2430">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2431" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2432">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2433">                            power *= 10;</span>
<span class="fc" id="L2434">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2440">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2441">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2445" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2446" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2447">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2448" title="1 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2449">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="pc bpc" id="L2452" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2453">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L2461" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2462" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2463">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2464">                    return 0;</span>
                } else {
<span class="fc" id="L2466">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2468">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L2469">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2471">                start = bp + fieldName.length;</span>
<span class="fc" id="L2472">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2475" title="All 4 branches covered.">            if (!exp &amp;&amp; count &lt; 20) {</span>
<span class="fc" id="L2476">                value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L2477" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2478">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L2481">                String text = this.subString(start, count);</span>
<span class="fc" id="L2482">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2484" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2485">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2486">            value = 0;</span>
<span class="fc" id="L2487">            offset += 3;</span>
<span class="fc" id="L2488">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2490" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2491">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2495" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2496">                    bp += offset;</span>
<span class="fc" id="L2497">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2498">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2499">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2500">                    return value;</span>
<span class="fc bfc" id="L2501" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L2502">                    bp += offset;</span>
<span class="fc" id="L2503">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2504">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2505">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L2506">                    return value;</span>
<span class="pc bpc" id="L2507" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2508">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2509">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2513">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2514">            return 0;</span>
        } else {
<span class="fc" id="L2516">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2517">            return 0;</span>
        }

<span class="fc bfc" id="L2520" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2521">            bp += offset;</span>
<span class="fc" id="L2522">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2523">            matchStat = VALUE;</span>
<span class="fc" id="L2524">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2525">            return value;</span>
        }

<span class="fc bfc" id="L2528" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2529">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2530" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2531">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2532">                bp += offset;</span>
<span class="fc" id="L2533">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2534" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2535">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2536">                bp += offset;</span>
<span class="fc" id="L2537">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2538" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2539">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2540">                bp += offset;</span>
<span class="fc" id="L2541">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2542" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2543">                bp += (offset - 1);</span>
<span class="fc" id="L2544">                token = JSONToken.EOF;</span>
<span class="fc" id="L2545">                ch = EOI;</span>
            } else {
<span class="fc" id="L2547">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2548">                return 0;</span>
            }
<span class="fc" id="L2550">            matchStat = END;</span>
        } else {
<span class="fc" id="L2552">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2553">            return 0;</span>
        }

<span class="fc" id="L2556">        return value;</span>
    }

    public final float scanFloat(char seperator) {
<span class="fc" id="L2560">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2562">        int offset = 0;</span>
<span class="fc" id="L2563">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2564" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2565" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2566">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2569" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2570" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2571">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="pc bpc" id="L2575" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2576">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="fc" id="L2578">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2579" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2580">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2581">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2587">            long power = 1;</span>
<span class="fc bfc" id="L2588" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2589" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2590">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2591" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2592">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2593">                    power = 10;</span>
                    for (; ; ) {
<span class="fc" id="L2595">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2596" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2597">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2598">                            power *= 10;</span>
<span class="fc" id="L2599">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2605">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2606">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2610" title="2 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L2611" title="1 of 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2612">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2613" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2614">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="nc bnc" id="L2617" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2618">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }
//            int start, count;
//            if (quote) {
//                if (chLocal != '&quot;') {
//                    matchStat = NOT_MATCH;
//                    return 0;
//                } else {
//                    chLocal = charAt(bp + (offset++));
//                }
//                start = bp + 1;
//                count = bp + offset - start - 2;
//            } else {
//                start = bp;
//                count = bp + offset - start - 1;
//            }
//            String text = this.subString(start, count);
//            value = Float.parseFloat(text);
            int start, count;
<span class="fc bfc" id="L2641" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2642" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2643">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2644">                    return 0;</span>
                } else {
<span class="fc" id="L2646">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2648">                start = bp + 1;</span>
<span class="fc" id="L2649">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2651">                start = bp;</span>
<span class="fc" id="L2652">                count = bp + offset - start - 1;</span>
            }

<span class="pc bpc" id="L2655" title="2 of 4 branches missed.">            if (!exp &amp;&amp; count &lt; 20) {</span>
<span class="fc" id="L2656">                value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L2657" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2658">                    value = -value;</span>
                }
            } else {
<span class="nc" id="L2661">                String text = this.subString(start, count);</span>
<span class="nc" id="L2662">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2664" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2665">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2666">            value = 0;</span>
<span class="fc" id="L2667">            offset += 3;</span>
<span class="fc" id="L2668">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2670" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2671">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2675" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2676">                    bp += offset;</span>
<span class="fc" id="L2677">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2678">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2679">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2680">                    return value;</span>
<span class="fc bfc" id="L2681" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2682">                    bp += offset;</span>
<span class="fc" id="L2683">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2684">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2685">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2686">                    return value;</span>
<span class="pc bpc" id="L2687" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2688">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2689">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2693">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2694">            return 0;</span>
        } else {
<span class="fc" id="L2696">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2697">            return 0;</span>
        }

<span class="fc bfc" id="L2700" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L2701">            bp += offset;</span>
<span class="fc" id="L2702">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2703">            matchStat = VALUE;</span>
<span class="fc" id="L2704">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2705">            return value;</span>
        } else {
<span class="fc" id="L2707">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2708">            return value;</span>
        }
    }

    public double scanDouble(char seperator) {
<span class="fc" id="L2713">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2715">        int offset = 0;</span>
<span class="fc" id="L2716">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2717" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L2718" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="fc" id="L2719">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L2722" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L2723" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2724">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="pc bpc" id="L2728" title="2 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2729">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="nc" id="L2731">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2732" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2733">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2734">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc" id="L2740">            long power = 1;</span>
<span class="nc bnc" id="L2741" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2742" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2743">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2744" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2745">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2746">                    power = 10;</span>
                    for (; ; ) {
<span class="nc" id="L2748">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2749" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2750">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2751">                            power *= 10;</span>
<span class="nc" id="L2752">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L2758">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2759">                    return 0;</span>
                }
            }

<span class="nc bnc" id="L2763" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L2764" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2765">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2766" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2767">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="nc bnc" id="L2770" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2771">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L2779" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L2780" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2781">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2782">                    return 0;</span>
                } else {
<span class="nc" id="L2784">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L2786">                start = bp + 1;</span>
<span class="nc" id="L2787">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L2789">                start = bp;</span>
<span class="nc" id="L2790">                count = bp + offset - start - 1;</span>
            }

<span class="nc bnc" id="L2793" title="All 4 branches missed.">            if (!exp &amp;&amp; count &lt; 20) {</span>
<span class="nc" id="L2794">                value = ((double) intVal) / power;</span>
<span class="nc bnc" id="L2795" title="All 2 branches missed.">                if (negative) {</span>
<span class="nc" id="L2796">                    value = -value;</span>
                }
            } else {
<span class="nc" id="L2799">                String text = this.subString(start, count);</span>
<span class="nc" id="L2800">                value = Double.parseDouble(text);</span>
            }
<span class="pc bpc" id="L2802" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2803">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2804">            value = 0;</span>
<span class="fc" id="L2805">            offset += 3;</span>
<span class="fc" id="L2806">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2808" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2809">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2813" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2814">                    bp += offset;</span>
<span class="fc" id="L2815">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2816">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2817">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2818">                    return value;</span>
<span class="fc bfc" id="L2819" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2820">                    bp += offset;</span>
<span class="fc" id="L2821">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2822">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2823">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2824">                    return value;</span>
<span class="pc bpc" id="L2825" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2826">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2827">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2831">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2832">            return 0;</span>
        } else {
<span class="nc" id="L2834">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2835">            return 0;</span>
        }

<span class="nc bnc" id="L2838" title="All 2 branches missed.">        if (chLocal == seperator) {</span>
<span class="nc" id="L2839">            bp += offset;</span>
<span class="nc" id="L2840">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L2841">            matchStat = VALUE;</span>
<span class="nc" id="L2842">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2843">            return value;</span>
        } else {
<span class="nc" id="L2845">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2846">            return value;</span>
        }
    }

    public BigDecimal scanDecimal(char seperator) {
<span class="nc" id="L2851">        matchStat = UNKNOWN;</span>

<span class="nc" id="L2853">        int offset = 0;</span>
<span class="nc" id="L2854">        char chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2855" title="All 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="nc bnc" id="L2856" title="All 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L2857">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="nc bnc" id="L2860" title="All 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="nc bnc" id="L2861" title="All 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2862">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="nc bnc" id="L2866" title="All 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="nc" id="L2868">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2869" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2870">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc bnc" id="L2876" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2877" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2878">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2879" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="nc" id="L2881">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2882" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2883">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L2889">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2890">                    return null;</span>
                }
            }

<span class="nc bnc" id="L2894" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L2895" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2896">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2897" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2898">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L2901" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2902">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L2910" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L2911" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2912">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2913">                    return null;</span>
                } else {
<span class="nc" id="L2915">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L2917">                start = bp + 1;</span>
<span class="nc" id="L2918">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L2920">                start = bp;</span>
<span class="nc" id="L2921">                count = bp + offset - start - 1;</span>
            }

<span class="nc" id="L2924">            char[] chars = this.sub_chars(start, count);</span>
<span class="nc" id="L2925">            value = new BigDecimal(chars);</span>
<span class="nc bnc" id="L2926" title="All 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="nc" id="L2927">            matchStat = VALUE_NULL;</span>
<span class="nc" id="L2928">            value = null;</span>
<span class="nc" id="L2929">            offset += 3;</span>
<span class="nc" id="L2930">            chLocal = charAt(bp + offset++);</span>

<span class="nc bnc" id="L2932" title="All 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L2933">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="nc bnc" id="L2937" title="All 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L2938">                    bp += offset;</span>
<span class="nc" id="L2939">                    this.ch = charAt(bp);</span>
<span class="nc" id="L2940">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L2941">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L2942">                    return value;</span>
<span class="nc bnc" id="L2943" title="All 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="nc" id="L2944">                    bp += offset;</span>
<span class="nc" id="L2945">                    this.ch = charAt(bp);</span>
<span class="nc" id="L2946">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L2947">                    token = JSONToken.RBRACE;</span>
<span class="nc" id="L2948">                    return value;</span>
<span class="nc bnc" id="L2949" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L2950">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L2951">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2955">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2956">            return null;</span>
        } else {
<span class="nc" id="L2958">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2959">            return null;</span>
        }

<span class="nc bnc" id="L2962" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L2963">            bp += offset;</span>
<span class="nc" id="L2964">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L2965">            matchStat = VALUE;</span>
<span class="nc" id="L2966">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2967">            return value;</span>
        }

<span class="nc bnc" id="L2970" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L2971">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2972" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L2973">                token = JSONToken.COMMA;</span>
<span class="nc" id="L2974">                bp += offset;</span>
<span class="nc" id="L2975">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L2976" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L2977">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L2978">                bp += offset;</span>
<span class="nc" id="L2979">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L2980" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L2981">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L2982">                bp += offset;</span>
<span class="nc" id="L2983">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L2984" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L2985">                token = JSONToken.EOF;</span>
<span class="nc" id="L2986">                bp += (offset - 1);</span>
<span class="nc" id="L2987">                ch = EOI;</span>
            } else {
<span class="nc" id="L2989">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2990">                return null;</span>
            }
<span class="nc" id="L2992">            matchStat = END;</span>
        } else {
<span class="nc" id="L2994">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2995">            return null;</span>
        }

<span class="nc" id="L2998">        return value;</span>
    }

    public final float[] scanFieldFloatArray(char[] fieldName) {
<span class="fc" id="L3002">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3004" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3005">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3006">            return null;</span>
        }

<span class="fc" id="L3009">        int offset = fieldName.length;</span>
<span class="fc" id="L3010">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3011" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L3012">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3013">            return null;</span>
        }
<span class="fc" id="L3015">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3017">        float[] array = new float[16];</span>
<span class="fc" id="L3018">        int arrayIndex = 0;</span>

        for (;;) {
<span class="fc" id="L3021">            int start = bp + offset - 1;</span>

<span class="fc bfc" id="L3023" title="All 2 branches covered.">            boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3024" title="All 2 branches covered.">            if (negative) {</span>
<span class="fc" id="L3025">                chLocal = charAt(bp + (offset++));</span>
            }

<span class="pc bpc" id="L3028" title="1 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3029">                int intVal = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L3031">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3032" title="3 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3033">                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3034">                        continue;</span>
                    } else {
                        break;
                    }
                }

<span class="fc" id="L3040">                int power = 1;</span>
<span class="fc bfc" id="L3041" title="All 2 branches covered.">                boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3042" title="All 2 branches covered.">                if (small) {</span>
<span class="fc" id="L3043">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3044">                    power = 10;</span>
<span class="pc bpc" id="L3045" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3046">                        intVal = intVal * 10 + (chLocal - '0');</span>
                        for (; ; ) {
<span class="fc" id="L3048">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3050" title="1 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3051">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3052">                                power *= 10;</span>
<span class="nc" id="L3053">                                continue;</span>
                            } else {
                                break;
                            }
                        }
                    } else {
<span class="nc" id="L3059">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3060">                        return null;</span>
                    }
                }

<span class="pc bpc" id="L3064" title="2 of 4 branches missed.">                boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3065" title="1 of 2 branches missed.">                if (exp) {</span>
<span class="nc" id="L3066">                    chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3067" title="All 4 branches missed.">                    if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3068">                        chLocal = charAt(bp + (offset++));</span>
                    }
                    for (;;) {
<span class="nc bnc" id="L3071" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3072">                            chLocal = charAt(bp + (offset++));</span>
                        } else {
                            break;
                        }
                    }
                }

<span class="fc" id="L3079">                int count = bp + offset - start - 1;</span>

                float value;
<span class="pc bpc" id="L3082" title="2 of 4 branches missed.">                if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3083">                    value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3084" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3085">                        value = -value;</span>
                    }
                } else {
<span class="nc" id="L3088">                    String text = this.subString(start, count);</span>
<span class="nc" id="L3089">                    value = Float.parseFloat(text);</span>
                }

<span class="pc bpc" id="L3092" title="1 of 2 branches missed.">                if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3093">                    float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3094">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3095">                    array = tmp;</span>
                }
<span class="fc" id="L3097">                array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3099" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3100">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3101" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3102">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3103">                    break;</span>
                }
<span class="fc" id="L3105">            } else {</span>
<span class="fc" id="L3106">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3107">                return null;</span>
            }
<span class="fc" id="L3109">        }</span>


<span class="pc bpc" id="L3112" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L3113">            float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3114">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3115">            array = tmp;</span>
        }

<span class="pc bpc" id="L3118" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3119">            bp += (offset - 1);</span>
<span class="nc" id="L3120">            this.next();</span>
<span class="nc" id="L3121">            matchStat = VALUE;</span>
<span class="nc" id="L3122">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3123">            return array;</span>
        }

<span class="pc bpc" id="L3126" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3127">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3128" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3129">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3130">                bp += (offset - 1);</span>
<span class="nc" id="L3131">                this.next();</span>
<span class="pc bpc" id="L3132" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3133">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3134">                bp += (offset - 1);</span>
<span class="nc" id="L3135">                this.next();</span>
<span class="pc bpc" id="L3136" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3137">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3138">                bp += (offset - 1);</span>
<span class="nc" id="L3139">                this.next();</span>
<span class="pc bpc" id="L3140" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3141">                bp += (offset - 1);</span>
<span class="fc" id="L3142">                token = JSONToken.EOF;</span>
<span class="fc" id="L3143">                ch = EOI;</span>
            } else {
<span class="nc" id="L3145">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3146">                return null;</span>
            }
<span class="fc" id="L3148">            matchStat = END;</span>
        } else {
<span class="nc" id="L3150">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3151">            return null;</span>
        }

<span class="fc" id="L3154">        return array;</span>
    }

    public final float[][] scanFieldFloatArray2(char[] fieldName) {
<span class="fc" id="L3158">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3160" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3161">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3162">            return null;</span>
        }

<span class="fc" id="L3165">        int offset = fieldName.length;</span>
<span class="fc" id="L3166">        char chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3168" title="1 of 2 branches missed.">        if (chLocal != '[') {</span>
<span class="nc" id="L3169">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3170">            return null;</span>
        }
<span class="fc" id="L3172">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3174">        float[][] arrayarray = new float[16][];</span>
<span class="fc" id="L3175">        int arrayarrayIndex = 0;</span>

        for (;;) {
<span class="pc bpc" id="L3178" title="1 of 2 branches missed.">            if (chLocal == '[') {</span>
<span class="fc" id="L3179">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3181">                float[] array = new float[16];</span>
<span class="fc" id="L3182">                int arrayIndex = 0;</span>

                for (; ; ) {
<span class="fc" id="L3185">                    int start = bp + offset - 1;</span>
<span class="fc bfc" id="L3186" title="All 2 branches covered.">                    boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3187" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3188">                        chLocal = charAt(bp + (offset++));</span>
                    }

<span class="pc bpc" id="L3191" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3192">                        int intVal = chLocal - '0';</span>
                        for (; ; ) {
<span class="fc" id="L3194">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3196" title="3 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3197">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3198">                                continue;</span>
                            } else {
                                break;
                            }
                        }

<span class="fc" id="L3204">                        int power = 1;</span>
<span class="fc bfc" id="L3205" title="All 2 branches covered.">                        if (chLocal == '.') {</span>
<span class="fc" id="L3206">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3208" title="2 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3209">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3210">                                power = 10;</span>
                                for (; ; ) {
<span class="fc" id="L3212">                                    chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3214" title="1 of 4 branches missed.">                                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3215">                                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3216">                                        power *= 10;</span>
<span class="nc" id="L3217">                                        continue;</span>
                                    } else {
                                        break;
                                    }
                                }
                            } else {
<span class="nc" id="L3223">                                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3224">                                return null;</span>
                            }
                        }

<span class="pc bpc" id="L3228" title="2 of 4 branches missed.">                        boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3229" title="1 of 2 branches missed.">                        if (exp) {</span>
<span class="nc" id="L3230">                            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3231" title="All 4 branches missed.">                            if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3232">                                chLocal = charAt(bp + (offset++));</span>
                            }
                            for (;;) {
<span class="nc bnc" id="L3235" title="All 4 branches missed.">                                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3236">                                    chLocal = charAt(bp + (offset++));</span>
                                } else {
                                    break;
                                }
                            }
                        }

<span class="fc" id="L3243">                        int count = bp + offset - start - 1;</span>
                        float value;
<span class="pc bpc" id="L3245" title="2 of 4 branches missed.">                        if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3246">                            value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3247" title="All 2 branches covered.">                            if (negative) {</span>
<span class="fc" id="L3248">                                value = -value;</span>
                            }
                        } else {
<span class="nc" id="L3251">                            String text = this.subString(start, count);</span>
<span class="nc" id="L3252">                            value = Float.parseFloat(text);</span>
                        }

<span class="pc bpc" id="L3255" title="1 of 2 branches missed.">                        if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3256">                            float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3257">                            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3258">                            array = tmp;</span>
                        }
<span class="fc" id="L3260">                        array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3262" title="All 2 branches covered.">                        if (chLocal == ',') {</span>
<span class="fc" id="L3263">                            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3264" title="1 of 2 branches missed.">                        } else if (chLocal == ']') {</span>
<span class="fc" id="L3265">                            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3266">                            break;</span>
                        }
<span class="fc" id="L3268">                    } else {</span>
<span class="nc" id="L3269">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3270">                        return null;</span>
                    }
<span class="fc" id="L3272">                }</span>

                // compact
<span class="pc bpc" id="L3275" title="1 of 2 branches missed.">                if (arrayIndex != array.length) {</span>
<span class="fc" id="L3276">                    float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3277">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3278">                    array = tmp;</span>
                }

<span class="pc bpc" id="L3281" title="1 of 2 branches missed.">                if (arrayarrayIndex &gt;= arrayarray.length) {</span>
<span class="nc" id="L3282">                    float[][] tmp = new float[arrayarray.length * 3 / 2][];</span>
<span class="nc" id="L3283">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3284">                    arrayarray = tmp;</span>
                }
<span class="fc" id="L3286">                arrayarray[arrayarrayIndex++] = array;</span>

<span class="pc bpc" id="L3288" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3289">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3290" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3291">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3292">                    break;</span>
                }
<span class="nc" id="L3294">            }</span>
        }

        // compact
<span class="pc bpc" id="L3298" title="1 of 2 branches missed.">        if (arrayarrayIndex != arrayarray.length) {</span>
<span class="fc" id="L3299">            float[][] tmp = new float[arrayarrayIndex][];</span>
<span class="fc" id="L3300">            System.arraycopy(arrayarray, 0, tmp, 0, arrayarrayIndex);</span>
<span class="fc" id="L3301">            arrayarray = tmp;</span>
        }

<span class="pc bpc" id="L3304" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3305">            bp += (offset - 1);</span>
<span class="nc" id="L3306">            this.next();</span>
<span class="nc" id="L3307">            matchStat = VALUE;</span>
<span class="nc" id="L3308">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3309">            return arrayarray;</span>
        }

<span class="pc bpc" id="L3312" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3313">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3314" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3315">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3316">                bp += (offset - 1);</span>
<span class="nc" id="L3317">                this.next();</span>
<span class="pc bpc" id="L3318" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3319">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3320">                bp += (offset - 1);</span>
<span class="nc" id="L3321">                this.next();</span>
<span class="pc bpc" id="L3322" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3323">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3324">                bp += (offset - 1);</span>
<span class="nc" id="L3325">                this.next();</span>
<span class="pc bpc" id="L3326" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3327">                bp += (offset - 1);</span>
<span class="fc" id="L3328">                token = JSONToken.EOF;</span>
<span class="fc" id="L3329">                ch = EOI;</span>
            } else {
<span class="nc" id="L3331">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3332">                return null;</span>
            }
<span class="fc" id="L3334">            matchStat = END;</span>
        } else {
<span class="nc" id="L3336">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3337">            return null;</span>
        }

<span class="fc" id="L3340">        return arrayarray;</span>
    }

    public final double scanFieldDouble(char[] fieldName) {
<span class="fc" id="L3344">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3346" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3347">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3348">            return 0;</span>
        }

<span class="fc" id="L3351">        int offset = fieldName.length;</span>
<span class="fc" id="L3352">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3353" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3354" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3355">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L3358" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3359" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L3360">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="fc bfc" id="L3364" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3365">            long intVal = chLocal - '0';</span>

            for (;;) {
<span class="fc" id="L3368">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3369" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3370">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3371">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L3377">            long power = 1;</span>
<span class="fc bfc" id="L3378" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3379" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3380">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3381" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3382">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3383">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L3385">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3386" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3387">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3388">                            power *= 10;</span>
<span class="fc" id="L3389">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L3395">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3396">                    return 0;</span>
                }
            }

<span class="fc bfc" id="L3400" title="All 4 branches covered.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3401" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L3402">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3403" title="All 4 branches covered.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3404">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="fc bfc" id="L3407" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3408">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L3416" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L3417" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3418">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3419">                    return 0;</span>
                } else {
<span class="fc" id="L3421">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L3423">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L3424">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3426">                start = bp + fieldName.length;</span>
<span class="fc" id="L3427">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L3430" title="All 4 branches covered.">            if (!exp &amp;&amp; count &lt; 20) {</span>
<span class="fc" id="L3431">                value = ((double) intVal) / power;</span>
<span class="fc bfc" id="L3432" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L3433">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L3436">                String text = this.subString(start, count);</span>
<span class="fc" id="L3437">                value = Double.parseDouble(text);</span>
            }
<span class="pc bpc" id="L3439" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3440">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3441">            value = 0;</span>
<span class="fc" id="L3442">            offset += 3;</span>
<span class="fc" id="L3443">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3445" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L3446">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L3450" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3451">                    bp += offset;</span>
<span class="fc" id="L3452">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3453">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3454">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L3455">                    return value;</span>
<span class="fc bfc" id="L3456" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3457">                    bp += offset;</span>
<span class="fc" id="L3458">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3459">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3460">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3461">                    return value;</span>
<span class="pc bpc" id="L3462" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L3463">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L3464">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3468">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3469">            return 0;</span>
        } else {
<span class="fc" id="L3471">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3472">            return 0;</span>
        }

<span class="fc bfc" id="L3475" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3476">            bp += offset;</span>
<span class="fc" id="L3477">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3478">            matchStat = VALUE;</span>
<span class="fc" id="L3479">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3480">            return value;</span>
        }

<span class="fc bfc" id="L3483" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3484">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3485" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L3486">                token = JSONToken.COMMA;</span>
<span class="fc" id="L3487">                bp += offset;</span>
<span class="fc" id="L3488">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3489" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3490">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3491">                bp += offset;</span>
<span class="fc" id="L3492">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3493" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L3494">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L3495">                bp += offset;</span>
<span class="fc" id="L3496">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3497" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3498">                token = JSONToken.EOF;</span>
<span class="fc" id="L3499">                bp += (offset - 1);</span>
<span class="fc" id="L3500">                ch = EOI;</span>
            } else {
<span class="fc" id="L3502">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3503">                return 0;</span>
            }
<span class="fc" id="L3505">            matchStat = END;</span>
        } else {
<span class="fc" id="L3507">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3508">            return 0;</span>
        }

<span class="fc" id="L3511">        return value;</span>
    }

    public BigDecimal scanFieldDecimal(char[] fieldName) {
<span class="fc" id="L3515">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3517" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3518">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3519">            return null;</span>
        }

<span class="fc" id="L3522">        int offset = fieldName.length;</span>
<span class="fc" id="L3523">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3524" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3525" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3526">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3529" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3530" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3531">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="pc bpc" id="L3535" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="fc" id="L3537">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3538" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3539">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc bfc" id="L3545" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3546" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3547">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3548" title="2 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="fc" id="L3550">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3551" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3552">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3558">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3559">                    return null;</span>
                }
            }

<span class="pc bpc" id="L3563" title="2 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3564" title="1 of 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3565">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3566" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3567">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L3570" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3571">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="pc bpc" id="L3579" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3580" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3581">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3582">                    return null;</span>
                } else {
<span class="nc" id="L3584">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3586">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3587">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3589">                start = bp + fieldName.length;</span>
<span class="fc" id="L3590">                count = bp + offset - start - 1;</span>
            }

<span class="fc" id="L3593">            char[] chars = this.sub_chars(start, count);</span>
<span class="fc" id="L3594">            value = new BigDecimal(chars);</span>
<span class="pc bpc" id="L3595" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3596">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3597">            value = null;</span>
<span class="fc" id="L3598">            offset += 3;</span>
<span class="fc" id="L3599">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3601" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3602">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3606" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3607">                    bp += offset;</span>
<span class="nc" id="L3608">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3609">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3610">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3611">                    return value;</span>
<span class="pc bpc" id="L3612" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3613">                    bp += offset;</span>
<span class="fc" id="L3614">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3615">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3616">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3617">                    return value;</span>
<span class="nc bnc" id="L3618" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3619">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3620">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3624">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3625">            return null;</span>
        } else {
<span class="fc" id="L3627">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3628">            return null;</span>
        }

<span class="fc bfc" id="L3631" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3632">            bp += offset;</span>
<span class="fc" id="L3633">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3634">            matchStat = VALUE;</span>
<span class="fc" id="L3635">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3636">            return value;</span>
        }

<span class="pc bpc" id="L3639" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3640">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3641" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3642">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3643">                bp += offset;</span>
<span class="nc" id="L3644">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3645" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3646">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3647">                bp += offset;</span>
<span class="fc" id="L3648">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3649" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3650">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3651">                bp += offset;</span>
<span class="nc" id="L3652">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3653" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3654">                token = JSONToken.EOF;</span>
<span class="fc" id="L3655">                bp += (offset - 1);</span>
<span class="fc" id="L3656">                ch = EOI;</span>
            } else {
<span class="nc" id="L3658">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3659">                return null;</span>
            }
<span class="fc" id="L3661">            matchStat = END;</span>
        } else {
<span class="nc" id="L3663">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3664">            return null;</span>
        }

<span class="fc" id="L3667">        return value;</span>
    }

    public BigInteger scanFieldBigInteger(char[] fieldName) {
<span class="fc" id="L3671">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3673" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3674">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3675">            return null;</span>
        }

<span class="fc" id="L3678">        int offset = fieldName.length;</span>
<span class="fc" id="L3679">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3680" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L3681" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L3682">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3685" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3686" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3687">            chLocal = charAt(bp + (offset++));</span>
        }

        BigInteger value;
<span class="pc bpc" id="L3691" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3692">            long intVal = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L3694">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3695" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3696">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3697">                    continue;</span>
                } else {
                    break;
                }
            }

            int start, count;
<span class="pc bpc" id="L3704" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3705" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3706">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3707">                    return null;</span>
                } else {
<span class="nc" id="L3709">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3711">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3712">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3714">                start = bp + fieldName.length;</span>
<span class="fc" id="L3715">                count = bp + offset - start - 1;</span>
            }

<span class="pc bpc" id="L3718" title="3 of 6 branches missed.">            if (count &lt; 20 || (negative &amp;&amp; count &lt; 21)) {</span>
<span class="pc bpc" id="L3719" title="1 of 2 branches missed.">                value = BigInteger.valueOf(negative ? -intVal : intVal);</span>
            } else {

//            char[] chars = this.sub_chars(negative ? start + 1 : start, count);
//            value = new BigInteger(chars, )
<span class="fc" id="L3724">                String strVal = this.subString(start, count);</span>
<span class="fc" id="L3725">                value = new BigInteger(strVal);</span>
            }
<span class="pc bpc" id="L3727" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3728">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3729">            value = null;</span>
<span class="fc" id="L3730">            offset += 3;</span>
<span class="fc" id="L3731">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3733" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3734">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3738" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3739">                    bp += offset;</span>
<span class="nc" id="L3740">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3741">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3742">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3743">                    return value;</span>
<span class="pc bpc" id="L3744" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3745">                    bp += offset;</span>
<span class="fc" id="L3746">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3747">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3748">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3749">                    return value;</span>
<span class="nc bnc" id="L3750" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3751">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3752">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3756">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3757">            return null;</span>
        } else {
<span class="nc" id="L3759">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3760">            return null;</span>
        }

<span class="fc bfc" id="L3763" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3764">            bp += offset;</span>
<span class="fc" id="L3765">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3766">            matchStat = VALUE;</span>
<span class="fc" id="L3767">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3768">            return value;</span>
        }

<span class="pc bpc" id="L3771" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3772">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3773" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3774">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3775">                bp += offset;</span>
<span class="nc" id="L3776">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3777" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3778">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3779">                bp += offset;</span>
<span class="nc" id="L3780">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3781" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3782">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3783">                bp += offset;</span>
<span class="nc" id="L3784">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3785" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3786">                token = JSONToken.EOF;</span>
<span class="fc" id="L3787">                bp += (offset - 1);</span>
<span class="fc" id="L3788">                ch = EOI;</span>
            } else {
<span class="nc" id="L3790">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3791">                return null;</span>
            }
<span class="fc" id="L3793">            matchStat = END;</span>
        } else {
<span class="nc" id="L3795">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3796">            return null;</span>
        }

<span class="fc" id="L3799">        return value;</span>
    }

    public java.util.Date scanFieldDate(char[] fieldName) {
<span class="fc" id="L3803">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3805" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3806">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3807">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L3812">        int offset = fieldName.length;</span>
<span class="fc" id="L3813">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L3816" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L3817">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L3818">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L3819" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L3820">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L3823">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L3824">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L3825" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L3827">                    int slashCount = 0;</span>
<span class="nc bnc" id="L3828" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L3829" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L3830">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L3835" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L3836">                        break;</span>
                    }
<span class="nc" id="L3838">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L3839">                }</span>

<span class="nc" id="L3841">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="nc" id="L3842">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="nc" id="L3844">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L3847">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L3848">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3850">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="fc bfc" id="L3852" title="All 2 branches covered.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L3853">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L3854">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L3855">                } else {</span>
<span class="fc" id="L3856">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3857">                    return null;</span>
                }
            } finally {
<span class="fc" id="L3860">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L3862" title="3 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L3863">            long millis = 0;</span>

<span class="fc" id="L3865">            boolean negative = false;</span>
<span class="pc bpc" id="L3866" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L3867">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L3868">                negative = true;</span>
            }

<span class="pc bpc" id="L3871" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3872">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L3874">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3875" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3876">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L3883" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L3884">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3885">                return null;</span>
            }

<span class="pc bpc" id="L3888" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L3889">                millis = -millis;</span>
            }

<span class="fc" id="L3892">            dateVal = new java.util.Date(millis);</span>
<span class="fc" id="L3893">        } else {</span>
<span class="nc" id="L3894">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3895">            return null;</span>
        }

<span class="fc bfc" id="L3898" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3899">            bp += offset;</span>
<span class="fc" id="L3900">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3901">            matchStat = VALUE;</span>
<span class="fc" id="L3902">            return dateVal;</span>
        }

<span class="pc bpc" id="L3905" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3906">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3907" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3908">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3909">                bp += offset;</span>
<span class="nc" id="L3910">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3911" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3912">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3913">                bp += offset;</span>
<span class="nc" id="L3914">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3915" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3916">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3917">                bp += offset;</span>
<span class="nc" id="L3918">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3919" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3920">                token = JSONToken.EOF;</span>
<span class="fc" id="L3921">                bp += (offset - 1);</span>
<span class="fc" id="L3922">                ch = EOI;</span>
            } else {
<span class="nc" id="L3924">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3925">                return null;</span>
            }
<span class="fc" id="L3927">            matchStat = END;</span>
        } else {
<span class="nc" id="L3929">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3930">            return null;</span>
        }

<span class="fc" id="L3933">        return dateVal;</span>
    }

    public java.util.Date scanDate(char seperator) {
<span class="fc" id="L3937">        matchStat = UNKNOWN;</span>

<span class="fc" id="L3939">        int offset = 0;</span>
<span class="fc" id="L3940">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L3943" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L3944">            int startIndex = bp + 1;</span>
<span class="fc" id="L3945">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L3946" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L3947">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L3950">            int startIndex2 = bp + 1; // must re compute</span>
<span class="fc" id="L3951">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L3952" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L3954">                    int slashCount = 0;</span>
<span class="nc bnc" id="L3955" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L3956" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L3957">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L3962" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L3963">                        break;</span>
                    }
<span class="nc" id="L3965">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L3966">                }</span>

<span class="nc" id="L3968">                int chars_len = endIndex - (bp + 1);</span>
<span class="nc" id="L3969">                char[] chars = sub_chars( bp + 1, chars_len);</span>

<span class="nc" id="L3971">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L3974">            offset += (endIndex - (bp + 1) + 1);</span>
<span class="fc" id="L3975">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3977">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="pc bpc" id="L3979" title="1 of 2 branches missed.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L3980">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L3981">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L3982">                } else {</span>
<span class="nc" id="L3983">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3984">                    return null;</span>
                }
            } finally {
<span class="fc" id="L3987">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L3989" title="2 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L3990">            long millis = 0;</span>

<span class="fc" id="L3992">            boolean negative = false;</span>
<span class="pc bpc" id="L3993" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L3994">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L3995">                negative = true;</span>
            }

<span class="pc bpc" id="L3998" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3999">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L4001">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L4002" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4003">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4010" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4011">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4012">                return null;</span>
            }

<span class="pc bpc" id="L4015" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4016">                millis = -millis;</span>
            }

<span class="fc" id="L4019">            dateVal = new java.util.Date(millis);</span>
<span class="pc bpc" id="L4020" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L4021">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L4022">            dateVal = null;</span>
<span class="fc" id="L4023">            offset += 3;</span>
<span class="fc" id="L4024">            chLocal = charAt(bp + offset++);</span>
        } else {
<span class="nc" id="L4026">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4027">            return null;</span>
        }

<span class="fc bfc" id="L4030" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4031">            bp += offset;</span>
<span class="fc" id="L4032">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4033">            matchStat = VALUE;</span>
<span class="fc" id="L4034">            token = JSONToken.COMMA;</span>
<span class="fc" id="L4035">            return dateVal;</span>
        }

<span class="pc bpc" id="L4038" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="fc" id="L4039">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4040" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4041">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4042">                bp += offset;</span>
<span class="nc" id="L4043">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4044" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4045">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4046">                bp += offset;</span>
<span class="nc" id="L4047">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4048" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4049">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4050">                bp += offset;</span>
<span class="nc" id="L4051">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4052" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4053">                token = JSONToken.EOF;</span>
<span class="fc" id="L4054">                bp += (offset - 1);</span>
<span class="fc" id="L4055">                ch = EOI;</span>
            } else {
<span class="nc" id="L4057">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4058">                return null;</span>
            }
<span class="fc" id="L4060">            matchStat = END;</span>
        } else {
<span class="nc" id="L4062">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4063">            return null;</span>
        }

<span class="fc" id="L4066">        return dateVal;</span>
    }

    public java.util.UUID scanFieldUUID(char[] fieldName) {
<span class="fc" id="L4070">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L4072" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L4073">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4074">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L4079">        int offset = fieldName.length;</span>
<span class="fc" id="L4080">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="fc bfc" id="L4083" title="All 2 branches covered.">        if (chLocal == '&quot;') {</span>
<span class="fc" id="L4084">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L4085">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4086" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4087">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4090">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L4091">            int len = endIndex - startIndex2;</span>
<span class="pc bpc" id="L4092" title="1 of 2 branches missed.">            if (len == 36) {</span>
<span class="fc" id="L4093">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="fc bfc" id="L4094" title="All 2 branches covered.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="fc" id="L4095">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4097" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4098">                        num = ch - '0';</span>
<span class="pc bpc" id="L4099" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4100">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4101" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4102">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4104">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4105">                        return null;</span>
                    }

<span class="fc" id="L4108">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4109">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4111" title="All 2 branches covered.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="fc" id="L4112">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4114" title="2 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4115">                        num = ch - '0';</span>
<span class="pc bpc" id="L4116" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4117">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4118" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4119">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4121">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4122">                        return null;</span>
                    }

<span class="fc" id="L4125">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4126">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4128" title="All 2 branches covered.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="fc" id="L4129">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4131" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4132">                        num = ch - '0';</span>
<span class="pc bpc" id="L4133" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4134">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4135" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4136">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4138">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4139">                        return null;</span>
                    }

<span class="fc" id="L4142">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4143">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4145" title="All 2 branches covered.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="fc" id="L4146">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4148" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4149">                        num = ch - '0';</span>
<span class="pc bpc" id="L4150" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4151">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4152" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4153">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4155">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4156">                        return null;</span>
                    }

<span class="fc" id="L4159">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4160">                    leastSigBits |= num;</span>
                }
<span class="fc bfc" id="L4162" title="All 2 branches covered.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="fc" id="L4163">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4165" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4166">                        num = ch - '0';</span>
<span class="pc bpc" id="L4167" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4168">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4169" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4170">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4172">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4173">                        return null;</span>
                    }

<span class="fc" id="L4176">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4177">                    leastSigBits |= num;</span>
                }
<span class="fc" id="L4179">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="fc" id="L4181">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L4182">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bnc" id="L4183" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4184">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4185" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4186">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4188" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4189">                        num = ch - '0';</span>
<span class="nc bnc" id="L4190" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4191">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4192" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4193">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4195">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4196">                        return null;</span>
                    }

<span class="nc" id="L4199">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4200">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4202" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4203">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4205" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4206">                        num = ch - '0';</span>
<span class="nc bnc" id="L4207" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4208">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4209" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4210">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4212">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4213">                        return null;</span>
                    }

<span class="nc" id="L4216">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4217">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4220">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4222">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="nc" id="L4223">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4224">            } else {</span>
<span class="nc" id="L4225">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4226">                return null;</span>
            }
<span class="pc bpc" id="L4228" title="1 of 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="pc bpc" id="L4229" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="pc bpc" id="L4230" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="pc bpc" id="L4231" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="fc" id="L4232">            uuid = null;</span>
<span class="fc" id="L4233">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4235">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4236">            return null;</span>
        }

<span class="pc bpc" id="L4239" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4240">            bp += offset;</span>
<span class="nc" id="L4241">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4242">            matchStat = VALUE;</span>
<span class="nc" id="L4243">            return uuid;</span>
        }

<span class="pc bpc" id="L4246" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4247">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4248" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4249">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4250">                bp += offset;</span>
<span class="nc" id="L4251">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4252" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4253">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4254">                bp += offset;</span>
<span class="nc" id="L4255">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4256" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4257">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4258">                bp += offset;</span>
<span class="nc" id="L4259">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4260" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4261">                token = JSONToken.EOF;</span>
<span class="fc" id="L4262">                bp += (offset - 1);</span>
<span class="fc" id="L4263">                ch = EOI;</span>
            } else {
<span class="nc" id="L4265">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4266">                return null;</span>
            }
<span class="fc" id="L4268">            matchStat = END;</span>
        } else {
<span class="nc" id="L4270">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4271">            return null;</span>
        }

<span class="fc" id="L4274">        return uuid;</span>
    }

    public java.util.UUID scanUUID(char seperator) {
<span class="nc" id="L4278">        matchStat = UNKNOWN;</span>

        // int index = bp + fieldName.length;

<span class="nc" id="L4282">        int offset = 0;</span>
<span class="nc" id="L4283">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="nc bnc" id="L4286" title="All 2 branches missed.">        if (chLocal == '&quot;') {</span>
<span class="nc" id="L4287">            int startIndex = bp + 1;</span>
<span class="nc" id="L4288">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="nc bnc" id="L4289" title="All 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4290">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="nc" id="L4293">            int startIndex2 = bp + 1; // must re compute</span>
<span class="nc" id="L4294">            int len = endIndex - startIndex2;</span>
<span class="nc bnc" id="L4295" title="All 2 branches missed.">            if (len == 36) {</span>
<span class="nc" id="L4296">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4297" title="All 2 branches missed.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="nc" id="L4298">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4300" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4301">                        num = ch - '0';</span>
<span class="nc bnc" id="L4302" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4303">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4304" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4305">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4307">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4308">                        return null;</span>
                    }

<span class="nc" id="L4311">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4312">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4314" title="All 2 branches missed.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="nc" id="L4315">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4317" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4318">                        num = ch - '0';</span>
<span class="nc bnc" id="L4319" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4320">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4321" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4322">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4324">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4325">                        return null;</span>
                    }

<span class="nc" id="L4328">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4329">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4331" title="All 2 branches missed.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="nc" id="L4332">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4334" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4335">                        num = ch - '0';</span>
<span class="nc bnc" id="L4336" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4337">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4338" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4339">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4341">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4342">                        return null;</span>
                    }

<span class="nc" id="L4345">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4346">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4348" title="All 2 branches missed.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="nc" id="L4349">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4351" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4352">                        num = ch - '0';</span>
<span class="nc bnc" id="L4353" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4354">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4355" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4356">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4358">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4359">                        return null;</span>
                    }

<span class="nc" id="L4362">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4363">                    leastSigBits |= num;</span>
                }
<span class="nc bnc" id="L4365" title="All 2 branches missed.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="nc" id="L4366">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4368" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4369">                        num = ch - '0';</span>
<span class="nc bnc" id="L4370" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4371">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4372" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4373">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4375">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4376">                        return null;</span>
                    }

<span class="nc" id="L4379">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4380">                    leastSigBits |= num;</span>
                }
<span class="nc" id="L4382">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4384">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4385">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4386" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4387">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4388" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4389">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4391" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4392">                        num = ch - '0';</span>
<span class="nc bnc" id="L4393" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4394">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4395" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4396">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4398">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4399">                        return null;</span>
                    }

<span class="nc" id="L4402">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4403">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4405" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4406">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4408" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4409">                        num = ch - '0';</span>
<span class="nc bnc" id="L4410" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4411">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4412" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4413">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4415">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4416">                        return null;</span>
                    }

<span class="nc" id="L4419">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4420">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4423">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4425">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4426">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4427">            } else {</span>
<span class="nc" id="L4428">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4429">                return null;</span>
            }
<span class="nc bnc" id="L4431" title="All 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="nc bnc" id="L4432" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="nc bnc" id="L4433" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="nc bnc" id="L4434" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="nc" id="L4435">            uuid = null;</span>
<span class="nc" id="L4436">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4438">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4439">            return null;</span>
        }

<span class="nc bnc" id="L4442" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4443">            bp += offset;</span>
<span class="nc" id="L4444">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4445">            matchStat = VALUE;</span>
<span class="nc" id="L4446">            return uuid;</span>
        }

<span class="nc bnc" id="L4449" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L4450">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4451" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4452">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4453">                bp += offset;</span>
<span class="nc" id="L4454">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4455" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4456">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4457">                bp += offset;</span>
<span class="nc" id="L4458">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4459" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4460">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4461">                bp += offset;</span>
<span class="nc" id="L4462">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4463" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L4464">                token = JSONToken.EOF;</span>
<span class="nc" id="L4465">                bp += (offset - 1);</span>
<span class="nc" id="L4466">                ch = EOI;</span>
            } else {
<span class="nc" id="L4468">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4469">                return null;</span>
            }
<span class="nc" id="L4471">            matchStat = END;</span>
        } else {
<span class="nc" id="L4473">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4474">            return null;</span>
        }

<span class="nc" id="L4477">        return uuid;</span>
    }

    public final void scanTrue() {
<span class="fc bfc" id="L4481" title="All 2 branches covered.">        if (ch != 't') {</span>
<span class="fc" id="L4482">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4484">        next();</span>

<span class="fc bfc" id="L4486" title="All 2 branches covered.">        if (ch != 'r') {</span>
<span class="fc" id="L4487">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4489">        next();</span>

<span class="fc bfc" id="L4491" title="All 2 branches covered.">        if (ch != 'u') {</span>
<span class="fc" id="L4492">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4494">        next();</span>

<span class="fc bfc" id="L4496" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4497">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4499">        next();</span>

<span class="pc bpc" id="L4501" title="1 of 24 branches missed.">        if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                || ch == '\f' || ch == '\b' || ch == ':' || ch == '/') {
<span class="fc" id="L4503">            token = JSONToken.TRUE;</span>
        } else {
<span class="fc" id="L4505">            throw new JSONException(&quot;scan true error&quot;);</span>
        }
<span class="fc" id="L4507">    }</span>

    public final void scanNullOrNew() {
<span class="fc bfc" id="L4510" title="All 2 branches covered.">        if (ch != 'n') {</span>
<span class="fc" id="L4511">            throw new JSONException(&quot;error parse null or new&quot;);</span>
        }
<span class="fc" id="L4513">        next();</span>

<span class="fc bfc" id="L4515" title="All 2 branches covered.">        if (ch == 'u') {</span>
<span class="fc" id="L4516">            next();</span>
<span class="fc bfc" id="L4517" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4518">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4520">            next();</span>

<span class="fc bfc" id="L4522" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4523">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4525">            next();</span>

<span class="fc bfc" id="L4527" title="All 20 branches covered.">            if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                    || ch == '\f' || ch == '\b') {
<span class="fc" id="L4529">                token = JSONToken.NULL;</span>
            } else {
<span class="fc" id="L4531">                throw new JSONException(&quot;scan null error&quot;);</span>
            }
<span class="fc" id="L4533">            return;</span>
        }

<span class="fc bfc" id="L4536" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4537">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4539">        next();</span>

<span class="fc bfc" id="L4541" title="All 2 branches covered.">        if (ch != 'w') {</span>
<span class="fc" id="L4542">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4544">        next();</span>

<span class="fc bfc" id="L4546" title="All 20 branches covered.">        if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                || ch == '\f' || ch == '\b') {
<span class="fc" id="L4548">            token = JSONToken.NEW;</span>
        } else {
<span class="fc" id="L4550">            throw new JSONException(&quot;scan new error&quot;);</span>
        }
<span class="fc" id="L4552">    }</span>

    public final void scanFalse() {
<span class="fc bfc" id="L4555" title="All 2 branches covered.">        if (ch != 'f') {</span>
<span class="fc" id="L4556">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4558">        next();</span>

<span class="fc bfc" id="L4560" title="All 2 branches covered.">        if (ch != 'a') {</span>
<span class="fc" id="L4561">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4563">        next();</span>

<span class="fc bfc" id="L4565" title="All 2 branches covered.">        if (ch != 'l') {</span>
<span class="fc" id="L4566">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4568">        next();</span>

<span class="fc bfc" id="L4570" title="All 2 branches covered.">        if (ch != 's') {</span>
<span class="fc" id="L4571">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4573">        next();</span>

<span class="fc bfc" id="L4575" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4576">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4578">        next();</span>

<span class="pc bpc" id="L4580" title="1 of 24 branches missed.">        if (ch == ' ' || ch == ',' || ch == '}' || ch == ']' || ch == '\n' || ch == '\r' || ch == '\t' || ch == EOI</span>
                || ch == '\f' || ch == '\b' || ch == ':' || ch == '/') {
<span class="fc" id="L4582">            token = JSONToken.FALSE;</span>
        } else {
<span class="fc" id="L4584">            throw new JSONException(&quot;scan false error&quot;);</span>
        }
<span class="fc" id="L4586">    }</span>

    public final void scanIdent() {
<span class="fc" id="L4589">        np = bp - 1;</span>
<span class="fc" id="L4590">        hasSpecial = false;</span>

        for (;;) {
<span class="fc" id="L4593">            sp++;</span>

<span class="fc" id="L4595">            next();</span>
<span class="fc bfc" id="L4596" title="All 2 branches covered.">            if (Character.isLetterOrDigit(ch)) {</span>
<span class="fc" id="L4597">                continue;</span>
            }

<span class="fc" id="L4600">            String ident = stringVal();</span>

<span class="fc bfc" id="L4602" title="All 2 branches covered.">            if (&quot;null&quot;.equalsIgnoreCase(ident)) {</span>
<span class="fc" id="L4603">                token = JSONToken.NULL;</span>
<span class="fc bfc" id="L4604" title="All 2 branches covered.">            } else if (&quot;new&quot;.equals(ident)) {</span>
<span class="fc" id="L4605">                token = JSONToken.NEW;</span>
<span class="fc bfc" id="L4606" title="All 2 branches covered.">            } else if (&quot;true&quot;.equals(ident)) {</span>
<span class="fc" id="L4607">                token = JSONToken.TRUE;</span>
<span class="fc bfc" id="L4608" title="All 2 branches covered.">            } else if (&quot;false&quot;.equals(ident)) {</span>
<span class="fc" id="L4609">                token = JSONToken.FALSE;</span>
<span class="fc bfc" id="L4610" title="All 2 branches covered.">            } else if (&quot;undefined&quot;.equals(ident)) {</span>
<span class="fc" id="L4611">                token = JSONToken.UNDEFINED;</span>
<span class="fc bfc" id="L4612" title="All 2 branches covered.">            } else if (&quot;Set&quot;.equals(ident)) {</span>
<span class="fc" id="L4613">                token = JSONToken.SET;</span>
<span class="fc bfc" id="L4614" title="All 2 branches covered.">            } else if (&quot;TreeSet&quot;.equals(ident)) {</span>
<span class="fc" id="L4615">                token = JSONToken.TREE_SET;</span>
            } else {
<span class="fc" id="L4617">                token = JSONToken.IDENTIFIER;</span>
            }
<span class="fc" id="L4619">            return;</span>
        }
    }

    public abstract String stringVal();

    public abstract String subString(int offset, int count);

    protected abstract char[] sub_chars(int offset, int count);

    public static String readString(char[] chars, int chars_len) {
<span class="fc" id="L4630">        char[] sbuf = new char[chars_len];</span>
<span class="fc" id="L4631">        int len = 0;</span>
<span class="fc bfc" id="L4632" title="All 2 branches covered.">        for (int i = 0; i &lt; chars_len; ++i) {</span>
<span class="fc" id="L4633">            char ch = chars[i];</span>

<span class="fc bfc" id="L4635" title="All 2 branches covered.">            if (ch != '\\') {</span>
<span class="fc" id="L4636">                sbuf[len++] = ch;</span>
<span class="fc" id="L4637">                continue;</span>
            }
<span class="fc" id="L4639">            ch = chars[++i];</span>

<span class="fc bfc" id="L4641" title="All 21 branches covered.">            switch (ch) {</span>
                case '0':
<span class="fc" id="L4643">                    sbuf[len++] = '\0';</span>
<span class="fc" id="L4644">                    break;</span>
                case '1':
<span class="fc" id="L4646">                    sbuf[len++] = '\1';</span>
<span class="fc" id="L4647">                    break;</span>
                case '2':
<span class="fc" id="L4649">                    sbuf[len++] = '\2';</span>
<span class="fc" id="L4650">                    break;</span>
                case '3':
<span class="fc" id="L4652">                    sbuf[len++] = '\3';</span>
<span class="fc" id="L4653">                    break;</span>
                case '4':
<span class="fc" id="L4655">                    sbuf[len++] = '\4';</span>
<span class="fc" id="L4656">                    break;</span>
                case '5':
<span class="fc" id="L4658">                    sbuf[len++] = '\5';</span>
<span class="fc" id="L4659">                    break;</span>
                case '6':
<span class="fc" id="L4661">                    sbuf[len++] = '\6';</span>
<span class="fc" id="L4662">                    break;</span>
                case '7':
<span class="fc" id="L4664">                    sbuf[len++] = '\7';</span>
<span class="fc" id="L4665">                    break;</span>
                case 'b': // 8
<span class="fc" id="L4667">                    sbuf[len++] = '\b';</span>
<span class="fc" id="L4668">                    break;</span>
                case 't': // 9
<span class="fc" id="L4670">                    sbuf[len++] = '\t';</span>
<span class="fc" id="L4671">                    break;</span>
                case 'n': // 10
<span class="fc" id="L4673">                    sbuf[len++] = '\n';</span>
<span class="fc" id="L4674">                    break;</span>
                case 'v': // 11
<span class="fc" id="L4676">                    sbuf[len++] = '\u000B';</span>
<span class="fc" id="L4677">                    break;</span>
                case 'f': // 12
                case 'F':
<span class="fc" id="L4680">                    sbuf[len++] = '\f';</span>
<span class="fc" id="L4681">                    break;</span>
                case 'r': // 13
<span class="fc" id="L4683">                    sbuf[len++] = '\r';</span>
<span class="fc" id="L4684">                    break;</span>
                case '&quot;': // 34
<span class="fc" id="L4686">                    sbuf[len++] = '&quot;';</span>
<span class="fc" id="L4687">                    break;</span>
                case '\'': // 39
<span class="fc" id="L4689">                    sbuf[len++] = '\'';</span>
<span class="fc" id="L4690">                    break;</span>
                case '/': // 47
<span class="fc" id="L4692">                    sbuf[len++] = '/';</span>
<span class="fc" id="L4693">                    break;</span>
                case '\\': // 92
<span class="fc" id="L4695">                    sbuf[len++] = '\\';</span>
<span class="fc" id="L4696">                    break;</span>
                case 'x':
<span class="fc" id="L4698">                    sbuf[len++] = (char) (digits[chars[++i]] * 16 + digits[chars[++i]]);</span>
<span class="fc" id="L4699">                    break;</span>
                case 'u':
<span class="fc" id="L4701">                    sbuf[len++] = (char) Integer.parseInt(new String(new char[] { chars[++i], //</span>
                                    chars[++i], //
                                    chars[++i], //
                                    chars[++i] }),
                            16);
<span class="fc" id="L4706">                    break;</span>
                default:
<span class="fc" id="L4708">                    throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
            }
        }
<span class="fc" id="L4711">        return new String(sbuf, 0, len);</span>
    }

    protected abstract boolean charArrayCompare(char[] chars);

    public boolean isBlankInput() {
<span class="fc" id="L4717">        for (int i = 0;; ++i) {</span>
<span class="fc" id="L4718">            char chLocal = charAt(i);</span>
<span class="fc bfc" id="L4719" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L4720">                token = JSONToken.EOF;</span>
<span class="fc" id="L4721">                break;</span>
            }

<span class="fc bfc" id="L4724" title="All 2 branches covered.">            if (!isWhitespace(chLocal)) {</span>
<span class="fc" id="L4725">                return false;</span>
            }
        }

<span class="fc" id="L4729">        return true;</span>
    }

    public final void skipWhitespace() {
        for (;;) {
<span class="fc bfc" id="L4734" title="All 2 branches covered.">            if (ch &lt;= '/') {</span>
<span class="pc bpc" id="L4735" title="3 of 12 branches missed.">                if (ch == ' ' || ch == '\r' || ch == '\n' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L4736">                    next();</span>
<span class="fc" id="L4737">                    continue;</span>
<span class="fc bfc" id="L4738" title="All 2 branches covered.">                } else if (ch == '/') {</span>
<span class="fc" id="L4739">                    skipComment();</span>
<span class="fc" id="L4740">                    continue;</span>
                } else {
                    break;
                }
            } else {
                break;
            }
        }
<span class="fc" id="L4748">    }</span>

    private void scanStringSingleQuote() {
<span class="fc" id="L4751">        np = bp;</span>
<span class="fc" id="L4752">        hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L4755">            chLocal = next();</span>

<span class="fc bfc" id="L4757" title="All 2 branches covered.">            if (chLocal == '\'') {</span>
<span class="fc" id="L4758">                break;</span>
            }

<span class="fc bfc" id="L4761" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc bfc" id="L4762" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L4763">                    putChar((char) EOI);</span>
<span class="fc" id="L4764">                    continue;</span>
                }
<span class="fc" id="L4766">                throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
            }

<span class="fc bfc" id="L4769" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L4770" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L4771">                    hasSpecial = true;</span>

<span class="pc bpc" id="L4773" title="1 of 2 branches missed.">                    if (sp &gt; sbuf.length) {</span>
<span class="nc" id="L4774">                        char[] newsbuf = new char[sp * 2];</span>
<span class="nc" id="L4775">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L4776">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(offset, offset + count, dest, 0);
<span class="fc" id="L4780">                    this.copyTo(np + 1, sp, sbuf);</span>
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L4784">                chLocal = next();</span>

<span class="fc bfc" id="L4786" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L4788">                        putChar('\0');</span>
<span class="fc" id="L4789">                        break;</span>
                    case '1':
<span class="fc" id="L4791">                        putChar('\1');</span>
<span class="fc" id="L4792">                        break;</span>
                    case '2':
<span class="fc" id="L4794">                        putChar('\2');</span>
<span class="fc" id="L4795">                        break;</span>
                    case '3':
<span class="fc" id="L4797">                        putChar('\3');</span>
<span class="fc" id="L4798">                        break;</span>
                    case '4':
<span class="fc" id="L4800">                        putChar('\4');</span>
<span class="fc" id="L4801">                        break;</span>
                    case '5':
<span class="fc" id="L4803">                        putChar('\5');</span>
<span class="fc" id="L4804">                        break;</span>
                    case '6':
<span class="fc" id="L4806">                        putChar('\6');</span>
<span class="fc" id="L4807">                        break;</span>
                    case '7':
<span class="fc" id="L4809">                        putChar('\7');</span>
<span class="fc" id="L4810">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L4812">                        putChar('\b');</span>
<span class="fc" id="L4813">                        break;</span>
                    case 't': // 9
<span class="fc" id="L4815">                        putChar('\t');</span>
<span class="fc" id="L4816">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L4818">                        putChar('\n');</span>
<span class="fc" id="L4819">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L4821">                        putChar('\u000B');</span>
<span class="fc" id="L4822">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L4825">                        putChar('\f');</span>
<span class="fc" id="L4826">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L4828">                        putChar('\r');</span>
<span class="fc" id="L4829">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L4831">                        putChar('&quot;');</span>
<span class="fc" id="L4832">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L4834">                        putChar('\'');</span>
<span class="fc" id="L4835">                        break;</span>
                    case '/': // 47
<span class="fc" id="L4837">                        putChar('/');</span>
<span class="fc" id="L4838">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L4840">                        putChar('\\');</span>
<span class="fc" id="L4841">                        break;</span>
                    case 'x':
<span class="fc" id="L4843">                        putChar((char) (digits[next()] * 16 + digits[next()]));</span>
<span class="fc" id="L4844">                        break;</span>
                    case 'u':
<span class="fc" id="L4846">                        putChar((char) Integer.parseInt(new String(new char[] { next(), next(), next(), next() }), 16));</span>
<span class="fc" id="L4847">                        break;</span>
                    default:
<span class="fc" id="L4849">                        this.ch = chLocal;</span>
<span class="fc" id="L4850">                        throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
                }
                continue;
            }

<span class="fc bfc" id="L4855" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L4856">                sp++;</span>
<span class="fc" id="L4857">                continue;</span>
            }

<span class="fc bfc" id="L4860" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L4861">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L4863">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L4867">        token = LITERAL_STRING;</span>
<span class="fc" id="L4868">        this.next();</span>
<span class="fc" id="L4869">    }</span>

    /**
     * Append a character to sbuf.
     */
    protected final void putChar(char ch) {
<span class="fc bfc" id="L4875" title="All 2 branches covered.">        if (sp == sbuf.length) {</span>
<span class="fc" id="L4876">            char[] newsbuf = new char[sbuf.length * 2];</span>
<span class="fc" id="L4877">            System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L4878">            sbuf = newsbuf;</span>
        }
<span class="fc" id="L4880">        sbuf[sp++] = ch;</span>
<span class="fc" id="L4881">    }</span>

    public final void scanHex() {
<span class="pc bpc" id="L4884" title="1 of 2 branches missed.">        if (ch != 'x') {</span>
<span class="nc" id="L4885">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }
<span class="fc" id="L4887">        next();</span>
<span class="pc bpc" id="L4888" title="1 of 2 branches missed.">        if (ch != '\'') {</span>
<span class="nc" id="L4889">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }

<span class="fc" id="L4892">        np = bp;</span>
<span class="fc" id="L4893">        next();</span>

<span class="fc" id="L4895">        for (int i = 0;;++i) {</span>
<span class="fc" id="L4896">            char ch = next();</span>
<span class="pc bpc" id="L4897" title="1 of 8 branches missed.">            if ((ch &gt;= '0' &amp;&amp; ch &lt;= '9') || (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F')) {</span>
<span class="fc" id="L4898">                sp++;</span>
<span class="fc" id="L4899">                continue;</span>
<span class="pc bpc" id="L4900" title="1 of 2 branches missed.">            } else if (ch == '\'') {</span>
<span class="fc" id="L4901">                sp++;</span>
<span class="fc" id="L4902">                next();</span>
<span class="fc" id="L4903">                break;</span>
            } else {
<span class="nc" id="L4905">                throw new JSONException(&quot;illegal state. &quot; + ch);</span>
            }
        }
<span class="fc" id="L4908">        token = JSONToken.HEX;</span>
<span class="fc" id="L4909">    }</span>

    public final void scanNumber() {
<span class="fc" id="L4912">        np = bp;</span>

<span class="fc bfc" id="L4914" title="All 2 branches covered.">        if (ch == '-') {</span>
<span class="fc" id="L4915">            sp++;</span>
<span class="fc" id="L4916">            next();</span>
        }

        for (;;) {
<span class="fc bfc" id="L4920" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4921">                sp++;</span>
            } else {
                break;
            }
<span class="fc" id="L4925">            next();</span>
        }

<span class="fc" id="L4928">        boolean isDouble = false;</span>

<span class="fc bfc" id="L4930" title="All 2 branches covered.">        if (ch == '.') {</span>
<span class="fc" id="L4931">            sp++;</span>
<span class="fc" id="L4932">            next();</span>
<span class="fc" id="L4933">            isDouble = true;</span>

            for (;;) {
<span class="fc bfc" id="L4936" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4937">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L4941">                next();</span>
            }
        }

<span class="fc bfc" id="L4945" title="All 2 branches covered.">        if (ch == 'L') {</span>
<span class="fc" id="L4946">            sp++;</span>
<span class="fc" id="L4947">            next();</span>
<span class="fc bfc" id="L4948" title="All 2 branches covered.">        } else if (ch == 'S') {</span>
<span class="fc" id="L4949">            sp++;</span>
<span class="fc" id="L4950">            next();</span>
<span class="fc bfc" id="L4951" title="All 2 branches covered.">        } else if (ch == 'B') {</span>
<span class="fc" id="L4952">            sp++;</span>
<span class="fc" id="L4953">            next();</span>
<span class="fc bfc" id="L4954" title="All 2 branches covered.">        } else if (ch == 'F') {</span>
<span class="fc" id="L4955">            sp++;</span>
<span class="fc" id="L4956">            next();</span>
<span class="fc" id="L4957">            isDouble = true;</span>
<span class="fc bfc" id="L4958" title="All 2 branches covered.">        } else if (ch == 'D') {</span>
<span class="fc" id="L4959">            sp++;</span>
<span class="fc" id="L4960">            next();</span>
<span class="fc" id="L4961">            isDouble = true;</span>
<span class="fc bfc" id="L4962" title="All 4 branches covered.">        } else if (ch == 'e' || ch == 'E') {</span>
<span class="fc" id="L4963">            sp++;</span>
<span class="fc" id="L4964">            next();</span>

<span class="fc bfc" id="L4966" title="All 4 branches covered.">            if (ch == '+' || ch == '-') {</span>
<span class="fc" id="L4967">                sp++;</span>
<span class="fc" id="L4968">                next();</span>
            }

            for (;;) {
<span class="fc bfc" id="L4972" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4973">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L4977">                next();</span>
            }

<span class="fc bfc" id="L4980" title="All 4 branches covered.">            if (ch == 'D' || ch == 'F') {</span>
<span class="fc" id="L4981">                sp++;</span>
<span class="fc" id="L4982">                next();</span>
            }

<span class="fc" id="L4985">            isDouble = true;</span>
        }

<span class="fc bfc" id="L4988" title="All 2 branches covered.">        if (isDouble) {</span>
<span class="fc" id="L4989">            token = JSONToken.LITERAL_FLOAT;</span>
        } else {
<span class="fc" id="L4991">            token = JSONToken.LITERAL_INT;</span>
        }
<span class="fc" id="L4993">    }</span>

    public final long longValue() throws NumberFormatException {
<span class="fc" id="L4996">        long result = 0;</span>
<span class="fc" id="L4997">        boolean negative = false;</span>
        long limit;
        int digit;

<span class="pc bpc" id="L5001" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L5002">            np = 0;</span>
        }

<span class="fc" id="L5005">        int i = np, max = np + sp;</span>

<span class="fc bfc" id="L5007" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L5008">            negative = true;</span>
<span class="fc" id="L5009">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L5010">            i++;</span>
        } else {
<span class="fc" id="L5012">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L5014">        long multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L5015" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L5016">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L5017">            result = -digit;</span>
        }
<span class="fc bfc" id="L5019" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L5021">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L5023" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L5024">                break;</span>
            }

<span class="fc" id="L5027">            digit = chLocal - '0';</span>
<span class="fc bfc" id="L5028" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L5029">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5031">            result *= 10;</span>
<span class="fc bfc" id="L5032" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L5033">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5035">            result -= digit;</span>
<span class="fc" id="L5036">        }</span>

<span class="fc bfc" id="L5038" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L5039" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L5040">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L5042">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L5045">            return -result;</span>
        }
    }

    public final Number decimalValue(boolean decimal) {
<span class="fc" id="L5050">        char chLocal = charAt(np + sp - 1);</span>
        try {
<span class="fc bfc" id="L5052" title="All 2 branches covered.">            if (chLocal == 'F') {</span>
<span class="fc" id="L5053">                return Float.parseFloat(numberString());</span>
            }

<span class="fc bfc" id="L5056" title="All 2 branches covered.">            if (chLocal == 'D') {</span>
<span class="fc" id="L5057">                return Double.parseDouble(numberString());</span>
            }

<span class="fc bfc" id="L5060" title="All 2 branches covered.">            if (decimal) {</span>
<span class="fc" id="L5061">                return decimalValue();</span>
            } else {
<span class="fc" id="L5063">                return doubleValue();</span>
            }
<span class="fc" id="L5065">        } catch (NumberFormatException ex) {</span>
<span class="fc" id="L5066">            throw new JSONException(ex.getMessage() + &quot;, &quot; + info());</span>
        }
    }

    public abstract BigDecimal decimalValue();

    public static boolean isWhitespace(char ch) {
        // 专门调整了判断顺序
<span class="fc bfc" id="L5074" title="All 14 branches covered.">        return ch &lt;= ' ' &amp;&amp; (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b');</span>
    }

    protected static final long  MULTMIN_RADIX_TEN     = Long.MIN_VALUE / 10;
    protected static final int   INT_MULTMIN_RADIX_TEN = Integer.MIN_VALUE / 10;

<span class="fc" id="L5080">    protected final static int[] digits                = new int[(int) 'f' + 1];</span>

    static {
<span class="fc bfc" id="L5083" title="All 2 branches covered.">        for (int i = '0'; i &lt;= '9'; ++i) {</span>
<span class="fc" id="L5084">            digits[i] = i - '0';</span>
        }

<span class="fc bfc" id="L5087" title="All 2 branches covered.">        for (int i = 'a'; i &lt;= 'f'; ++i) {</span>
<span class="fc" id="L5088">            digits[i] = (i - 'a') + 10;</span>
        }
<span class="fc bfc" id="L5090" title="All 2 branches covered.">        for (int i = 'A'; i &lt;= 'F'; ++i) {</span>
<span class="fc" id="L5091">            digits[i] = (i - 'A') + 10;</span>
        }
<span class="fc" id="L5093">    }</span>

    /**
     * hsf support
     * @param fieldName
     * @param argTypesCount
     * @param typeSymbolTable
     * @return
     */
    public String[] scanFieldStringArray(char[] fieldName, int argTypesCount, SymbolTable typeSymbolTable) {
<span class="nc" id="L5103">        throw new UnsupportedOperationException();</span>
    }

    public boolean matchField2(char[] fieldName) {
<span class="nc" id="L5107">        throw new UnsupportedOperationException();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>