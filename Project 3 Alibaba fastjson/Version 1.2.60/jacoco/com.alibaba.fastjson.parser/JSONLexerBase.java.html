<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSONLexerBase.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fastjson</a> &gt; <a href="index.source.html" class="el_package">com.alibaba.fastjson.parser</a> &gt; <span class="el_source">JSONLexerBase.java</span></div><h1>JSONLexerBase.java</h1><pre class="source lang-java linenums">/*
 * Copyright 1999-2019 Alibaba Group.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.alibaba.fastjson.parser;

import java.io.Closeable;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.*;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONException;
import com.alibaba.fastjson.util.IOUtils;

import static com.alibaba.fastjson.parser.JSONToken.*;

/**
 * @author wenshao[szujobs@hotmail.com]
 */
public abstract class JSONLexerBase implements JSONLexer, Closeable {

    protected void lexError(String key, Object... args) {
<span class="fc" id="L35">        token = ERROR;</span>
<span class="fc" id="L36">    }</span>

    protected int                            token;
    protected int                            pos;
    protected int                            features;

    protected char                           ch;
    protected int                            bp;

    protected int                            eofPos;

    /**
     * A character buffer for literals.
     */
    protected char[]                         sbuf;
    protected int                            sp;

    /**
     * number start position
     */
    protected int                            np;

    protected boolean                        hasSpecial;

<span class="fc" id="L60">    protected Calendar                       calendar           = null;</span>
<span class="fc" id="L61">    protected TimeZone                       timeZone           = JSON.defaultTimeZone;</span>
<span class="fc" id="L62">    protected Locale                         locale             = JSON.defaultLocale;</span>

<span class="fc" id="L64">    public int                               matchStat          = UNKNOWN;</span>

<span class="fc" id="L66">    private final static ThreadLocal&lt;char[]&gt; SBUF_LOCAL         = new ThreadLocal&lt;char[]&gt;();</span>

<span class="fc" id="L68">    protected String                         stringDefaultValue = null;</span>

<span class="fc" id="L70">    public JSONLexerBase(int features){</span>
<span class="fc" id="L71">        this.features = features;</span>

<span class="fc bfc" id="L73" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L74">            stringDefaultValue = &quot;&quot;;</span>
        }

<span class="fc" id="L77">        sbuf = SBUF_LOCAL.get();</span>

<span class="fc bfc" id="L79" title="All 2 branches covered.">        if (sbuf == null) {</span>
<span class="fc" id="L80">            sbuf = new char[512];</span>
        }
<span class="fc" id="L82">    }</span>

    public final int matchStat() {
<span class="fc" id="L85">        return matchStat;</span>
    }

    /**
     * internal method, don't invoke
     * @param token
     */
    public void setToken(int token) {
<span class="fc" id="L93">        this.token = token;</span>
<span class="fc" id="L94">    }</span>

    public final void nextToken() {
<span class="fc" id="L97">        sp = 0;</span>

        for (;;) {
<span class="fc" id="L100">            pos = bp;</span>

<span class="fc bfc" id="L102" title="All 2 branches covered.">            if (ch == '/') {</span>
<span class="fc" id="L103">                skipComment();</span>
<span class="fc" id="L104">                continue;</span>
            }

<span class="fc bfc" id="L107" title="All 2 branches covered.">            if (ch == '&quot;') {</span>
<span class="fc" id="L108">                scanString();</span>
<span class="fc" id="L109">                return;</span>
            }

<span class="fc bfc" id="L112" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L113">                next();</span>
<span class="fc" id="L114">                token = COMMA;</span>
<span class="fc" id="L115">                return;</span>
            }

<span class="fc bfc" id="L118" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L119">                scanNumber();</span>
<span class="fc" id="L120">                return;</span>
            }

<span class="fc bfc" id="L123" title="All 2 branches covered.">            if (ch == '-') {</span>
<span class="fc" id="L124">                scanNumber();</span>
<span class="fc" id="L125">                return;</span>
            }

<span class="fc bfc" id="L128" title="All 18 branches covered.">            switch (ch) {</span>
                case '\'':
<span class="fc bfc" id="L130" title="All 2 branches covered.">                    if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L131">                        throw new JSONException(&quot;Feature.AllowSingleQuotes is false&quot;);</span>
                    }
<span class="fc" id="L133">                    scanStringSingleQuote();</span>
<span class="fc" id="L134">                    return;</span>
                case ' ':
                case '\t':
                case '\b':
                case '\f':
                case '\n':
                case '\r':
<span class="fc" id="L141">                    next();</span>
<span class="fc" id="L142">                    break;</span>
                case 't': // true
<span class="fc" id="L144">                    scanTrue();</span>
<span class="fc" id="L145">                    return;</span>
                case 'f': // false
<span class="fc" id="L147">                    scanFalse();</span>
<span class="fc" id="L148">                    return;</span>
                case 'n': // new,null
<span class="fc" id="L150">                    scanNullOrNew();</span>
<span class="fc" id="L151">                    return;</span>
                case 'T':
                case 'N': // NULL
                case 'S':
                case 'u': // undefined
<span class="fc" id="L156">                    scanIdent();</span>
<span class="fc" id="L157">                    return;</span>
                case '(':
<span class="fc" id="L159">                    next();</span>
<span class="fc" id="L160">                    token = LPAREN;</span>
<span class="fc" id="L161">                    return;</span>
                case ')':
<span class="fc" id="L163">                    next();</span>
<span class="fc" id="L164">                    token = RPAREN;</span>
<span class="fc" id="L165">                    return;</span>
                case '[':
<span class="fc" id="L167">                    next();</span>
<span class="fc" id="L168">                    token = LBRACKET;</span>
<span class="fc" id="L169">                    return;</span>
                case ']':
<span class="fc" id="L171">                    next();</span>
<span class="fc" id="L172">                    token = RBRACKET;</span>
<span class="fc" id="L173">                    return;</span>
                case '{':
<span class="fc" id="L175">                    next();</span>
<span class="fc" id="L176">                    token = LBRACE;</span>
<span class="fc" id="L177">                    return;</span>
                case '}':
<span class="fc" id="L179">                    next();</span>
<span class="fc" id="L180">                    token = RBRACE;</span>
<span class="fc" id="L181">                    return;</span>
                case ':':
<span class="fc" id="L183">                    next();</span>
<span class="fc" id="L184">                    token = COLON;</span>
<span class="fc" id="L185">                    return;</span>
                case ';':
<span class="fc" id="L187">                    next();</span>
<span class="fc" id="L188">                    token = SEMI;</span>
<span class="fc" id="L189">                    return;</span>
                case '.':
<span class="fc" id="L191">                    next();</span>
<span class="fc" id="L192">                    token = DOT;</span>
<span class="fc" id="L193">                    return;</span>
                case '+':
<span class="fc" id="L195">                    next();</span>
<span class="fc" id="L196">                    scanNumber();</span>
<span class="fc" id="L197">                    return;</span>
                case 'x':
<span class="fc" id="L199">                    scanHex();</span>
<span class="fc" id="L200">                    return;</span>
                default:
<span class="fc bfc" id="L202" title="All 2 branches covered.">                    if (isEOF()) { // JLS</span>
<span class="fc bfc" id="L203" title="All 2 branches covered.">                        if (token == EOF) {</span>
<span class="fc" id="L204">                            throw new JSONException(&quot;EOF error&quot;);</span>
                        }

<span class="fc" id="L207">                        token = EOF;</span>
<span class="fc" id="L208">                        eofPos = pos = bp;</span>
                    } else {
<span class="fc bfc" id="L210" title="All 4 branches covered.">                        if (ch &lt;= 31 || ch == 127) {</span>
<span class="fc" id="L211">                            next();</span>
<span class="fc" id="L212">                            break;</span>
                        }

<span class="fc" id="L215">                        lexError(&quot;illegal.char&quot;, String.valueOf((int) ch));</span>
<span class="fc" id="L216">                        next();</span>
                    }

<span class="fc" id="L219">                    return;</span>
            }
        }

    }

    public final void nextToken(int expect) {
<span class="fc" id="L226">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L229" title="All 9 branches covered.">            switch (expect) {</span>
                case JSONToken.LBRACE:
<span class="fc bfc" id="L231" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L232">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L233">                        next();</span>
<span class="fc" id="L234">                        return;</span>
                    }
<span class="fc bfc" id="L236" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L237">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L238">                        next();</span>
<span class="fc" id="L239">                        return;</span>
                    }
                    break;
                case JSONToken.COMMA:
<span class="fc bfc" id="L243" title="All 2 branches covered.">                    if (ch == ',') {</span>
<span class="fc" id="L244">                        token = JSONToken.COMMA;</span>
<span class="fc" id="L245">                        next();</span>
<span class="fc" id="L246">                        return;</span>
                    }

<span class="fc bfc" id="L249" title="All 2 branches covered.">                    if (ch == '}') {</span>
<span class="fc" id="L250">                        token = JSONToken.RBRACE;</span>
<span class="fc" id="L251">                        next();</span>
<span class="fc" id="L252">                        return;</span>
                    }

<span class="fc bfc" id="L255" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L256">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L257">                        next();</span>
<span class="fc" id="L258">                        return;</span>
                    }

<span class="fc bfc" id="L261" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L262">                        token = JSONToken.EOF;</span>
<span class="fc" id="L263">                        return;</span>
                    }

<span class="fc bfc" id="L266" title="All 2 branches covered.">                    if (ch == 'n') {</span>
<span class="fc" id="L267">                        scanNullOrNew(false);</span>
<span class="fc" id="L268">                        return;</span>
                    }
                    break;
                case JSONToken.LITERAL_INT:
<span class="fc bfc" id="L272" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L273">                        pos = bp;</span>
<span class="fc" id="L274">                        scanNumber();</span>
<span class="fc" id="L275">                        return;</span>
                    }

<span class="fc bfc" id="L278" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L279">                        pos = bp;</span>
<span class="fc" id="L280">                        scanString();</span>
<span class="fc" id="L281">                        return;</span>
                    }

<span class="fc bfc" id="L284" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L285">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L286">                        next();</span>
<span class="fc" id="L287">                        return;</span>
                    }

<span class="fc bfc" id="L290" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L291">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L292">                        next();</span>
<span class="fc" id="L293">                        return;</span>
                    }

                    break;
                case JSONToken.LITERAL_STRING:
<span class="fc bfc" id="L298" title="All 2 branches covered.">                    if (ch == '&quot;') {</span>
<span class="fc" id="L299">                        pos = bp;</span>
<span class="fc" id="L300">                        scanString();</span>
<span class="fc" id="L301">                        return;</span>
                    }

<span class="fc bfc" id="L304" title="All 4 branches covered.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L305">                        pos = bp;</span>
<span class="fc" id="L306">                        scanNumber();</span>
<span class="fc" id="L307">                        return;</span>
                    }

<span class="fc bfc" id="L310" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L311">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L312">                        next();</span>
<span class="fc" id="L313">                        return;</span>
                    }

<span class="fc bfc" id="L316" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L317">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L318">                        next();</span>
<span class="fc" id="L319">                        return;</span>
                    }
                    break;
                case JSONToken.LBRACKET:
<span class="fc bfc" id="L323" title="All 2 branches covered.">                    if (ch == '[') {</span>
<span class="fc" id="L324">                        token = JSONToken.LBRACKET;</span>
<span class="fc" id="L325">                        next();</span>
<span class="fc" id="L326">                        return;</span>
                    }

<span class="fc bfc" id="L329" title="All 2 branches covered.">                    if (ch == '{') {</span>
<span class="fc" id="L330">                        token = JSONToken.LBRACE;</span>
<span class="fc" id="L331">                        next();</span>
<span class="fc" id="L332">                        return;</span>
                    }
                    break;
                case JSONToken.RBRACKET:
<span class="fc bfc" id="L336" title="All 2 branches covered.">                    if (ch == ']') {</span>
<span class="fc" id="L337">                        token = JSONToken.RBRACKET;</span>
<span class="fc" id="L338">                        next();</span>
<span class="fc" id="L339">                        return;</span>
                    }
                case JSONToken.EOF:
<span class="fc bfc" id="L342" title="All 2 branches covered.">                    if (ch == EOI) {</span>
<span class="fc" id="L343">                        token = JSONToken.EOF;</span>
<span class="fc" id="L344">                        return;</span>
                    }
                    break;
                case JSONToken.IDENTIFIER:
<span class="fc" id="L348">                    nextIdent();</span>
<span class="fc" id="L349">                    return;</span>
                default:
                    break;
            }

<span class="fc bfc" id="L354" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L355">                next();</span>
<span class="fc" id="L356">                continue;</span>
            }

<span class="fc" id="L359">            nextToken();</span>
<span class="fc" id="L360">            break;</span>
        }
<span class="fc" id="L362">    }</span>

    public final void nextIdent() {
<span class="fc bfc" id="L365" title="All 2 branches covered.">        while (isWhitespace(ch)) {</span>
<span class="fc" id="L366">            next();</span>
        }
<span class="fc bfc" id="L368" title="All 6 branches covered.">        if (ch == '_' || ch == '$' || Character.isLetter(ch)) {</span>
<span class="fc" id="L369">            scanIdent();</span>
        } else {
<span class="fc" id="L371">            nextToken();</span>
        }
<span class="fc" id="L373">    }</span>

    public final void nextTokenWithColon() {
<span class="fc" id="L376">        nextTokenWithChar(':');</span>
<span class="fc" id="L377">    }</span>

    public final void nextTokenWithChar(char expect) {
<span class="fc" id="L380">        sp = 0;</span>

        for (;;) {
<span class="fc bfc" id="L383" title="All 2 branches covered.">            if (ch == expect) {</span>
<span class="fc" id="L384">                next();</span>
<span class="fc" id="L385">                nextToken();</span>
<span class="fc" id="L386">                return;</span>
            }

<span class="fc bfc" id="L389" title="All 12 branches covered.">            if (ch == ' ' || ch == '\n' || ch == '\r' || ch == '\t' || ch == '\f' || ch == '\b') {</span>
<span class="fc" id="L390">                next();</span>
<span class="fc" id="L391">                continue;</span>
            }

<span class="fc" id="L394">            throw new JSONException(&quot;not match &quot; + expect + &quot; - &quot; + ch + &quot;, info : &quot; + this.info());</span>
        }
    }

    public final int token() {
<span class="fc" id="L399">        return token;</span>
    }

    public final String tokenName() {
<span class="fc" id="L403">        return JSONToken.name(token);</span>
    }

    public final int pos() {
<span class="fc" id="L407">        return pos;</span>
    }

    public final String stringDefaultValue() {
<span class="fc" id="L411">        return stringDefaultValue;</span>
    }

    public final Number integerValue() throws NumberFormatException {
<span class="fc" id="L415">        long result = 0;</span>
<span class="fc" id="L416">        boolean negative = false;</span>
<span class="fc bfc" id="L417" title="All 2 branches covered.">        if (np == -1) {</span>
<span class="fc" id="L418">            np = 0;</span>
        }
<span class="fc" id="L420">        int i = np, max = np + sp;</span>
        long limit;
        long multmin;
        int digit;

<span class="fc" id="L425">        char type = ' ';</span>

<span class="fc bfc" id="L427" title="All 4 branches covered.">        switch (charAt(max - 1)) {</span>
            case 'L':
<span class="fc" id="L429">                max--;</span>
<span class="fc" id="L430">                type = 'L';</span>
<span class="fc" id="L431">                break;</span>
            case 'S':
<span class="fc" id="L433">                max--;</span>
<span class="fc" id="L434">                type = 'S';</span>
<span class="fc" id="L435">                break;</span>
            case 'B':
<span class="fc" id="L437">                max--;</span>
<span class="fc" id="L438">                type = 'B';</span>
<span class="fc" id="L439">                break;</span>
            default:
                break;
        }

<span class="fc bfc" id="L444" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L445">            negative = true;</span>
<span class="fc" id="L446">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L447">            i++;</span>
        } else {
<span class="fc" id="L449">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L451">        multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L452" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L453">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L454">            result = -digit;</span>
        }
<span class="fc bfc" id="L456" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L458">            digit = charAt(i++) - '0';</span>
<span class="fc bfc" id="L459" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L460">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L462">            result *= 10;</span>
<span class="fc bfc" id="L463" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L464">                return new BigInteger(numberString());</span>
            }
<span class="fc" id="L466">            result -= digit;</span>
        }

<span class="fc bfc" id="L469" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L470" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc bfc" id="L471" title="All 4 branches covered.">                if (result &gt;= Integer.MIN_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L472" title="All 2 branches covered.">                    if (type == 'S') {</span>
<span class="fc" id="L473">                        return (short) result;</span>
                    }

<span class="fc bfc" id="L476" title="All 2 branches covered.">                    if (type == 'B') {</span>
<span class="fc" id="L477">                        return (byte) result;</span>
                    }

<span class="fc" id="L480">                    return (int) result;</span>
                }
<span class="fc" id="L482">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L484">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L487">            result = -result;</span>
<span class="fc bfc" id="L488" title="All 4 branches covered.">            if (result &lt;= Integer.MAX_VALUE &amp;&amp; type != 'L') {</span>
<span class="fc bfc" id="L489" title="All 2 branches covered.">                if (type == 'S') {</span>
<span class="fc" id="L490">                    return (short) result;</span>
                }

<span class="fc bfc" id="L493" title="All 2 branches covered.">                if (type == 'B') {</span>
<span class="fc" id="L494">                    return (byte) result;</span>
                }

<span class="fc" id="L497">                return (int) result;</span>
            }
<span class="fc" id="L499">            return result;</span>
        }
    }

    public final void nextTokenWithColon(int expect) {
<span class="fc" id="L504">        nextTokenWithChar(':');</span>
<span class="fc" id="L505">    }</span>

    public float floatValue() {
<span class="fc" id="L508">        String strVal = numberString();</span>
<span class="fc" id="L509">        float floatValue = Float.parseFloat(strVal);</span>
<span class="fc bfc" id="L510" title="All 4 branches covered.">        if (floatValue == 0 || floatValue == Float.POSITIVE_INFINITY) {</span>
<span class="fc" id="L511">            char c0 = strVal.charAt(0);</span>
<span class="pc bpc" id="L512" title="1 of 4 branches missed.">            if (c0 &gt; '0' &amp;&amp; c0 &lt;= '9') {</span>
<span class="fc" id="L513">                throw new JSONException(&quot;float overflow : &quot; + strVal);</span>
            }
        }
<span class="fc" id="L516">        return floatValue;</span>
    }

    public double doubleValue() {
<span class="fc" id="L520">        return Double.parseDouble(numberString());</span>
    }

    public void config(Feature feature, boolean state) {
<span class="fc" id="L524">        features = Feature.config(features, feature, state);</span>

<span class="fc bfc" id="L526" title="All 2 branches covered.">        if ((features &amp; Feature.InitStringFieldAsEmpty.mask) != 0) {</span>
<span class="fc" id="L527">            stringDefaultValue = &quot;&quot;;</span>
        }
<span class="fc" id="L529">    }</span>

    public final boolean isEnabled(Feature feature) {
<span class="fc" id="L532">        return isEnabled(feature.mask);</span>
    }

    public final boolean isEnabled(int feature) {
<span class="fc bfc" id="L536" title="All 2 branches covered.">        return (this.features &amp; feature) != 0;</span>
    }

    public final boolean isEnabled(int features, int feature) {
<span class="pc bpc" id="L540" title="1 of 4 branches missed.">        return (this.features &amp; feature) != 0 || (features &amp; feature) != 0;</span>
    }

    public abstract String numberString();

    public abstract boolean isEOF();

    public final char getCurrent() {
<span class="fc" id="L548">        return ch;</span>
    }

    public abstract char charAt(int index);

    // public final char next() {
    // ch = doNext();
    //// if (ch == '/' &amp;&amp; (this.features &amp; Feature.AllowComment.mask) != 0) {
    //// skipComment();
    //// }
    // return ch;
    // }

    public abstract char next();

    protected void skipComment() {
<span class="fc" id="L564">        next();</span>
<span class="fc bfc" id="L565" title="All 2 branches covered.">        if (ch == '/') {</span>
            for (;;) {
<span class="fc" id="L567">                next();</span>
<span class="fc bfc" id="L568" title="All 2 branches covered.">                if (ch == '\n') {</span>
<span class="fc" id="L569">                    next();</span>
<span class="fc" id="L570">                    return;</span>
<span class="fc bfc" id="L571" title="All 2 branches covered.">                } else if (ch == EOI) {</span>
<span class="fc" id="L572">                    return;</span>
                }
            }
<span class="fc bfc" id="L575" title="All 2 branches covered.">        } else if (ch == '*') {</span>
<span class="fc" id="L576">            next();</span>

<span class="pc bpc" id="L578" title="1 of 2 branches missed.">            for (; ch != EOI;) {</span>
<span class="fc bfc" id="L579" title="All 2 branches covered.">                if (ch == '*') {</span>
<span class="fc" id="L580">                    next();</span>
<span class="fc bfc" id="L581" title="All 2 branches covered.">                    if (ch == '/') {</span>
<span class="fc" id="L582">                        next();</span>
<span class="fc" id="L583">                        return;</span>
                    } else {
                        continue;
                    }
                }
<span class="fc" id="L588">                next();</span>
            }
        } else {
<span class="fc" id="L591">            throw new JSONException(&quot;invalid comment&quot;);</span>
        }
<span class="nc" id="L593">    }</span>

    public final String scanSymbol(final SymbolTable symbolTable) {
<span class="fc" id="L596">        skipWhitespace();</span>

<span class="fc bfc" id="L598" title="All 2 branches covered.">        if (ch == '&quot;') {</span>
<span class="fc" id="L599">            return scanSymbol(symbolTable, '&quot;');</span>
        }

<span class="fc bfc" id="L602" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc bfc" id="L603" title="All 2 branches covered.">            if (!isEnabled(Feature.AllowSingleQuotes)) {</span>
<span class="fc" id="L604">                throw new JSONException(&quot;syntax error&quot;);</span>
            }

<span class="fc" id="L607">            return scanSymbol(symbolTable, '\'');</span>
        }

<span class="fc bfc" id="L610" title="All 2 branches covered.">        if (ch == '}') {</span>
<span class="fc" id="L611">            next();</span>
<span class="fc" id="L612">            token = JSONToken.RBRACE;</span>
<span class="fc" id="L613">            return null;</span>
        }

<span class="fc bfc" id="L616" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L617">            next();</span>
<span class="fc" id="L618">            token = JSONToken.COMMA;</span>
<span class="fc" id="L619">            return null;</span>
        }

<span class="fc bfc" id="L622" title="All 2 branches covered.">        if (ch == EOI) {</span>
<span class="fc" id="L623">            token = JSONToken.EOF;</span>
<span class="fc" id="L624">            return null;</span>
        }

<span class="fc bfc" id="L627" title="All 2 branches covered.">        if (!isEnabled(Feature.AllowUnQuotedFieldNames)) {</span>
<span class="fc" id="L628">            throw new JSONException(&quot;syntax error&quot;);</span>
        }

<span class="fc" id="L631">        return scanSymbolUnQuoted(symbolTable);</span>
    }

    // public abstract String scanSymbol(final SymbolTable symbolTable, final char quote);

    protected abstract void arrayCopy(int srcPos, char[] dest, int destPos, int length);

    public final String scanSymbol(final SymbolTable symbolTable, final char quote) {
<span class="fc" id="L639">        int hash = 0;</span>

<span class="fc" id="L641">        np = bp;</span>
<span class="fc" id="L642">        sp = 0;</span>
<span class="fc" id="L643">        boolean hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L646">            chLocal = next();</span>

<span class="fc bfc" id="L648" title="All 2 branches covered.">            if (chLocal == quote) {</span>
<span class="fc" id="L649">                break;</span>
            }

<span class="fc bfc" id="L652" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L653">                throw new JSONException(&quot;unclosed.str&quot;);</span>
            }

<span class="fc bfc" id="L656" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L657" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L658">                    hasSpecial = true;</span>

<span class="fc bfc" id="L660" title="All 2 branches covered.">                    if (sp &gt;= sbuf.length) {</span>
<span class="fc" id="L661">                        int newCapcity = sbuf.length * 2;</span>
<span class="pc bpc" id="L662" title="1 of 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L663">                            newCapcity = sp;</span>
                        }
<span class="fc" id="L665">                        char[] newsbuf = new char[newCapcity];</span>
<span class="fc" id="L666">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L667">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(this.buf, np + 1, sbuf, 0, sp);
<span class="fc" id="L672">                    arrayCopy(np + 1, sbuf, 0, sp);</span>
                }

<span class="fc" id="L675">                chLocal = next();</span>

<span class="fc bfc" id="L677" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L679">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L680">                        putChar('\0');</span>
<span class="fc" id="L681">                        break;</span>
                    case '1':
<span class="fc" id="L683">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L684">                        putChar('\1');</span>
<span class="fc" id="L685">                        break;</span>
                    case '2':
<span class="fc" id="L687">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L688">                        putChar('\2');</span>
<span class="fc" id="L689">                        break;</span>
                    case '3':
<span class="fc" id="L691">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L692">                        putChar('\3');</span>
<span class="fc" id="L693">                        break;</span>
                    case '4':
<span class="fc" id="L695">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L696">                        putChar('\4');</span>
<span class="fc" id="L697">                        break;</span>
                    case '5':
<span class="fc" id="L699">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L700">                        putChar('\5');</span>
<span class="fc" id="L701">                        break;</span>
                    case '6':
<span class="fc" id="L703">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L704">                        putChar('\6');</span>
<span class="fc" id="L705">                        break;</span>
                    case '7':
<span class="fc" id="L707">                        hash = 31 * hash + (int) chLocal;</span>
<span class="fc" id="L708">                        putChar('\7');</span>
<span class="fc" id="L709">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L711">                        hash = 31 * hash + (int) '\b';</span>
<span class="fc" id="L712">                        putChar('\b');</span>
<span class="fc" id="L713">                        break;</span>
                    case 't': // 9
<span class="fc" id="L715">                        hash = 31 * hash + (int) '\t';</span>
<span class="fc" id="L716">                        putChar('\t');</span>
<span class="fc" id="L717">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L719">                        hash = 31 * hash + (int) '\n';</span>
<span class="fc" id="L720">                        putChar('\n');</span>
<span class="fc" id="L721">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L723">                        hash = 31 * hash + (int) '\u000B';</span>
<span class="fc" id="L724">                        putChar('\u000B');</span>
<span class="fc" id="L725">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L728">                        hash = 31 * hash + (int) '\f';</span>
<span class="fc" id="L729">                        putChar('\f');</span>
<span class="fc" id="L730">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L732">                        hash = 31 * hash + (int) '\r';</span>
<span class="fc" id="L733">                        putChar('\r');</span>
<span class="fc" id="L734">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L736">                        hash = 31 * hash + (int) '&quot;';</span>
<span class="fc" id="L737">                        putChar('&quot;');</span>
<span class="fc" id="L738">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L740">                        hash = 31 * hash + (int) '\'';</span>
<span class="fc" id="L741">                        putChar('\'');</span>
<span class="fc" id="L742">                        break;</span>
                    case '/': // 47
<span class="fc" id="L744">                        hash = 31 * hash + (int) '/';</span>
<span class="fc" id="L745">                        putChar('/');</span>
<span class="fc" id="L746">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L748">                        hash = 31 * hash + (int) '\\';</span>
<span class="fc" id="L749">                        putChar('\\');</span>
<span class="fc" id="L750">                        break;</span>
                    case 'x':
<span class="fc" id="L752">                        char x1 = ch = next();</span>
<span class="fc" id="L753">                        char x2 = ch = next();</span>

<span class="fc" id="L755">                        int x_val = digits[x1] * 16 + digits[x2];</span>
<span class="fc" id="L756">                        char x_char = (char) x_val;</span>
<span class="fc" id="L757">                        hash = 31 * hash + (int) x_char;</span>
<span class="fc" id="L758">                        putChar(x_char);</span>
<span class="fc" id="L759">                        break;</span>
                    case 'u':
<span class="fc" id="L761">                        char c1 = chLocal = next();</span>
<span class="fc" id="L762">                        char c2 = chLocal = next();</span>
<span class="fc" id="L763">                        char c3 = chLocal = next();</span>
<span class="fc" id="L764">                        char c4 = chLocal = next();</span>
<span class="fc" id="L765">                        int val = Integer.parseInt(new String(new char[] { c1, c2, c3, c4 }), 16);</span>
<span class="fc" id="L766">                        hash = 31 * hash + val;</span>
<span class="fc" id="L767">                        putChar((char) val);</span>
<span class="fc" id="L768">                        break;</span>
                    default:
<span class="fc" id="L770">                        this.ch = chLocal;</span>
<span class="fc" id="L771">                        throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
                }
                continue;
            }

<span class="fc" id="L776">            hash = 31 * hash + chLocal;</span>

<span class="fc bfc" id="L778" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L779">                sp++;</span>
<span class="fc" id="L780">                continue;</span>
            }

<span class="fc bfc" id="L783" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L784">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L786">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L790">        token = LITERAL_STRING;</span>

        String value;
<span class="fc bfc" id="L793" title="All 2 branches covered.">        if (!hasSpecial) {</span>
            // return this.text.substring(np + 1, np + 1 + sp).intern();
            int offset;
<span class="pc bpc" id="L796" title="1 of 2 branches missed.">            if (np == -1) {</span>
<span class="nc" id="L797">                offset = 0;</span>
            } else {
<span class="fc" id="L799">                offset = np + 1;</span>
            }
<span class="fc" id="L801">            value = addSymbol(offset, sp, hash, symbolTable);</span>
<span class="fc" id="L802">        } else {</span>
<span class="fc" id="L803">            value = symbolTable.addSymbol(sbuf, 0, sp, hash);</span>
        }

<span class="fc" id="L806">        sp = 0;</span>
<span class="fc" id="L807">        this.next();</span>

<span class="fc" id="L809">        return value;</span>
    }

    public final void resetStringPosition() {
<span class="fc" id="L813">        this.sp = 0;</span>
<span class="fc" id="L814">    }</span>

    public String info() {
<span class="fc" id="L817">        return &quot;&quot;;</span>
    }

    public final String scanSymbolUnQuoted(final SymbolTable symbolTable) {
<span class="pc bpc" id="L821" title="2 of 6 branches missed.">        if (token == JSONToken.ERROR &amp;&amp; pos == 0 &amp;&amp; bp == 1) {</span>
<span class="fc" id="L822">            bp = 0; // adjust</span>
        }
<span class="fc" id="L824">        final boolean[] firstIdentifierFlags = IOUtils.firstIdentifierFlags;</span>
<span class="fc" id="L825">        final char first = ch;</span>

<span class="pc bpc" id="L827" title="1 of 4 branches missed.">        final boolean firstFlag = ch &gt;= firstIdentifierFlags.length || firstIdentifierFlags[first];</span>
<span class="fc bfc" id="L828" title="All 2 branches covered.">        if (!firstFlag) {</span>
<span class="fc" id="L829">            throw new JSONException(&quot;illegal identifier : &quot; + ch //</span>
<span class="fc" id="L830">                    + info());</span>
        }

<span class="fc" id="L833">        final boolean[] identifierFlags = IOUtils.identifierFlags;</span>

<span class="fc" id="L835">        int hash = first;</span>

<span class="fc" id="L837">        np = bp;</span>
<span class="fc" id="L838">        sp = 1;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L841">            chLocal = next();</span>

<span class="pc bpc" id="L843" title="1 of 2 branches missed.">            if (chLocal &lt; identifierFlags.length) {</span>
<span class="fc bfc" id="L844" title="All 2 branches covered.">                if (!identifierFlags[chLocal]) {</span>
<span class="fc" id="L845">                    break;</span>
                }
            }

<span class="fc" id="L849">            hash = 31 * hash + chLocal;</span>

<span class="fc" id="L851">            sp++;</span>
<span class="fc" id="L852">            continue;</span>
        }

<span class="fc" id="L855">        this.ch = charAt(bp);</span>
<span class="fc" id="L856">        token = JSONToken.IDENTIFIER;</span>

<span class="fc" id="L858">        final int NULL_HASH = 3392903;</span>
<span class="pc bpc" id="L859" title="3 of 10 branches missed.">        if (sp == 4 &amp;&amp; hash == NULL_HASH &amp;&amp; charAt(np) == 'n' &amp;&amp; charAt(np + 1) == 'u' &amp;&amp; charAt(np + 2) == 'l'</span>
<span class="pc bpc" id="L860" title="1 of 2 branches missed.">                &amp;&amp; charAt(np + 3) == 'l') {</span>
<span class="fc" id="L861">            return null;</span>
        }

        // return text.substring(np, np + sp).intern();

<span class="pc bpc" id="L866" title="1 of 2 branches missed.">        if (symbolTable == null) {</span>
<span class="nc" id="L867">            return subString(np, sp);</span>
        }

<span class="fc" id="L870">        return this.addSymbol(np, sp, hash, symbolTable);</span>
        // return symbolTable.addSymbol(buf, np, sp, hash);
    }

    protected abstract void copyTo(int offset, int count, char[] dest);

    public final void scanString() {
<span class="fc" id="L877">        np = bp;</span>
<span class="fc" id="L878">        hasSpecial = false;</span>
        char ch;
        for (;;) {
<span class="fc" id="L881">            ch = next();</span>

<span class="fc bfc" id="L883" title="All 2 branches covered.">            if (ch == '\&quot;') {</span>
<span class="fc" id="L884">                break;</span>
            }

<span class="fc bfc" id="L887" title="All 2 branches covered.">            if (ch == EOI) {</span>
<span class="fc bfc" id="L888" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L889">                    putChar((char) EOI);</span>
<span class="fc" id="L890">                    continue;</span>
                }
<span class="fc" id="L892">                throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
            }

<span class="fc bfc" id="L895" title="All 2 branches covered.">            if (ch == '\\') {</span>
<span class="fc bfc" id="L896" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L897">                    hasSpecial = true;</span>

<span class="pc bpc" id="L899" title="1 of 2 branches missed.">                    if (sp &gt;= sbuf.length) {</span>
<span class="nc" id="L900">                        int newCapcity = sbuf.length * 2;</span>
<span class="nc bnc" id="L901" title="All 2 branches missed.">                        if (sp &gt; newCapcity) {</span>
<span class="nc" id="L902">                            newCapcity = sp;</span>
                        }
<span class="nc" id="L904">                        char[] newsbuf = new char[newCapcity];</span>
<span class="nc" id="L905">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L906">                        sbuf = newsbuf;</span>
                    }

<span class="fc" id="L909">                    copyTo(np + 1, sp, sbuf);</span>
                    // text.getChars(np + 1, np + 1 + sp, sbuf, 0);
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L914">                ch = next();</span>

<span class="fc bfc" id="L916" title="All 21 branches covered.">                switch (ch) {</span>
                    case '0':
<span class="fc" id="L918">                        putChar('\0');</span>
<span class="fc" id="L919">                        break;</span>
                    case '1':
<span class="fc" id="L921">                        putChar('\1');</span>
<span class="fc" id="L922">                        break;</span>
                    case '2':
<span class="fc" id="L924">                        putChar('\2');</span>
<span class="fc" id="L925">                        break;</span>
                    case '3':
<span class="fc" id="L927">                        putChar('\3');</span>
<span class="fc" id="L928">                        break;</span>
                    case '4':
<span class="fc" id="L930">                        putChar('\4');</span>
<span class="fc" id="L931">                        break;</span>
                    case '5':
<span class="fc" id="L933">                        putChar('\5');</span>
<span class="fc" id="L934">                        break;</span>
                    case '6':
<span class="fc" id="L936">                        putChar('\6');</span>
<span class="fc" id="L937">                        break;</span>
                    case '7':
<span class="fc" id="L939">                        putChar('\7');</span>
<span class="fc" id="L940">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L942">                        putChar('\b');</span>
<span class="fc" id="L943">                        break;</span>
                    case 't': // 9
<span class="fc" id="L945">                        putChar('\t');</span>
<span class="fc" id="L946">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L948">                        putChar('\n');</span>
<span class="fc" id="L949">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L951">                        putChar('\u000B');</span>
<span class="fc" id="L952">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L955">                        putChar('\f');</span>
<span class="fc" id="L956">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L958">                        putChar('\r');</span>
<span class="fc" id="L959">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L961">                        putChar('&quot;');</span>
<span class="fc" id="L962">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L964">                        putChar('\'');</span>
<span class="fc" id="L965">                        break;</span>
                    case '/': // 47
<span class="fc" id="L967">                        putChar('/');</span>
<span class="fc" id="L968">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L970">                        putChar('\\');</span>
<span class="fc" id="L971">                        break;</span>
                    case 'x':
<span class="fc" id="L973">                        char x1 = next();</span>
<span class="fc" id="L974">                        char x2 = next();</span>

<span class="pc bpc" id="L976" title="4 of 12 branches missed.">                        boolean hex1 = (x1 &gt;= '0' &amp;&amp; x1 &lt;= '9')</span>
                                || (x1 &gt;= 'a' &amp;&amp; x1 &lt;= 'f')
                                || (x1 &gt;= 'A' &amp;&amp; x1 &lt;= 'F');
<span class="pc bpc" id="L979" title="4 of 12 branches missed.">                        boolean hex2 = (x2 &gt;= '0' &amp;&amp; x2 &lt;= '9')</span>
                                || (x2 &gt;= 'a' &amp;&amp; x2 &lt;= 'f')
                                || (x2 &gt;= 'A' &amp;&amp; x2 &lt;= 'F');
<span class="pc bpc" id="L982" title="1 of 4 branches missed.">                        if (!hex1 || !hex2) {</span>
<span class="fc" id="L983">                            throw new JSONException(&quot;invalid escape character \\x&quot; + x1 + x2);</span>
                        }

<span class="fc" id="L986">                        char x_char = (char) (digits[x1] * 16 + digits[x2]);</span>
<span class="fc" id="L987">                        putChar(x_char);</span>
<span class="fc" id="L988">                        break;</span>
                    case 'u':
<span class="fc" id="L990">                        char u1 = ch = next();</span>
<span class="fc" id="L991">                        char u2 = ch = next();</span>
<span class="fc" id="L992">                        char u3 = ch = next();</span>
<span class="fc" id="L993">                        char u4 = ch = next();</span>
<span class="fc" id="L994">                        int val = Integer.parseInt(new String(new char[] { u1, u2, u3, u4 }), 16);</span>
<span class="fc" id="L995">                        putChar((char) val);</span>
<span class="fc" id="L996">                        break;</span>
                    default:
<span class="fc" id="L998">                        this.ch = ch;</span>
<span class="fc" id="L999">                        throw new JSONException(&quot;unclosed string : &quot; + ch);</span>
                }
                continue;
            }

<span class="fc bfc" id="L1004" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L1005">                sp++;</span>
<span class="fc" id="L1006">                continue;</span>
            }

<span class="fc bfc" id="L1009" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L1010">                putChar(ch);</span>
            } else {
<span class="fc" id="L1012">                sbuf[sp++] = ch;</span>
            }
        }

<span class="fc" id="L1016">        token = JSONToken.LITERAL_STRING;</span>
<span class="fc" id="L1017">        this.ch = next();</span>
<span class="fc" id="L1018">    }</span>

    public Calendar getCalendar() {
<span class="fc" id="L1021">        return this.calendar;</span>
    }

    public TimeZone getTimeZone() {
<span class="fc" id="L1025">        return timeZone;</span>
    }

    public void setTimeZone(TimeZone timeZone) {
<span class="fc" id="L1029">        this.timeZone = timeZone;</span>
<span class="fc" id="L1030">    }</span>

    public Locale getLocale() {
<span class="fc" id="L1033">        return locale;</span>
    }

    public void setLocale(Locale locale) {
<span class="fc" id="L1037">        this.locale = locale;</span>
<span class="fc" id="L1038">    }</span>

    public final int intValue() {
<span class="pc bpc" id="L1041" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L1042">            np = 0;</span>
        }

<span class="fc" id="L1045">        int result = 0;</span>
<span class="fc" id="L1046">        boolean negative = false;</span>
<span class="fc" id="L1047">        int i = np, max = np + sp;</span>
        int limit;
        int digit;

<span class="fc bfc" id="L1051" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L1052">            negative = true;</span>
<span class="fc" id="L1053">            limit = Integer.MIN_VALUE;</span>
<span class="fc" id="L1054">            i++;</span>
        } else {
<span class="fc" id="L1056">            limit = -Integer.MAX_VALUE;</span>
        }
<span class="fc" id="L1058">        long multmin = INT_MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L1059" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L1060">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L1061">            result = -digit;</span>
        }
<span class="fc bfc" id="L1063" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L1065">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L1067" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L1068">                break;</span>
            }

<span class="fc" id="L1071">            digit = chLocal - '0';</span>

<span class="fc bfc" id="L1073" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L1074">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1076">            result *= 10;</span>
<span class="fc bfc" id="L1077" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L1078">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L1080">            result -= digit;</span>
<span class="fc" id="L1081">        }</span>

<span class="fc bfc" id="L1083" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L1084" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L1085">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L1087">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L1090">            return -result;</span>
        }
    }

    public abstract byte[] bytesValue();

    public void close() {
<span class="fc bfc" id="L1097" title="All 2 branches covered.">        if (sbuf.length &lt;= 1024 * 8) {</span>
<span class="fc" id="L1098">            SBUF_LOCAL.set(sbuf);</span>
        }
<span class="fc" id="L1100">        this.sbuf = null;</span>
<span class="fc" id="L1101">    }</span>

    public final boolean isRef() {
<span class="fc bfc" id="L1104" title="All 2 branches covered.">        if (sp != 4) {</span>
<span class="fc" id="L1105">            return false;</span>
        }

<span class="fc bfc" id="L1108" title="All 2 branches covered.">        return charAt(np + 1) == '$' //</span>
<span class="fc bfc" id="L1109" title="All 2 branches covered.">                &amp;&amp; charAt(np + 2) == 'r' //</span>
<span class="fc bfc" id="L1110" title="All 2 branches covered.">                &amp;&amp; charAt(np + 3) == 'e' //</span>
<span class="fc bfc" id="L1111" title="All 2 branches covered.">                &amp;&amp; charAt(np + 4) == 'f';</span>
    }

<span class="fc" id="L1114">    protected final static char[] typeFieldName = (&quot;\&quot;&quot; + JSON.DEFAULT_TYPE_KEY + &quot;\&quot;:\&quot;&quot;).toCharArray();</span>

    public final int scanType(String type) {
<span class="fc" id="L1117">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1119" title="All 2 branches covered.">        if (!charArrayCompare(typeFieldName)) {</span>
<span class="fc" id="L1120">            return NOT_MATCH_NAME;</span>
        }

<span class="fc" id="L1123">        int bpLocal = this.bp + typeFieldName.length;</span>

<span class="fc" id="L1125">        final int typeLength = type.length();</span>
<span class="fc bfc" id="L1126" title="All 2 branches covered.">        for (int i = 0; i &lt; typeLength; ++i) {</span>
<span class="fc bfc" id="L1127" title="All 2 branches covered.">            if (type.charAt(i) != charAt(bpLocal + i)) {</span>
<span class="fc" id="L1128">                return NOT_MATCH;</span>
            }
        }
<span class="fc" id="L1131">        bpLocal += typeLength;</span>
<span class="fc bfc" id="L1132" title="All 2 branches covered.">        if (charAt(bpLocal) != '&quot;') {</span>
<span class="fc" id="L1133">            return NOT_MATCH;</span>
        }

<span class="fc" id="L1136">        this.ch = charAt(++bpLocal);</span>

<span class="fc bfc" id="L1138" title="All 2 branches covered.">        if (ch == ',') {</span>
<span class="fc" id="L1139">            this.ch = charAt(++bpLocal);</span>
<span class="fc" id="L1140">            this.bp = bpLocal;</span>
<span class="fc" id="L1141">            token = JSONToken.COMMA;</span>
<span class="fc" id="L1142">            return VALUE;</span>
<span class="pc bpc" id="L1143" title="1 of 2 branches missed.">        } else if (ch == '}') {</span>
<span class="fc" id="L1144">            ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1145" title="All 2 branches covered.">            if (ch == ',') {</span>
<span class="fc" id="L1146">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1147">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1148" title="All 2 branches covered.">            } else if (ch == ']') {</span>
<span class="fc" id="L1149">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1150">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1151" title="All 2 branches covered.">            } else if (ch == '}') {</span>
<span class="fc" id="L1152">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1153">                this.ch = charAt(++bpLocal);</span>
<span class="fc bfc" id="L1154" title="All 2 branches covered.">            } else if (ch == EOI) {</span>
<span class="fc" id="L1155">                token = JSONToken.EOF;</span>
            } else {
<span class="fc" id="L1157">                return NOT_MATCH;</span>
            }
<span class="fc" id="L1159">            matchStat = END;</span>
        }

<span class="fc" id="L1162">        this.bp = bpLocal;</span>
<span class="fc" id="L1163">        return matchStat;</span>
    }

    public final boolean matchField(char[] fieldName) {
        for (;;) {
<span class="fc bfc" id="L1168" title="All 2 branches covered.">            if (!charArrayCompare(fieldName)) {</span>
<span class="fc bfc" id="L1169" title="All 2 branches covered.">                if (isWhitespace(ch)) {</span>
<span class="fc" id="L1170">                    next();</span>
<span class="fc" id="L1171">                    continue;</span>
                }
<span class="fc" id="L1173">                return false;</span>
            } else {
                break;
            }
        }

<span class="fc" id="L1179">        bp = bp + fieldName.length;</span>
<span class="fc" id="L1180">        ch = charAt(bp);</span>

<span class="fc bfc" id="L1182" title="All 2 branches covered.">        if (ch == '{') {</span>
<span class="fc" id="L1183">            next();</span>
<span class="fc" id="L1184">            token = JSONToken.LBRACE;</span>
<span class="fc bfc" id="L1185" title="All 2 branches covered.">        } else if (ch == '[') {</span>
<span class="fc" id="L1186">            next();</span>
<span class="fc" id="L1187">            token = JSONToken.LBRACKET;</span>
<span class="pc bpc" id="L1188" title="3 of 8 branches missed.">        } else if (ch == 'S' &amp;&amp; charAt(bp + 1) == 'e' &amp;&amp; charAt(bp + 2) == 't' &amp;&amp; charAt(bp + 3) == '[') {</span>
<span class="fc" id="L1189">            bp += 3;</span>
<span class="fc" id="L1190">            ch = charAt(bp);</span>
<span class="fc" id="L1191">            token = JSONToken.SET;</span>
        } else {
<span class="fc" id="L1193">            nextToken();</span>
        }

<span class="fc" id="L1196">        return true;</span>
    }

    public int matchField(long fieldNameHash) {
<span class="nc" id="L1200">        throw new UnsupportedOperationException();</span>
    }

    public boolean seekArrayToItem(int index) {
<span class="nc" id="L1204">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long fieldNameHash, boolean deepScan) {
<span class="nc" id="L1208">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToField(long[] fieldNameHash) {
<span class="nc" id="L1212">        throw new UnsupportedOperationException();</span>
    }

    public int seekObjectToFieldDeepScan(long fieldNameHash) {
<span class="nc" id="L1216">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject() {
<span class="nc" id="L1220">        throw new UnsupportedOperationException();</span>
    }

    public void skipObject(boolean valid) {
<span class="nc" id="L1224">        throw new UnsupportedOperationException();</span>
    }

    public void skipArray() {
<span class="nc" id="L1228">        throw new UnsupportedOperationException();</span>
    }

    public abstract int indexOf(char ch, int startIndex);

    public abstract String addSymbol(int offset, int len, int hash, final SymbolTable symbolTable);

    public String scanFieldString(char[] fieldName) {
<span class="fc" id="L1236">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1238" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1239">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1240">            return stringDefaultValue();</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1245">        int offset = fieldName.length;</span>
<span class="fc" id="L1246">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1248" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1249">            matchStat = NOT_MATCH;</span>

<span class="fc" id="L1251">            return stringDefaultValue();</span>
        }

        final String strVal;
        {
<span class="fc" id="L1256">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L1257">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1258" title="All 2 branches covered.">            if (endIndex == -1) {</span>
<span class="fc" id="L1259">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L1262">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L1263">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1264" title="All 2 branches covered.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="fc" id="L1266">                    int slashCount = 0;</span>
<span class="pc bpc" id="L1267" title="1 of 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1268" title="All 2 branches covered.">                        if (charAt(i) == '\\') {</span>
<span class="fc" id="L1269">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="fc bfc" id="L1274" title="All 2 branches covered.">                    if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1275">                        break;</span>
                    }
<span class="fc" id="L1277">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1278">                }</span>

<span class="fc" id="L1280">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="fc" id="L1281">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="fc" id="L1283">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L1286">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L1287">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1288">            strVal = stringVal;</span>
        }

<span class="fc bfc" id="L1291" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1292">            bp += offset;</span>
<span class="fc" id="L1293">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1294">            matchStat = VALUE;</span>
<span class="fc" id="L1295">            return strVal;</span>
        }

<span class="pc bpc" id="L1298" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L1299">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1300" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1301">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1302">                bp += offset;</span>
<span class="fc" id="L1303">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1304" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1305">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1306">                bp += offset;</span>
<span class="fc" id="L1307">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1308" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1309">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1310">                bp += offset;</span>
<span class="fc" id="L1311">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1312" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1313">                token = JSONToken.EOF;</span>
<span class="fc" id="L1314">                bp += (offset - 1);</span>
<span class="fc" id="L1315">                ch = EOI;</span>
            } else {
<span class="fc" id="L1317">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1318">                return stringDefaultValue();</span>
            }
<span class="fc" id="L1320">            matchStat = END;</span>
        } else {
<span class="nc" id="L1322">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1323">            return stringDefaultValue();</span>
        }

<span class="fc" id="L1326">        return strVal;</span>
    }

    public String scanString(char expectNextChar) {
<span class="fc" id="L1330">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1332">        int offset = 0;</span>
<span class="fc" id="L1333">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1335" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1336" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1337">                offset += 3;</span>
<span class="fc" id="L1338">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1340">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1341">                return null;</span>
            }

<span class="fc bfc" id="L1344" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1345">                bp += offset;</span>
<span class="fc" id="L1346">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1347">                matchStat = VALUE;</span>
<span class="fc" id="L1348">                return null;</span>
            } else {
<span class="fc" id="L1350">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1351">                return null;</span>
            }
        }

        final String strVal;
        for (;;) {
<span class="fc bfc" id="L1357" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1358">                int startIndex = bp + offset;</span>
<span class="fc" id="L1359">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1360" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1361">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1364">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1365" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (; ; ) {
<span class="fc" id="L1367">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1368" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1369" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1370">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1375" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1376">                            break;</span>
                        }
<span class="fc" id="L1378">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1379">                    }</span>

<span class="fc" id="L1381">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1382">                    char[] chars = sub_chars(bp + 1, chars_len);</span>

<span class="fc" id="L1384">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1387">                offset += (endIndex - startIndex + 1);</span>
<span class="fc" id="L1388">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1389">                strVal = stringVal;</span>
<span class="fc" id="L1390">                break;</span>
<span class="fc bfc" id="L1391" title="All 2 branches covered.">            } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1392">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1393">                continue;</span>
            } else {
<span class="fc" id="L1395">                matchStat = NOT_MATCH;</span>

<span class="fc" id="L1397">                return stringDefaultValue();</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1402" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L1403">                bp += offset;</span>
<span class="fc" id="L1404">                this.ch = charAt(bp);</span>
<span class="fc" id="L1405">                matchStat = VALUE;</span>
<span class="fc" id="L1406">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1407">                return strVal;</span>
<span class="pc bpc" id="L1408" title="1 of 2 branches missed.">            } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L1409">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1410">                continue;</span>
            } else {
<span class="fc" id="L1412">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1413">                return strVal;</span>
            }
        }
    }

    public long scanFieldSymbol(char[] fieldName) {
<span class="nc" id="L1419">        matchStat = UNKNOWN;</span>

<span class="nc bnc" id="L1421" title="All 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1422">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1423">            return 0;</span>
        }

<span class="nc" id="L1426">        int offset = fieldName.length;</span>
<span class="nc" id="L1427">        char chLocal = charAt(bp + (offset++));</span>

<span class="nc bnc" id="L1429" title="All 2 branches missed.">        if (chLocal != '&quot;') {</span>
<span class="nc" id="L1430">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1431">            return 0;</span>
        }

<span class="nc" id="L1434">        long hash = 0xcbf29ce484222325L;</span>
        for (;;) {
<span class="nc" id="L1436">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1437" title="All 2 branches missed.">            if (chLocal == '\&quot;') {</span>
<span class="nc" id="L1438">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L1439">                break;</span>
            }

<span class="nc" id="L1442">            hash ^= chLocal;</span>
<span class="nc" id="L1443">            hash *= 0x100000001b3L;</span>

<span class="nc bnc" id="L1445" title="All 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1446">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1447">                return 0;</span>
            }
        }

<span class="nc bnc" id="L1451" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L1452">            bp += offset;</span>
<span class="nc" id="L1453">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L1454">            matchStat = VALUE;</span>
<span class="nc" id="L1455">            return hash;</span>
        }

<span class="nc bnc" id="L1458" title="All 2 branches missed.">        if (chLocal == '}') {</span>
<span class="nc" id="L1459">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L1460" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L1461">                token = JSONToken.COMMA;</span>
<span class="nc" id="L1462">                bp += offset;</span>
<span class="nc" id="L1463">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1464" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L1465">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L1466">                bp += offset;</span>
<span class="nc" id="L1467">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1468" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L1469">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L1470">                bp += offset;</span>
<span class="nc" id="L1471">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L1472" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L1473">                token = JSONToken.EOF;</span>
<span class="nc" id="L1474">                bp += (offset - 1);</span>
<span class="nc" id="L1475">                ch = EOI;</span>
            } else {
<span class="nc" id="L1477">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1478">                return 0;</span>
            }
<span class="nc" id="L1480">            matchStat = END;</span>
        } else {
<span class="nc" id="L1482">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L1483">            return 0;</span>
        }

<span class="nc" id="L1486">        return hash;</span>
    }

    public long scanEnumSymbol(char[] fieldName) {
<span class="fc" id="L1490">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1492" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1493">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1494">            return 0;</span>
        }

<span class="fc" id="L1497">        int offset = fieldName.length;</span>
<span class="fc" id="L1498">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1500" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1501">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1502">            return 0;</span>
        }

<span class="fc" id="L1505">        long hash = 0xcbf29ce484222325L;</span>
        for (;;) {
<span class="fc" id="L1507">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1508" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
<span class="fc" id="L1509">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1510">                break;</span>
            }

<span class="fc bfc" id="L1513" title="All 4 branches covered.">            hash ^= ((chLocal &gt;= 'A' &amp;&amp; chLocal &lt;= 'Z') ? (chLocal + 32) : chLocal);</span>
<span class="fc" id="L1514">            hash *= 0x100000001b3L;</span>

<span class="fc bfc" id="L1516" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc" id="L1517">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1518">                return 0;</span>
            }
        }

<span class="fc bfc" id="L1522" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1523">            bp += offset;</span>
<span class="fc" id="L1524">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1525">            matchStat = VALUE;</span>
<span class="fc" id="L1526">            return hash;</span>
        }

<span class="fc bfc" id="L1529" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1530">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1531" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1532">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1533">                bp += offset;</span>
<span class="fc" id="L1534">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1535" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1536">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1537">                bp += offset;</span>
<span class="fc" id="L1538">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1539" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1540">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1541">                bp += offset;</span>
<span class="fc" id="L1542">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1543" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1544">                token = JSONToken.EOF;</span>
<span class="fc" id="L1545">                bp += (offset - 1);</span>
<span class="fc" id="L1546">                ch = EOI;</span>
            } else {
<span class="fc" id="L1548">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1549">                return 0;</span>
            }
<span class="fc" id="L1551">            matchStat = END;</span>
        } else {
<span class="fc" id="L1553">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1554">            return 0;</span>
        }

<span class="fc" id="L1557">        return hash;</span>
    }

    @SuppressWarnings({ &quot;unchecked&quot;, &quot;rawtypes&quot; })
    public Enum&lt;?&gt; scanEnum(Class&lt;?&gt; enumClass, final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1562">        String name = scanSymbolWithSeperator(symbolTable, serperator);</span>
<span class="fc bfc" id="L1563" title="All 2 branches covered.">        if (name == null) {</span>
<span class="fc" id="L1564">            return null;</span>
        }
<span class="fc" id="L1566">        return Enum.valueOf((Class&lt;? extends Enum&gt;) enumClass, name);</span>
    }

    public String scanSymbolWithSeperator(final SymbolTable symbolTable, char serperator) {
<span class="fc" id="L1570">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1572">        int offset = 0;</span>
<span class="fc" id="L1573">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1575" title="All 2 branches covered.">        if (chLocal == 'n') {</span>
<span class="fc bfc" id="L1576" title="All 6 branches covered.">            if (charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1577">                offset += 3;</span>
<span class="fc" id="L1578">                chLocal = charAt(bp + (offset++));</span>
            } else {
<span class="fc" id="L1580">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1581">                return null;</span>
            }

<span class="fc bfc" id="L1584" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1585">                bp += offset;</span>
<span class="fc" id="L1586">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1587">                matchStat = VALUE;</span>
<span class="fc" id="L1588">                return null;</span>
            } else {
<span class="fc" id="L1590">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1591">                return null;</span>
            }
        }

<span class="fc bfc" id="L1595" title="All 2 branches covered.">        if (chLocal != '&quot;') {</span>
<span class="fc" id="L1596">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1597">            return null;</span>
        }

        String strVal;
        // int start = index;
<span class="fc" id="L1602">        int hash = 0;</span>
        for (;;) {
<span class="fc" id="L1604">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1605" title="All 2 branches covered.">            if (chLocal == '\&quot;') {</span>
                // bp = index;
                // this.ch = chLocal = charAt(bp);
<span class="fc" id="L1608">                int start = bp + 0 + 1;</span>
<span class="fc" id="L1609">                int len = bp + offset - start - 1;</span>
<span class="fc" id="L1610">                strVal = addSymbol(start, len, hash, symbolTable);</span>
<span class="fc" id="L1611">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1612">                break;</span>
            }

<span class="fc" id="L1615">            hash = 31 * hash + chLocal;</span>

<span class="pc bpc" id="L1617" title="1 of 2 branches missed.">            if (chLocal == '\\') {</span>
<span class="nc" id="L1618">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1619">                return null;</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L1624" title="All 2 branches covered.">            if (chLocal == serperator) {</span>
<span class="fc" id="L1625">                bp += offset;</span>
<span class="fc" id="L1626">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L1627">                matchStat = VALUE;</span>
<span class="fc" id="L1628">                return strVal;</span>
            } else {
<span class="pc bpc" id="L1630" title="1 of 2 branches missed.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L1631">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1632">                    continue;</span>
                }

<span class="nc" id="L1635">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L1636">                return strVal;</span>
            }
        }
    }

    public Collection&lt;String&gt; newCollectionByType(Class&lt;?&gt; type){
<span class="fc bfc" id="L1642" title="All 2 branches covered.">        if (type.isAssignableFrom(HashSet.class)) {</span>
<span class="fc" id="L1643">            HashSet&lt;String&gt; list = new HashSet&lt;String&gt;();</span>
<span class="fc" id="L1644">            return list;</span>
<span class="fc bfc" id="L1645" title="All 2 branches covered.">        } else if (type.isAssignableFrom(ArrayList.class)) {</span>
<span class="fc" id="L1646">            ArrayList&lt;String&gt; list2 = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L1647">            return list2;</span>
        } else {
            try {
<span class="fc" id="L1650">                Collection&lt;String&gt; list = (Collection&lt;String&gt;) type.newInstance();</span>
<span class="fc" id="L1651">                return list;</span>
<span class="fc" id="L1652">            } catch (Exception e) {</span>
<span class="fc" id="L1653">                throw new JSONException(e.getMessage(), e);</span>
            }
        }
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    public Collection&lt;String&gt; scanFieldStringArray(char[] fieldName, Class&lt;?&gt; type) {
<span class="fc" id="L1660">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1662" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1663">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1664">            return null;</span>
        }

<span class="fc" id="L1667">        Collection&lt;String&gt; list = newCollectionByType(type);</span>

//        if (type.isAssignableFrom(HashSet.class)) {
//            list = new HashSet&lt;String&gt;();
//        } else if (type.isAssignableFrom(ArrayList.class)) {
//            list = new ArrayList&lt;String&gt;();
//        } else {
//            try {
//                list = (Collection&lt;String&gt;) type.newInstance();
//            } catch (Exception e) {
//                throw new JSONException(e.getMessage(), e);
//            }
//        }

        // int index = bp + fieldName.length;

<span class="fc" id="L1683">        int offset = fieldName.length;</span>
<span class="fc" id="L1684">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1686" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1687">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1688">            return null;</span>
        }

<span class="fc" id="L1691">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
            // int start = index;
<span class="fc bfc" id="L1695" title="All 2 branches covered.">            if (chLocal == '&quot;') {</span>
<span class="fc" id="L1696">                int startIndex = bp + offset;</span>
<span class="fc" id="L1697">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1698" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1699">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1702">                int startIndex2 = bp + offset; // must re compute</span>
<span class="fc" id="L1703">                String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="fc bfc" id="L1704" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="fc" id="L1706">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1707" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1708" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1709">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1714" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1715">                            break;</span>
                        }
<span class="fc" id="L1717">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1718">                    }</span>

<span class="fc" id="L1720">                    int chars_len = endIndex - (bp + offset);</span>
<span class="fc" id="L1721">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1723">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1726">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1727">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1729">                list.add(stringVal);</span>
<span class="fc bfc" id="L1730" title="All 2 branches covered.">            } else if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1731" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1732" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1733" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1734">                offset += 3;</span>
<span class="fc" id="L1735">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1736">                list.add(null);</span>
<span class="fc bfc" id="L1737" title="All 4 branches covered.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1738">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1739">                break;</span>
            } else {
<span class="fc" id="L1741">                throw new JSONException(&quot;illega str&quot;);</span>
            }

<span class="fc bfc" id="L1744" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1745">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1746">                continue;</span>
            }

<span class="fc bfc" id="L1749" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1750">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1751">                break;</span>
            }

<span class="fc" id="L1754">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1755">            return null;</span>
        }

<span class="fc bfc" id="L1758" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1759">            bp += offset;</span>
<span class="fc" id="L1760">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1761">            matchStat = VALUE;</span>
<span class="fc" id="L1762">            return list;</span>
        }

<span class="fc bfc" id="L1765" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1766">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1767" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1768">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1769">                bp += offset;</span>
<span class="fc" id="L1770">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1771" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1772">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1773">                bp += offset;</span>
<span class="fc" id="L1774">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1775" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1776">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1777">                bp += offset;</span>
<span class="fc" id="L1778">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1779" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1780">                bp += (offset - 1);</span>
<span class="fc" id="L1781">                token = JSONToken.EOF;</span>
<span class="fc" id="L1782">                this.ch = EOI;</span>
            } else {
<span class="fc" id="L1784">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1785">                return null;</span>
            }
<span class="fc" id="L1787">            matchStat = END;</span>
        } else {
<span class="fc" id="L1789">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1790">            return null;</span>
        }

<span class="fc" id="L1793">        return list;</span>
    }

    public void scanStringArray(Collection&lt;String&gt; list, char seperator) {
<span class="fc" id="L1797">        matchStat = UNKNOWN;</span>

<span class="fc" id="L1799">        int offset = 0;</span>
<span class="fc" id="L1800">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1802" title="All 2 branches covered.">        if (chLocal == 'n'</span>
<span class="fc bfc" id="L1803" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset) == 'u'</span>
<span class="fc bfc" id="L1804" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 1) == 'l'</span>
<span class="fc bfc" id="L1805" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 2) == 'l'</span>
<span class="fc bfc" id="L1806" title="All 2 branches covered.">                &amp;&amp; charAt(bp + offset + 3) == seperator</span>
        ) {
<span class="fc" id="L1808">            bp += 5;</span>
<span class="fc" id="L1809">            ch = charAt(bp);</span>
<span class="fc" id="L1810">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L1811">            return;</span>
        }

<span class="fc bfc" id="L1814" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1815">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1816">            return;</span>
        }

<span class="fc" id="L1819">        chLocal = charAt(bp + (offset++));</span>

        for (;;) {
<span class="fc bfc" id="L1822" title="All 2 branches covered.">            if (chLocal == 'n' //</span>
<span class="fc bfc" id="L1823" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset) == 'u' //</span>
<span class="fc bfc" id="L1824" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L1825" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L1826">                offset += 3;</span>
<span class="fc" id="L1827">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1828">                list.add(null);</span>
<span class="pc bpc" id="L1829" title="1 of 4 branches missed.">            } else if (chLocal == ']' &amp;&amp; list.size() == 0) {</span>
<span class="fc" id="L1830">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1831">                break;</span>
<span class="fc bfc" id="L1832" title="All 2 branches covered.">            } else if (chLocal != '&quot;') {</span>
<span class="fc" id="L1833">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1834">                return;</span>
            } else {
<span class="fc" id="L1836">                int startIndex = bp + offset;</span>
<span class="fc" id="L1837">                int endIndex = indexOf('&quot;', startIndex);</span>
<span class="fc bfc" id="L1838" title="All 2 branches covered.">                if (endIndex == -1) {</span>
<span class="fc" id="L1839">                    throw new JSONException(&quot;unclosed str&quot;);</span>
                }

<span class="fc" id="L1842">                String stringVal = subString(bp + offset, endIndex - startIndex);</span>
<span class="fc bfc" id="L1843" title="All 2 branches covered.">                if (stringVal.indexOf('\\') != -1) {</span>
                    for (;;) {
<span class="fc" id="L1845">                        int slashCount = 0;</span>
<span class="pc bpc" id="L1846" title="1 of 2 branches missed.">                        for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="fc bfc" id="L1847" title="All 2 branches covered.">                            if (charAt(i) == '\\') {</span>
<span class="fc" id="L1848">                                slashCount++;</span>
                            } else {
                                break;
                            }
                        }
<span class="fc bfc" id="L1853" title="All 2 branches covered.">                        if (slashCount % 2 == 0) {</span>
<span class="fc" id="L1854">                            break;</span>
                        }
<span class="fc" id="L1856">                        endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="fc" id="L1857">                    }</span>

<span class="fc" id="L1859">                    int chars_len = endIndex - startIndex;</span>
<span class="fc" id="L1860">                    char[] chars = sub_chars(bp + offset, chars_len);</span>

<span class="fc" id="L1862">                    stringVal = readString(chars, chars_len);</span>
                }

<span class="fc" id="L1865">                offset += (endIndex - (bp + offset) + 1);</span>
<span class="fc" id="L1866">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1867">                list.add(stringVal);</span>
            }

<span class="fc bfc" id="L1870" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1871">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1872">                continue;</span>
            }

<span class="fc bfc" id="L1875" title="All 2 branches covered.">            if (chLocal == ']') {</span>
<span class="fc" id="L1876">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L1877">                break;</span>
            }

<span class="fc" id="L1880">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1881">            return;</span>
        }

<span class="fc bfc" id="L1884" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L1885">            bp += offset;</span>
<span class="fc" id="L1886">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1887">            matchStat = VALUE;</span>
<span class="fc" id="L1888">            return;</span>
        } else {
<span class="fc" id="L1890">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1891">            return;</span>
        }
    }

    public int scanFieldInt(char[] fieldName) {
<span class="fc" id="L1896">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L1898" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L1899">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1900">            return 0;</span>
        }

<span class="fc" id="L1903">        int offset = fieldName.length;</span>
<span class="fc" id="L1904">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1906" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L1907" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L1908">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="pc bpc" id="L1912" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1913">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L1915">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1916" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L1917">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L1918" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L1919">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1920">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L1925" title="All 4 branches covered.">            if (value &lt; 0 //</span>
                    || offset &gt; 11 + 3 + fieldName.length) {
<span class="pc bpc" id="L1927" title="1 of 6 branches missed.">                if (value != Integer.MIN_VALUE //</span>
                        || offset != 17 //
                        || !negative) {
<span class="fc" id="L1930">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L1931">                    return 0;</span>
                }
            }
        } else {
<span class="fc" id="L1935">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1936">            return 0;</span>
        }

<span class="fc bfc" id="L1939" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L1940">            bp += offset;</span>
<span class="fc" id="L1941">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L1942">            matchStat = VALUE;</span>
<span class="fc" id="L1943">            token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L1944" title="All 2 branches covered.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L1947" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L1948">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L1949" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L1950">                token = JSONToken.COMMA;</span>
<span class="fc" id="L1951">                bp += offset;</span>
<span class="fc" id="L1952">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1953" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L1954">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L1955">                bp += offset;</span>
<span class="fc" id="L1956">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1957" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L1958">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L1959">                bp += offset;</span>
<span class="fc" id="L1960">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L1961" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L1962">                token = JSONToken.EOF;</span>
<span class="fc" id="L1963">                bp += (offset - 1);</span>
<span class="fc" id="L1964">                ch = EOI;</span>
            } else {
<span class="fc" id="L1966">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L1967">                return 0;</span>
            }
<span class="fc" id="L1969">            matchStat = END;</span>
        } else {
<span class="fc" id="L1971">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L1972">            return 0;</span>
        }

<span class="fc bfc" id="L1975" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public final int[] scanFieldIntArray(char[] fieldName) {
<span class="fc" id="L1979">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L1981" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L1982">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L1983">            return null;</span>
        }

<span class="fc" id="L1986">        int offset = fieldName.length;</span>
<span class="fc" id="L1987">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L1989" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L1990">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L1991">            return null;</span>
        }
<span class="fc" id="L1993">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L1995">        int[] array = new int[16];</span>
<span class="fc" id="L1996">        int arrayIndex = 0;</span>

<span class="pc bpc" id="L1998" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L1999">            chLocal = charAt(bp + (offset++));</span>
        } else {
            for (;;) {
<span class="fc" id="L2002">                boolean nagative = false;</span>
<span class="pc bpc" id="L2003" title="1 of 2 branches missed.">                if (chLocal == '-') {</span>
<span class="nc" id="L2004">                    chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L2005">                    nagative = true;</span>
                }
<span class="pc bpc" id="L2007" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2008">                    int value = chLocal - '0';</span>
                    for (; ; ) {
<span class="fc" id="L2010">                        chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2012" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2013">                            value = value * 10 + (chLocal - '0');</span>
                        } else {
                            break;
                        }
                    }

<span class="pc bpc" id="L2019" title="1 of 2 branches missed.">                    if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L2020">                        int[] tmp = new int[array.length * 3 / 2];</span>
<span class="nc" id="L2021">                        System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L2022">                        array = tmp;</span>
                    }
<span class="pc bpc" id="L2024" title="1 of 2 branches missed.">                    array[arrayIndex++] = nagative ? -value : value;</span>

<span class="fc bfc" id="L2026" title="All 2 branches covered.">                    if (chLocal == ',') {</span>
<span class="fc" id="L2027">                        chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2028" title="1 of 2 branches missed.">                    } else if (chLocal == ']') {</span>
<span class="fc" id="L2029">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2030">                        break;</span>
                    }
<span class="fc" id="L2032">                } else {</span>
<span class="fc" id="L2033">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2034">                    return null;</span>
                }
<span class="fc" id="L2036">            }</span>
        }


<span class="pc bpc" id="L2040" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L2041">            int[] tmp = new int[arrayIndex];</span>
<span class="fc" id="L2042">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L2043">            array = tmp;</span>
        }

<span class="pc bpc" id="L2046" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L2047">            bp += (offset - 1);</span>
<span class="nc" id="L2048">            this.next();</span>
<span class="nc" id="L2049">            matchStat = VALUE;</span>
<span class="nc" id="L2050">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2051">            return array;</span>
        }

<span class="pc bpc" id="L2054" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2055">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2056" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2057">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2058">                bp += (offset - 1);</span>
<span class="fc" id="L2059">                this.next();</span>
<span class="fc bfc" id="L2060" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2061">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2062">                bp += (offset - 1);</span>
<span class="fc" id="L2063">                this.next();</span>
<span class="pc bpc" id="L2064" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L2065">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L2066">                bp += (offset - 1);</span>
<span class="nc" id="L2067">                this.next();</span>
<span class="pc bpc" id="L2068" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2069">                bp += (offset - 1);</span>
<span class="fc" id="L2070">                token = JSONToken.EOF;</span>
<span class="fc" id="L2071">                ch = EOI;</span>
            } else {
<span class="nc" id="L2073">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2074">                return null;</span>
            }
<span class="fc" id="L2076">            matchStat = END;</span>
        } else {
<span class="nc" id="L2078">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2079">            return null;</span>
        }

<span class="fc" id="L2082">        return array;</span>
    }

    public boolean scanBoolean(char expectNext) {
<span class="fc" id="L2086">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2088">        int offset = 0;</span>
<span class="fc" id="L2089">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2091">        boolean value = false;</span>
<span class="fc bfc" id="L2092" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2093" title="All 2 branches covered.">            if (charAt(bp + offset) == 'r' //</span>
<span class="fc bfc" id="L2094" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'u' //</span>
<span class="fc bfc" id="L2095" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 'e') {</span>
<span class="fc" id="L2096">                offset += 3;</span>
<span class="fc" id="L2097">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2098">                value = true;</span>
            } else {
<span class="fc" id="L2100">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2101">                return false;</span>
            }
<span class="fc bfc" id="L2103" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2104" title="All 2 branches covered.">            if (charAt(bp + offset) == 'a' //</span>
<span class="fc bfc" id="L2105" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 1) == 'l' //</span>
<span class="fc bfc" id="L2106" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 2) == 's' //</span>
<span class="fc bfc" id="L2107" title="All 2 branches covered.">                    &amp;&amp; charAt(bp + offset + 3) == 'e') {</span>
<span class="fc" id="L2108">                offset += 4;</span>
<span class="fc" id="L2109">                chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2110">                value = false;</span>
            } else {
<span class="fc" id="L2112">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2113">                return false;</span>
            }
<span class="fc bfc" id="L2115" title="All 2 branches covered.">        } else if (chLocal == '1') {</span>
<span class="fc" id="L2116">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2117">            value = true;</span>
<span class="pc bpc" id="L2118" title="1 of 2 branches missed.">        } else if (chLocal == '0') {</span>
<span class="fc" id="L2119">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2120">            value = false;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2124" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2125">                bp += offset;</span>
<span class="fc" id="L2126">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2127">                matchStat = VALUE;</span>
<span class="fc" id="L2128">                return value;</span>
            } else {
<span class="fc bfc" id="L2130" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2131">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2132">                    continue;</span>
                }
<span class="fc" id="L2134">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2135">                return value;</span>
            }
        }
    }

    public int scanInt(char expectNext) {
<span class="fc" id="L2141">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2143">        int offset = 0;</span>
<span class="fc" id="L2144">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2146" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2147" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2148">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2151" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2152" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2153">            chLocal = charAt(bp + (offset++));</span>
        }

        int value;
<span class="fc bfc" id="L2157" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2158">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2160">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2161" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2162">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2163" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2164">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2165">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="fc bfc" id="L2170" title="All 2 branches covered.">            if (value &lt; 0) {</span>
<span class="fc" id="L2171">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2172">                return 0;</span>
            }
<span class="pc bpc" id="L2174" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2175">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2176">            value = 0;</span>
<span class="fc" id="L2177">            offset += 3;</span>
<span class="fc" id="L2178">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2180" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2181">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2185" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2186">                    bp += offset;</span>
<span class="fc" id="L2187">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2188">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2189">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2190">                    return value;</span>
<span class="fc bfc" id="L2191" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2192">                    bp += offset;</span>
<span class="fc" id="L2193">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2194">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2195">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2196">                    return value;</span>
<span class="pc bpc" id="L2197" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2198">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2199">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2203">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2204">            return 0;</span>
        } else {
<span class="fc" id="L2206">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2207">            return 0;</span>
        }

        for (;;) {
<span class="fc bfc" id="L2211" title="All 2 branches covered.">            if (chLocal == expectNext) {</span>
<span class="fc" id="L2212">                bp += offset;</span>
<span class="fc" id="L2213">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2214">                matchStat = VALUE;</span>
<span class="fc" id="L2215">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2216" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2218" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2219">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2220">                    continue;</span>
                }
<span class="fc" id="L2222">                matchStat = NOT_MATCH;</span>
<span class="fc bfc" id="L2223" title="All 2 branches covered.">                return negative ? -value : value;</span>
            }
        }
    }

    public boolean scanFieldBoolean(char[] fieldName) {
<span class="fc" id="L2229">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2231" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2232">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2233">            return false;</span>
        }

<span class="fc" id="L2236">        int offset = fieldName.length;</span>
<span class="fc" id="L2237">        char chLocal = charAt(bp + (offset++));</span>

        boolean value;
<span class="fc bfc" id="L2240" title="All 2 branches covered.">        if (chLocal == 't') {</span>
<span class="fc bfc" id="L2241" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'r') {</span>
<span class="fc" id="L2242">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2243">                return false;</span>
            }
<span class="fc bfc" id="L2245" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'u') {</span>
<span class="fc" id="L2246">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2247">                return false;</span>
            }
<span class="fc bfc" id="L2249" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2250">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2251">                return false;</span>
            }

<span class="fc" id="L2254">            value = true;</span>
<span class="fc bfc" id="L2255" title="All 2 branches covered.">        } else if (chLocal == 'f') {</span>
<span class="fc bfc" id="L2256" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'a') {</span>
<span class="fc" id="L2257">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2258">                return false;</span>
            }
<span class="fc bfc" id="L2260" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'l') {</span>
<span class="fc" id="L2261">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2262">                return false;</span>
            }
<span class="fc bfc" id="L2264" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 's') {</span>
<span class="fc" id="L2265">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2266">                return false;</span>
            }
<span class="fc bfc" id="L2268" title="All 2 branches covered.">            if (charAt(bp + (offset++)) != 'e') {</span>
<span class="fc" id="L2269">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2270">                return false;</span>
            }

<span class="fc" id="L2273">            value = false;</span>
        } else {
<span class="fc" id="L2275">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2276">            return false;</span>
        }

<span class="fc" id="L2279">        chLocal = charAt(bp + offset++);</span>
<span class="fc bfc" id="L2280" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2281">            bp += offset;</span>
<span class="fc" id="L2282">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2283">            matchStat = VALUE;</span>
<span class="fc" id="L2284">            token = JSONToken.COMMA;</span>

<span class="fc" id="L2286">            return value;</span>
        }

<span class="pc bpc" id="L2289" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L2290">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2291" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2292">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2293">                bp += offset;</span>
<span class="fc" id="L2294">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2295" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2296">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2297">                bp += offset;</span>
<span class="fc" id="L2298">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2299" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2300">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2301">                bp += offset;</span>
<span class="fc" id="L2302">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2303" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2304">                token = JSONToken.EOF;</span>
<span class="fc" id="L2305">                bp += (offset - 1);</span>
<span class="fc" id="L2306">                ch = EOI;</span>
            } else {
<span class="fc" id="L2308">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2309">                return false;</span>
            }
<span class="fc" id="L2311">            matchStat = END;</span>
        } else {
<span class="nc" id="L2313">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2314">            return false;</span>
        }

<span class="fc" id="L2317">        return value;</span>
    }

    public long scanFieldLong(char[] fieldName) {
<span class="fc" id="L2321">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2323" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2324">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2325">            return 0;</span>
        }

<span class="fc" id="L2328">        int offset = fieldName.length;</span>
<span class="fc" id="L2329">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L2331">        boolean negative = false;</span>
<span class="fc bfc" id="L2332" title="All 2 branches covered.">        if (chLocal == '-') {</span>
<span class="fc" id="L2333">            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2334">            negative = true;</span>
        }

        long value;
<span class="fc bfc" id="L2338" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2339">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2341">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2342" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2343">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2344" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2345">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2346">                    return 0;</span>
                } else {
                    break;
                }
            }

<span class="pc bpc" id="L2352" title="2 of 8 branches missed.">            boolean valid = offset - fieldName.length &lt; 21</span>
                    &amp;&amp; (value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative));
<span class="fc bfc" id="L2354" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2355">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2356">                return 0;</span>
            }
<span class="fc" id="L2358">        } else {</span>
<span class="fc" id="L2359">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2360">            return 0;</span>
        }

<span class="fc bfc" id="L2363" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2364">            bp += offset;</span>
<span class="fc" id="L2365">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2366">            matchStat = VALUE;</span>
<span class="fc" id="L2367">            token = JSONToken.COMMA;</span>
<span class="pc bpc" id="L2368" title="1 of 2 branches missed.">            return negative ? -value : value;</span>
        }

<span class="fc bfc" id="L2371" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2372">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2373" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2374">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2375">                bp += offset;</span>
<span class="fc" id="L2376">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2377" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2378">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2379">                bp += offset;</span>
<span class="fc" id="L2380">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2381" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2382">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2383">                bp += offset;</span>
<span class="fc" id="L2384">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2385" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2386">                token = JSONToken.EOF;</span>
<span class="fc" id="L2387">                bp += (offset - 1);</span>
<span class="fc" id="L2388">                ch = EOI;</span>
            } else {
<span class="fc" id="L2390">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2391">                return 0;</span>
            }
<span class="fc" id="L2393">            matchStat = END;</span>
        } else {
<span class="fc" id="L2395">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2396">            return 0;</span>
        }

<span class="fc bfc" id="L2399" title="All 2 branches covered.">        return negative ? -value : value;</span>
    }

    public long scanLong(char expectNextChar) {
<span class="fc" id="L2403">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2405">        int offset = 0;</span>
<span class="fc" id="L2406">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2407" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2408" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2409">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2412" title="All 2 branches covered.">        final boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2413" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2414">            chLocal = charAt(bp + (offset++));</span>
        }

        long value;
<span class="fc bfc" id="L2418" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2419">            value = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2421">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2422" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2423">                    value = value * 10 + (chLocal - '0');</span>
<span class="fc bfc" id="L2424" title="All 2 branches covered.">                } else if (chLocal == '.') {</span>
<span class="fc" id="L2425">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2426">                    return 0;</span>
                } else {
                    break;
                }
            }
<span class="pc bpc" id="L2431" title="1 of 6 branches missed.">            boolean valid = value &gt;= 0 || (value == -9223372036854775808L &amp;&amp; negative);</span>
<span class="fc bfc" id="L2432" title="All 2 branches covered.">            if (!valid) {</span>
<span class="fc" id="L2433">                String val = subString(bp, offset - 1);</span>
<span class="fc" id="L2434">                throw new NumberFormatException(val);</span>
            }
<span class="pc bpc" id="L2436" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2437">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2438">            value = 0;</span>
<span class="fc" id="L2439">            offset += 3;</span>
<span class="fc" id="L2440">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2442" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2443">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2447" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2448">                    bp += offset;</span>
<span class="fc" id="L2449">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2450">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2451">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2452">                    return value;</span>
<span class="fc bfc" id="L2453" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2454">                    bp += offset;</span>
<span class="fc" id="L2455">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2456">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2457">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2458">                    return value;</span>
<span class="pc bpc" id="L2459" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2460">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2461">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2465">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2466">            return 0;</span>
        } else {
<span class="fc" id="L2468">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2469">            return 0;</span>
        }

<span class="fc bfc" id="L2472" title="All 2 branches covered.">        if (quote) {</span>
<span class="pc bpc" id="L2473" title="1 of 2 branches missed.">            if (chLocal != '&quot;') {</span>
<span class="nc" id="L2474">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L2475">                return 0;</span>
            } else {
<span class="fc" id="L2477">                chLocal = charAt(bp + (offset++));</span>
            }
        }

        for (;;) {
<span class="fc bfc" id="L2482" title="All 2 branches covered.">            if (chLocal == expectNextChar) {</span>
<span class="fc" id="L2483">                bp += offset;</span>
<span class="fc" id="L2484">                this.ch = this.charAt(bp);</span>
<span class="fc" id="L2485">                matchStat = VALUE;</span>
<span class="fc" id="L2486">                token = JSONToken.COMMA;</span>
<span class="fc bfc" id="L2487" title="All 2 branches covered.">                return negative ? -value : value;</span>
            } else {
<span class="fc bfc" id="L2489" title="All 2 branches covered.">                if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2490">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L2491">                    continue;</span>
                }

<span class="fc" id="L2494">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2495">                return value;</span>
            }
        }
    }

    public final float scanFieldFloat(char[] fieldName) {
<span class="fc" id="L2501">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L2503" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L2504">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L2505">            return 0;</span>
        }

<span class="fc" id="L2508">        int offset = fieldName.length;</span>
<span class="fc" id="L2509">        char chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L2511" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2512" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2513">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2516" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2517" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2518">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="fc bfc" id="L2522" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2523">            long intVal = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L2525">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2526" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2527">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2528">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2534">            long power = 1;</span>
<span class="fc bfc" id="L2535" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2536" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2537">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2538" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2539">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2540">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L2542">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2543" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2544">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2545">                            power *= 10;</span>
<span class="fc" id="L2546">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2552">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2553">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2557" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2558" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2559">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2560" title="1 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2561">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="pc bpc" id="L2564" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2565">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L2573" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2574" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2575">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2576">                    return 0;</span>
                } else {
<span class="fc" id="L2578">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2580">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L2581">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2583">                start = bp + fieldName.length;</span>
<span class="fc" id="L2584">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2587" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2588">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2589" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2590">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L2593">                String text = this.subString(start, count);</span>
<span class="fc" id="L2594">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2596" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2597">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2598">            value = 0;</span>
<span class="fc" id="L2599">            offset += 3;</span>
<span class="fc" id="L2600">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2602" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2603">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2607" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2608">                    bp += offset;</span>
<span class="fc" id="L2609">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2610">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2611">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2612">                    return value;</span>
<span class="fc bfc" id="L2613" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L2614">                    bp += offset;</span>
<span class="fc" id="L2615">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2616">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2617">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L2618">                    return value;</span>
<span class="pc bpc" id="L2619" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2620">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2621">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2625">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2626">            return 0;</span>
        } else {
<span class="fc" id="L2628">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2629">            return 0;</span>
        }

<span class="fc bfc" id="L2632" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L2633">            bp += offset;</span>
<span class="fc" id="L2634">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2635">            matchStat = VALUE;</span>
<span class="fc" id="L2636">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2637">            return value;</span>
        }

<span class="fc bfc" id="L2640" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L2641">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2642" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L2643">                token = JSONToken.COMMA;</span>
<span class="fc" id="L2644">                bp += offset;</span>
<span class="fc" id="L2645">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2646" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L2647">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2648">                bp += offset;</span>
<span class="fc" id="L2649">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2650" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L2651">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L2652">                bp += offset;</span>
<span class="fc" id="L2653">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L2654" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L2655">                bp += (offset - 1);</span>
<span class="fc" id="L2656">                token = JSONToken.EOF;</span>
<span class="fc" id="L2657">                ch = EOI;</span>
            } else {
<span class="fc" id="L2659">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L2660">                return 0;</span>
            }
<span class="fc" id="L2662">            matchStat = END;</span>
        } else {
<span class="fc" id="L2664">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2665">            return 0;</span>
        }

<span class="fc" id="L2668">        return value;</span>
    }

    public final float scanFloat(char seperator) {
<span class="fc" id="L2672">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2674">        int offset = 0;</span>
<span class="fc" id="L2675">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2676" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L2677" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L2678">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L2681" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L2682" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L2683">            chLocal = charAt(bp + (offset++));</span>
        }

        float value;
<span class="pc bpc" id="L2687" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2688">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="fc" id="L2690">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2691" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2692">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2693">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L2699">            long power = 1;</span>
<span class="fc bfc" id="L2700" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L2701" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L2702">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2703" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2704">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2705">                    power = 10;</span>
                    for (; ; ) {
<span class="fc" id="L2707">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L2708" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2709">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L2710">                            power *= 10;</span>
<span class="fc" id="L2711">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L2717">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L2718">                    return 0;</span>
                }
            }

<span class="pc bpc" id="L2722" title="1 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L2723" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L2724">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2725" title="2 of 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L2726">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="pc bpc" id="L2729" title="1 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L2730">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }
//            int start, count;
//            if (quote) {
//                if (chLocal != '&quot;') {
//                    matchStat = NOT_MATCH;
//                    return 0;
//                } else {
//                    chLocal = charAt(bp + (offset++));
//                }
//                start = bp + 1;
//                count = bp + offset - start - 2;
//            } else {
//                start = bp;
//                count = bp + offset - start - 1;
//            }
//            String text = this.subString(start, count);
//            value = Float.parseFloat(text);
            int start, count;
<span class="fc bfc" id="L2753" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L2754" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2755">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2756">                    return 0;</span>
                } else {
<span class="fc" id="L2758">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L2760">                start = bp + 1;</span>
<span class="fc" id="L2761">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L2763">                start = bp;</span>
<span class="fc" id="L2764">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L2767" title="All 4 branches covered.">            if ((!exp) &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L2768">                value = (float) (((double) intVal) / power);</span>
<span class="fc bfc" id="L2769" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L2770">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L2773">                String text = this.subString(start, count);</span>
<span class="fc" id="L2774">                value = Float.parseFloat(text);</span>
            }
<span class="pc bpc" id="L2776" title="3 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2777">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2778">            value = 0;</span>
<span class="fc" id="L2779">            offset += 3;</span>
<span class="fc" id="L2780">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2782" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2783">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2787" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2788">                    bp += offset;</span>
<span class="fc" id="L2789">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2790">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2791">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2792">                    return value;</span>
<span class="fc bfc" id="L2793" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2794">                    bp += offset;</span>
<span class="fc" id="L2795">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2796">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2797">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2798">                    return value;</span>
<span class="pc bpc" id="L2799" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2800">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2801">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2805">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2806">            return 0;</span>
        } else {
<span class="fc" id="L2808">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2809">            return 0;</span>
        }

<span class="fc bfc" id="L2812" title="All 2 branches covered.">        if (chLocal == seperator) {</span>
<span class="fc" id="L2813">            bp += offset;</span>
<span class="fc" id="L2814">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L2815">            matchStat = VALUE;</span>
<span class="fc" id="L2816">            token = JSONToken.COMMA;</span>
<span class="fc" id="L2817">            return value;</span>
        } else {
<span class="fc" id="L2819">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L2820">            return value;</span>
        }
    }

    public double scanDouble(char seperator) {
<span class="fc" id="L2825">        matchStat = UNKNOWN;</span>

<span class="fc" id="L2827">        int offset = 0;</span>
<span class="fc" id="L2828">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L2829" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L2830" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="fc" id="L2831">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L2834" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L2835" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2836">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="pc bpc" id="L2840" title="2 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2841">            long intVal = chLocal - '0';</span>
            for (; ; ) {
<span class="nc" id="L2843">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2844" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2845">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2846">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc" id="L2852">            long power = 1;</span>
<span class="nc bnc" id="L2853" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2854" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2855">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2856" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2857">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2858">                    power = 10;</span>
                    for (; ; ) {
<span class="nc" id="L2860">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2861" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2862">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L2863">                            power *= 10;</span>
<span class="nc" id="L2864">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L2870">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2871">                    return 0;</span>
                }
            }

<span class="nc bnc" id="L2875" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L2876" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L2877">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2878" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L2879">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (; ; ) {
<span class="nc bnc" id="L2882" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2883">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L2891" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L2892" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L2893">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L2894">                    return 0;</span>
                } else {
<span class="nc" id="L2896">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L2898">                start = bp + 1;</span>
<span class="nc" id="L2899">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L2901">                start = bp;</span>
<span class="nc" id="L2902">                count = bp + offset - start - 1;</span>
            }

<span class="nc bnc" id="L2905" title="All 4 branches missed.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="nc" id="L2906">                value = ((double) intVal) / power;</span>
<span class="nc bnc" id="L2907" title="All 2 branches missed.">                if (negative) {</span>
<span class="nc" id="L2908">                    value = -value;</span>
                }
            } else {
<span class="nc" id="L2911">                String text = this.subString(start, count);</span>
<span class="nc" id="L2912">                value = Double.parseDouble(text);</span>
            }
<span class="pc bpc" id="L2914" title="4 of 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L2915">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L2916">            value = 0;</span>
<span class="fc" id="L2917">            offset += 3;</span>
<span class="fc" id="L2918">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L2920" title="2 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L2921">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L2925" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L2926">                    bp += offset;</span>
<span class="fc" id="L2927">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2928">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2929">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L2930">                    return value;</span>
<span class="fc bfc" id="L2931" title="All 2 branches covered.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L2932">                    bp += offset;</span>
<span class="fc" id="L2933">                    this.ch = charAt(bp);</span>
<span class="fc" id="L2934">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L2935">                    token = JSONToken.RBRACKET;</span>
<span class="fc" id="L2936">                    return value;</span>
<span class="pc bpc" id="L2937" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L2938">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L2939">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L2943">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2944">            return 0;</span>
        } else {
<span class="nc" id="L2946">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2947">            return 0;</span>
        }

<span class="nc bnc" id="L2950" title="All 2 branches missed.">        if (chLocal == seperator) {</span>
<span class="nc" id="L2951">            bp += offset;</span>
<span class="nc" id="L2952">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L2953">            matchStat = VALUE;</span>
<span class="nc" id="L2954">            token = JSONToken.COMMA;</span>
<span class="nc" id="L2955">            return value;</span>
        } else {
<span class="nc" id="L2957">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L2958">            return value;</span>
        }
    }

    public BigDecimal scanDecimal(char seperator) {
<span class="nc" id="L2963">        matchStat = UNKNOWN;</span>

<span class="nc" id="L2965">        int offset = 0;</span>
<span class="nc" id="L2966">        char chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2967" title="All 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="nc bnc" id="L2968" title="All 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L2969">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="nc bnc" id="L2972" title="All 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="nc bnc" id="L2973" title="All 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L2974">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="nc bnc" id="L2978" title="All 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="nc" id="L2980">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2981" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2982">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="nc bnc" id="L2988" title="All 2 branches missed.">            boolean small = (chLocal == '.');</span>
<span class="nc bnc" id="L2989" title="All 2 branches missed.">            if (small) {</span>
<span class="nc" id="L2990">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2991" title="All 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="nc" id="L2993">                        chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L2994" title="All 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L2995">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3001">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3002">                    return null;</span>
                }
            }

<span class="nc bnc" id="L3006" title="All 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="nc bnc" id="L3007" title="All 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3008">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3009" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3010">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L3013" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3014">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="nc bnc" id="L3022" title="All 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3023" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3024">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3025">                    return null;</span>
                } else {
<span class="nc" id="L3027">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3029">                start = bp + 1;</span>
<span class="nc" id="L3030">                count = bp + offset - start - 2;</span>
            } else {
<span class="nc" id="L3032">                start = bp;</span>
<span class="nc" id="L3033">                count = bp + offset - start - 1;</span>
            }

<span class="nc" id="L3036">            char[] chars = this.sub_chars(start, count);</span>
<span class="nc" id="L3037">            value = new BigDecimal(chars);</span>
<span class="nc bnc" id="L3038" title="All 8 branches missed.">        } else if (chLocal == 'n' &amp;&amp; charAt(bp + offset) == 'u' &amp;&amp; charAt(bp + offset + 1) == 'l' &amp;&amp; charAt(bp + offset + 2) == 'l') {</span>
<span class="nc" id="L3039">            matchStat = VALUE_NULL;</span>
<span class="nc" id="L3040">            value = null;</span>
<span class="nc" id="L3041">            offset += 3;</span>
<span class="nc" id="L3042">            chLocal = charAt(bp + offset++);</span>

<span class="nc bnc" id="L3044" title="All 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3045">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="nc bnc" id="L3049" title="All 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3050">                    bp += offset;</span>
<span class="nc" id="L3051">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3052">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3053">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3054">                    return value;</span>
<span class="nc bnc" id="L3055" title="All 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="nc" id="L3056">                    bp += offset;</span>
<span class="nc" id="L3057">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3058">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3059">                    token = JSONToken.RBRACE;</span>
<span class="nc" id="L3060">                    return value;</span>
<span class="nc bnc" id="L3061" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3062">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3063">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3067">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3068">            return null;</span>
        } else {
<span class="nc" id="L3070">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3071">            return null;</span>
        }

<span class="nc bnc" id="L3074" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3075">            bp += offset;</span>
<span class="nc" id="L3076">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L3077">            matchStat = VALUE;</span>
<span class="nc" id="L3078">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3079">            return value;</span>
        }

<span class="nc bnc" id="L3082" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L3083">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3084" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3085">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3086">                bp += offset;</span>
<span class="nc" id="L3087">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3088" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3089">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3090">                bp += offset;</span>
<span class="nc" id="L3091">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3092" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3093">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3094">                bp += offset;</span>
<span class="nc" id="L3095">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L3096" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L3097">                token = JSONToken.EOF;</span>
<span class="nc" id="L3098">                bp += (offset - 1);</span>
<span class="nc" id="L3099">                ch = EOI;</span>
            } else {
<span class="nc" id="L3101">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3102">                return null;</span>
            }
<span class="nc" id="L3104">            matchStat = END;</span>
        } else {
<span class="nc" id="L3106">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3107">            return null;</span>
        }

<span class="nc" id="L3110">        return value;</span>
    }

    public final float[] scanFieldFloatArray(char[] fieldName) {
<span class="fc" id="L3114">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3116" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3117">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3118">            return null;</span>
        }

<span class="fc" id="L3121">        int offset = fieldName.length;</span>
<span class="fc" id="L3122">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3123" title="All 2 branches covered.">        if (chLocal != '[') {</span>
<span class="fc" id="L3124">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3125">            return null;</span>
        }
<span class="fc" id="L3127">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3129">        float[] array = new float[16];</span>
<span class="fc" id="L3130">        int arrayIndex = 0;</span>

        for (;;) {
<span class="fc" id="L3133">            int start = bp + offset - 1;</span>

<span class="fc bfc" id="L3135" title="All 2 branches covered.">            boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3136" title="All 2 branches covered.">            if (negative) {</span>
<span class="fc" id="L3137">                chLocal = charAt(bp + (offset++));</span>
            }

<span class="pc bpc" id="L3140" title="1 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3141">                int intVal = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L3143">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3144" title="3 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3145">                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3146">                        continue;</span>
                    } else {
                        break;
                    }
                }

<span class="fc" id="L3152">                int power = 1;</span>
<span class="fc bfc" id="L3153" title="All 2 branches covered.">                boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3154" title="All 2 branches covered.">                if (small) {</span>
<span class="fc" id="L3155">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3156">                    power = 10;</span>
<span class="pc bpc" id="L3157" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3158">                        intVal = intVal * 10 + (chLocal - '0');</span>
                        for (; ; ) {
<span class="fc" id="L3160">                            chLocal = charAt(bp + (offset++));</span>

<span class="fc bfc" id="L3162" title="All 4 branches covered.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3163">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3164">                                power *= 10;</span>
<span class="fc" id="L3165">                                continue;</span>
                            } else {
                                break;
                            }
                        }
                    } else {
<span class="nc" id="L3171">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3172">                        return null;</span>
                    }
                }

<span class="pc bpc" id="L3176" title="1 of 4 branches missed.">                boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3177" title="All 2 branches covered.">                if (exp) {</span>
<span class="fc" id="L3178">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3179" title="2 of 4 branches missed.">                    if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3180">                        chLocal = charAt(bp + (offset++));</span>
                    }
                    for (;;) {
<span class="pc bpc" id="L3183" title="1 of 4 branches missed.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3184">                            chLocal = charAt(bp + (offset++));</span>
                        } else {
                            break;
                        }
                    }
                }

<span class="fc" id="L3191">                int count = bp + offset - start - 1;</span>

                float value;
<span class="fc bfc" id="L3194" title="All 4 branches covered.">                if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3195">                    value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3196" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3197">                        value = -value;</span>
                    }
                } else {
<span class="fc" id="L3200">                    String text = this.subString(start, count);</span>
<span class="fc" id="L3201">                    value = Float.parseFloat(text);</span>
                }

<span class="pc bpc" id="L3204" title="1 of 2 branches missed.">                if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3205">                    float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3206">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3207">                    array = tmp;</span>
                }
<span class="fc" id="L3209">                array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3211" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3212">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3213" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3214">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3215">                    break;</span>
                }
<span class="fc" id="L3217">            } else {</span>
<span class="fc" id="L3218">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3219">                return null;</span>
            }
<span class="fc" id="L3221">        }</span>


<span class="pc bpc" id="L3224" title="1 of 2 branches missed.">        if (arrayIndex != array.length) {</span>
<span class="fc" id="L3225">            float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3226">            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3227">            array = tmp;</span>
        }

<span class="pc bpc" id="L3230" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3231">            bp += (offset - 1);</span>
<span class="nc" id="L3232">            this.next();</span>
<span class="nc" id="L3233">            matchStat = VALUE;</span>
<span class="nc" id="L3234">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3235">            return array;</span>
        }

<span class="pc bpc" id="L3238" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3239">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3240" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3241">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3242">                bp += (offset - 1);</span>
<span class="nc" id="L3243">                this.next();</span>
<span class="pc bpc" id="L3244" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3245">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3246">                bp += (offset - 1);</span>
<span class="nc" id="L3247">                this.next();</span>
<span class="pc bpc" id="L3248" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3249">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3250">                bp += (offset - 1);</span>
<span class="nc" id="L3251">                this.next();</span>
<span class="pc bpc" id="L3252" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3253">                bp += (offset - 1);</span>
<span class="fc" id="L3254">                token = JSONToken.EOF;</span>
<span class="fc" id="L3255">                ch = EOI;</span>
            } else {
<span class="nc" id="L3257">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3258">                return null;</span>
            }
<span class="fc" id="L3260">            matchStat = END;</span>
        } else {
<span class="nc" id="L3262">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3263">            return null;</span>
        }

<span class="fc" id="L3266">        return array;</span>
    }

    public final float[][] scanFieldFloatArray2(char[] fieldName) {
<span class="fc" id="L3270">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3272" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3273">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3274">            return null;</span>
        }

<span class="fc" id="L3277">        int offset = fieldName.length;</span>
<span class="fc" id="L3278">        char chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3280" title="1 of 2 branches missed.">        if (chLocal != '[') {</span>
<span class="nc" id="L3281">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3282">            return null;</span>
        }
<span class="fc" id="L3284">        chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3286">        float[][] arrayarray = new float[16][];</span>
<span class="fc" id="L3287">        int arrayarrayIndex = 0;</span>

        for (;;) {
<span class="fc bfc" id="L3290" title="All 2 branches covered.">            if (chLocal == '[') {</span>
<span class="fc" id="L3291">                chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3293">                float[] array = new float[16];</span>
<span class="fc" id="L3294">                int arrayIndex = 0;</span>

                for (; ; ) {
<span class="fc" id="L3297">                    int start = bp + offset - 1;</span>
<span class="fc bfc" id="L3298" title="All 2 branches covered.">                    boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3299" title="All 2 branches covered.">                    if (negative) {</span>
<span class="fc" id="L3300">                        chLocal = charAt(bp + (offset++));</span>
                    }

<span class="pc bpc" id="L3303" title="2 of 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3304">                        int intVal = chLocal - '0';</span>
                        for (; ; ) {
<span class="fc" id="L3306">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3308" title="3 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3309">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3310">                                continue;</span>
                            } else {
                                break;
                            }
                        }

<span class="fc" id="L3316">                        int power = 1;</span>
<span class="fc bfc" id="L3317" title="All 2 branches covered.">                        if (chLocal == '.') {</span>
<span class="fc" id="L3318">                            chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3320" title="2 of 4 branches missed.">                            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3321">                                intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3322">                                power = 10;</span>
                                for (; ; ) {
<span class="fc" id="L3324">                                    chLocal = charAt(bp + (offset++));</span>

<span class="pc bpc" id="L3326" title="1 of 4 branches missed.">                                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3327">                                        intVal = intVal * 10 + (chLocal - '0');</span>
<span class="nc" id="L3328">                                        power *= 10;</span>
<span class="nc" id="L3329">                                        continue;</span>
                                    } else {
                                        break;
                                    }
                                }
                            } else {
<span class="nc" id="L3335">                                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3336">                                return null;</span>
                            }
                        }

<span class="pc bpc" id="L3340" title="2 of 4 branches missed.">                        boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3341" title="1 of 2 branches missed.">                        if (exp) {</span>
<span class="nc" id="L3342">                            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3343" title="All 4 branches missed.">                            if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3344">                                chLocal = charAt(bp + (offset++));</span>
                            }
                            for (;;) {
<span class="nc bnc" id="L3347" title="All 4 branches missed.">                                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3348">                                    chLocal = charAt(bp + (offset++));</span>
                                } else {
                                    break;
                                }
                            }
                        }

<span class="fc" id="L3355">                        int count = bp + offset - start - 1;</span>
                        float value;
<span class="pc bpc" id="L3357" title="2 of 4 branches missed.">                        if (!exp &amp;&amp; count &lt; 10) {</span>
<span class="fc" id="L3358">                            value = ((float) intVal) / power;</span>
<span class="fc bfc" id="L3359" title="All 2 branches covered.">                            if (negative) {</span>
<span class="fc" id="L3360">                                value = -value;</span>
                            }
                        } else {
<span class="nc" id="L3363">                            String text = this.subString(start, count);</span>
<span class="nc" id="L3364">                            value = Float.parseFloat(text);</span>
                        }

<span class="pc bpc" id="L3367" title="1 of 2 branches missed.">                        if (arrayIndex &gt;= array.length) {</span>
<span class="nc" id="L3368">                            float[] tmp = new float[array.length * 3 / 2];</span>
<span class="nc" id="L3369">                            System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3370">                            array = tmp;</span>
                        }
<span class="fc" id="L3372">                        array[arrayIndex++] = value;</span>

<span class="fc bfc" id="L3374" title="All 2 branches covered.">                        if (chLocal == ',') {</span>
<span class="fc" id="L3375">                            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3376" title="1 of 2 branches missed.">                        } else if (chLocal == ']') {</span>
<span class="fc" id="L3377">                            chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3378">                            break;</span>
                        }
<span class="fc" id="L3380">                    } else {</span>
<span class="nc" id="L3381">                        matchStat = NOT_MATCH;</span>
<span class="nc" id="L3382">                        return null;</span>
                    }
<span class="fc" id="L3384">                }</span>

                // compact
<span class="pc bpc" id="L3387" title="1 of 2 branches missed.">                if (arrayIndex != array.length) {</span>
<span class="fc" id="L3388">                    float[] tmp = new float[arrayIndex];</span>
<span class="fc" id="L3389">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="fc" id="L3390">                    array = tmp;</span>
                }

<span class="pc bpc" id="L3393" title="1 of 2 branches missed.">                if (arrayarrayIndex &gt;= arrayarray.length) {</span>
<span class="nc" id="L3394">                    float[][] tmp = new float[arrayarray.length * 3 / 2][];</span>
<span class="nc" id="L3395">                    System.arraycopy(array, 0, tmp, 0, arrayIndex);</span>
<span class="nc" id="L3396">                    arrayarray = tmp;</span>
                }
<span class="fc" id="L3398">                arrayarray[arrayarrayIndex++] = array;</span>

<span class="pc bpc" id="L3400" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3401">                    chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3402" title="1 of 2 branches missed.">                } else if (chLocal == ']') {</span>
<span class="fc" id="L3403">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc" id="L3404">                    break;</span>
                }
<span class="nc" id="L3406">            } else {</span>
                break;
            }
        }

        // compact
<span class="pc bpc" id="L3412" title="1 of 2 branches missed.">        if (arrayarrayIndex != arrayarray.length) {</span>
<span class="fc" id="L3413">            float[][] tmp = new float[arrayarrayIndex][];</span>
<span class="fc" id="L3414">            System.arraycopy(arrayarray, 0, tmp, 0, arrayarrayIndex);</span>
<span class="fc" id="L3415">            arrayarray = tmp;</span>
        }

<span class="pc bpc" id="L3418" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L3419">            bp += (offset - 1);</span>
<span class="nc" id="L3420">            this.next();</span>
<span class="nc" id="L3421">            matchStat = VALUE;</span>
<span class="nc" id="L3422">            token = JSONToken.COMMA;</span>
<span class="nc" id="L3423">            return arrayarray;</span>
        }

<span class="fc bfc" id="L3426" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3427">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3428" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3429">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3430">                bp += (offset - 1);</span>
<span class="nc" id="L3431">                this.next();</span>
<span class="pc bpc" id="L3432" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3433">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3434">                bp += (offset - 1);</span>
<span class="nc" id="L3435">                this.next();</span>
<span class="pc bpc" id="L3436" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3437">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3438">                bp += (offset - 1);</span>
<span class="nc" id="L3439">                this.next();</span>
<span class="pc bpc" id="L3440" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3441">                bp += (offset - 1);</span>
<span class="fc" id="L3442">                token = JSONToken.EOF;</span>
<span class="fc" id="L3443">                ch = EOI;</span>
            } else {
<span class="nc" id="L3445">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3446">                return null;</span>
            }
<span class="fc" id="L3448">            matchStat = END;</span>
        } else {
<span class="fc" id="L3450">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3451">            return null;</span>
        }

<span class="fc" id="L3454">        return arrayarray;</span>
    }

    public final double scanFieldDouble(char[] fieldName) {
<span class="fc" id="L3458">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3460" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3461">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3462">            return 0;</span>
        }

<span class="fc" id="L3465">        int offset = fieldName.length;</span>
<span class="fc" id="L3466">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3467" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3468" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3469">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="fc bfc" id="L3472" title="All 2 branches covered.">        boolean negative = chLocal == '-';</span>
<span class="fc bfc" id="L3473" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc" id="L3474">            chLocal = charAt(bp + (offset++));</span>
        }

        double value;
<span class="fc bfc" id="L3478" title="All 4 branches covered.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3479">            long intVal = chLocal - '0';</span>

            for (;;) {
<span class="fc" id="L3482">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3483" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3484">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3485">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc" id="L3491">            long power = 1;</span>
<span class="fc bfc" id="L3492" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3493" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3494">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3495" title="1 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3496">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3497">                    power = 10;</span>
                    for (;;) {
<span class="fc" id="L3499">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3500" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3501">                            intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3502">                            power *= 10;</span>
<span class="fc" id="L3503">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="fc" id="L3509">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3510">                    return 0;</span>
                }
            }

<span class="fc bfc" id="L3514" title="All 4 branches covered.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="fc bfc" id="L3515" title="All 2 branches covered.">            if (exp) {</span>
<span class="fc" id="L3516">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3517" title="All 4 branches covered.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="fc" id="L3518">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="fc bfc" id="L3521" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3522">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="fc bfc" id="L3530" title="All 2 branches covered.">            if (quote) {</span>
<span class="pc bpc" id="L3531" title="1 of 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3532">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3533">                    return 0;</span>
                } else {
<span class="fc" id="L3535">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="fc" id="L3537">                start = bp + fieldName.length + 1;</span>
<span class="fc" id="L3538">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3540">                start = bp + fieldName.length;</span>
<span class="fc" id="L3541">                count = bp + offset - start - 1;</span>
            }

<span class="fc bfc" id="L3544" title="All 4 branches covered.">            if (!exp &amp;&amp; count &lt; 17) {</span>
<span class="fc" id="L3545">                value = ((double) intVal) / power;</span>
<span class="fc bfc" id="L3546" title="All 2 branches covered.">                if (negative) {</span>
<span class="fc" id="L3547">                    value = -value;</span>
                }
            } else {
<span class="fc" id="L3550">                String text = this.subString(start, count);</span>
<span class="fc" id="L3551">                value = Double.parseDouble(text);</span>
            }
<span class="fc bfc" id="L3553" title="All 2 branches covered.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3554" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3555" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3556" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3557">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3558">            value = 0;</span>
<span class="fc" id="L3559">            offset += 3;</span>
<span class="fc" id="L3560">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3562" title="1 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="fc" id="L3563">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="fc bfc" id="L3567" title="All 2 branches covered.">                if (chLocal == ',') {</span>
<span class="fc" id="L3568">                    bp += offset;</span>
<span class="fc" id="L3569">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3570">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3571">                    token = JSONToken.COMMA;</span>
<span class="fc" id="L3572">                    return value;</span>
<span class="fc bfc" id="L3573" title="All 2 branches covered.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3574">                    bp += offset;</span>
<span class="fc" id="L3575">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3576">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3577">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3578">                    return value;</span>
<span class="pc bpc" id="L3579" title="1 of 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="fc" id="L3580">                    chLocal = charAt(bp + offset++);</span>
<span class="fc" id="L3581">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3585">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3586">            return 0;</span>
        } else {
<span class="fc" id="L3588">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3589">            return 0;</span>
        }

<span class="fc bfc" id="L3592" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3593">            bp += offset;</span>
<span class="fc" id="L3594">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3595">            matchStat = VALUE;</span>
<span class="fc" id="L3596">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3597">            return value;</span>
        }

<span class="fc bfc" id="L3600" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3601">            chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3602" title="All 2 branches covered.">            if (chLocal == ',') {</span>
<span class="fc" id="L3603">                token = JSONToken.COMMA;</span>
<span class="fc" id="L3604">                bp += offset;</span>
<span class="fc" id="L3605">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3606" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3607">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3608">                bp += offset;</span>
<span class="fc" id="L3609">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3610" title="All 2 branches covered.">            } else if (chLocal == '}') {</span>
<span class="fc" id="L3611">                token = JSONToken.RBRACE;</span>
<span class="fc" id="L3612">                bp += offset;</span>
<span class="fc" id="L3613">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3614" title="All 2 branches covered.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3615">                token = JSONToken.EOF;</span>
<span class="fc" id="L3616">                bp += (offset - 1);</span>
<span class="fc" id="L3617">                ch = EOI;</span>
            } else {
<span class="fc" id="L3619">                matchStat = NOT_MATCH;</span>
<span class="fc" id="L3620">                return 0;</span>
            }
<span class="fc" id="L3622">            matchStat = END;</span>
        } else {
<span class="fc" id="L3624">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3625">            return 0;</span>
        }

<span class="fc" id="L3628">        return value;</span>
    }

    public BigDecimal scanFieldDecimal(char[] fieldName) {
<span class="fc" id="L3632">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3634" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3635">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3636">            return null;</span>
        }

<span class="fc" id="L3639">        int offset = fieldName.length;</span>
<span class="fc" id="L3640">        char chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3641" title="All 2 branches covered.">        final boolean quote = chLocal == '&quot;';</span>
<span class="fc bfc" id="L3642" title="All 2 branches covered.">        if (quote) {</span>
<span class="fc" id="L3643">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3646" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3647" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3648">            chLocal = charAt(bp + (offset++));</span>
        }

        BigDecimal value;
<span class="pc bpc" id="L3652" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
            for (;;) {
<span class="fc" id="L3654">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3655" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3656">                    continue;</span>
                } else {
                    break;
                }
            }

<span class="fc bfc" id="L3662" title="All 2 branches covered.">            boolean small = (chLocal == '.');</span>
<span class="fc bfc" id="L3663" title="All 2 branches covered.">            if (small) {</span>
<span class="fc" id="L3664">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3665" title="2 of 4 branches missed.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
                    for (;;) {
<span class="fc" id="L3667">                        chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3668" title="All 4 branches covered.">                        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3669">                            continue;</span>
                        } else {
                            break;
                        }
                    }
                } else {
<span class="nc" id="L3675">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3676">                    return null;</span>
                }
            }

<span class="pc bpc" id="L3680" title="2 of 4 branches missed.">            boolean exp = chLocal == 'e' || chLocal == 'E';</span>
<span class="pc bpc" id="L3681" title="1 of 2 branches missed.">            if (exp) {</span>
<span class="nc" id="L3682">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L3683" title="All 4 branches missed.">                if (chLocal == '+' || chLocal == '-') {</span>
<span class="nc" id="L3684">                    chLocal = charAt(bp + (offset++));</span>
                }
                for (;;) {
<span class="nc bnc" id="L3687" title="All 4 branches missed.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="nc" id="L3688">                        chLocal = charAt(bp + (offset++));</span>
                    } else {
                        break;
                    }
                }
            }

            int start, count;
<span class="pc bpc" id="L3696" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3697" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3698">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3699">                    return null;</span>
                } else {
<span class="nc" id="L3701">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3703">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3704">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3706">                start = bp + fieldName.length;</span>
<span class="fc" id="L3707">                count = bp + offset - start - 1;</span>
            }

<span class="fc" id="L3710">            char[] chars = this.sub_chars(start, count);</span>
<span class="fc" id="L3711">            value = new BigDecimal(chars);</span>
<span class="fc bfc" id="L3712" title="All 2 branches covered.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3713" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3714" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3715" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3716">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3717">            value = null;</span>
<span class="fc" id="L3718">            offset += 3;</span>
<span class="fc" id="L3719">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3721" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3722">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3726" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3727">                    bp += offset;</span>
<span class="nc" id="L3728">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3729">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3730">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3731">                    return value;</span>
<span class="pc bpc" id="L3732" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3733">                    bp += offset;</span>
<span class="fc" id="L3734">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3735">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3736">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3737">                    return value;</span>
<span class="nc bnc" id="L3738" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3739">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3740">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3744">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3745">            return null;</span>
        } else {
<span class="fc" id="L3747">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3748">            return null;</span>
        }

<span class="fc bfc" id="L3751" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3752">            bp += offset;</span>
<span class="fc" id="L3753">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3754">            matchStat = VALUE;</span>
<span class="fc" id="L3755">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3756">            return value;</span>
        }

<span class="pc bpc" id="L3759" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L3760">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3761" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3762">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3763">                bp += offset;</span>
<span class="nc" id="L3764">                this.ch = this.charAt(bp);</span>
<span class="fc bfc" id="L3765" title="All 2 branches covered.">            } else if (chLocal == ']') {</span>
<span class="fc" id="L3766">                token = JSONToken.RBRACKET;</span>
<span class="fc" id="L3767">                bp += offset;</span>
<span class="fc" id="L3768">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3769" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3770">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3771">                bp += offset;</span>
<span class="nc" id="L3772">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3773" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3774">                token = JSONToken.EOF;</span>
<span class="fc" id="L3775">                bp += (offset - 1);</span>
<span class="fc" id="L3776">                ch = EOI;</span>
            } else {
<span class="nc" id="L3778">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3779">                return null;</span>
            }
<span class="fc" id="L3781">            matchStat = END;</span>
        } else {
<span class="nc" id="L3783">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3784">            return null;</span>
        }

<span class="fc" id="L3787">        return value;</span>
    }

    public BigInteger scanFieldBigInteger(char[] fieldName) {
<span class="fc" id="L3791">        matchStat = UNKNOWN;</span>

<span class="fc bfc" id="L3793" title="All 2 branches covered.">        if (!charArrayCompare(fieldName)) {</span>
<span class="fc" id="L3794">            matchStat = NOT_MATCH_NAME;</span>
<span class="fc" id="L3795">            return null;</span>
        }

<span class="fc" id="L3798">        int offset = fieldName.length;</span>
<span class="fc" id="L3799">        char chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3800" title="1 of 2 branches missed.">        final boolean quote = chLocal == '&quot;';</span>
<span class="pc bpc" id="L3801" title="1 of 2 branches missed.">        if (quote) {</span>
<span class="nc" id="L3802">            chLocal = charAt(bp + (offset++));</span>
        }

<span class="pc bpc" id="L3805" title="1 of 2 branches missed.">        boolean negative = chLocal == '-';</span>
<span class="pc bpc" id="L3806" title="1 of 2 branches missed.">        if (negative) {</span>
<span class="nc" id="L3807">            chLocal = charAt(bp + (offset++));</span>
        }

        BigInteger value;
<span class="pc bpc" id="L3811" title="1 of 4 branches missed.">        if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3812">            long intVal = chLocal - '0';</span>
            for (;;) {
<span class="fc" id="L3814">                chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3815" title="All 4 branches covered.">                if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3816">                    intVal = intVal * 10 + (chLocal - '0');</span>
<span class="fc" id="L3817">                    continue;</span>
                } else {
                    break;
                }
            }

            int start, count;
<span class="pc bpc" id="L3824" title="1 of 2 branches missed.">            if (quote) {</span>
<span class="nc bnc" id="L3825" title="All 2 branches missed.">                if (chLocal != '&quot;') {</span>
<span class="nc" id="L3826">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L3827">                    return null;</span>
                } else {
<span class="nc" id="L3829">                    chLocal = charAt(bp + (offset++));</span>
                }
<span class="nc" id="L3831">                start = bp + fieldName.length + 1;</span>
<span class="nc" id="L3832">                count = bp + offset - start - 2;</span>
            } else {
<span class="fc" id="L3834">                start = bp + fieldName.length;</span>
<span class="fc" id="L3835">                count = bp + offset - start - 1;</span>
            }

<span class="pc bpc" id="L3838" title="3 of 6 branches missed.">            if (count &lt; 20 || (negative &amp;&amp; count &lt; 21)) {</span>
<span class="pc bpc" id="L3839" title="1 of 2 branches missed.">                value = BigInteger.valueOf(negative ? -intVal : intVal);</span>
            } else {

//            char[] chars = this.sub_chars(negative ? start + 1 : start, count);
//            value = new BigInteger(chars, )
<span class="fc" id="L3844">                String strVal = this.subString(start, count);</span>
<span class="fc" id="L3845">                value = new BigInteger(strVal);</span>
            }
<span class="pc bpc" id="L3847" title="1 of 2 branches missed.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L3848" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L3849" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L3850" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L3851">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L3852">            value = null;</span>
<span class="fc" id="L3853">            offset += 3;</span>
<span class="fc" id="L3854">            chLocal = charAt(bp + offset++);</span>

<span class="pc bpc" id="L3856" title="3 of 4 branches missed.">            if (quote &amp;&amp; chLocal == '&quot;') {</span>
<span class="nc" id="L3857">                chLocal = charAt(bp + offset++);</span>
            }

            for (;;) {
<span class="pc bpc" id="L3861" title="1 of 2 branches missed.">                if (chLocal == ',') {</span>
<span class="nc" id="L3862">                    bp += offset;</span>
<span class="nc" id="L3863">                    this.ch = charAt(bp);</span>
<span class="nc" id="L3864">                    matchStat = VALUE_NULL;</span>
<span class="nc" id="L3865">                    token = JSONToken.COMMA;</span>
<span class="nc" id="L3866">                    return value;</span>
<span class="pc bpc" id="L3867" title="1 of 2 branches missed.">                } else if (chLocal == '}') {</span>
<span class="fc" id="L3868">                    bp += offset;</span>
<span class="fc" id="L3869">                    this.ch = charAt(bp);</span>
<span class="fc" id="L3870">                    matchStat = VALUE_NULL;</span>
<span class="fc" id="L3871">                    token = JSONToken.RBRACE;</span>
<span class="fc" id="L3872">                    return value;</span>
<span class="nc bnc" id="L3873" title="All 2 branches missed.">                } else if (isWhitespace(chLocal)) {</span>
<span class="nc" id="L3874">                    chLocal = charAt(bp + offset++);</span>
<span class="nc" id="L3875">                    continue;</span>
                }
                break;
            }
<span class="nc" id="L3879">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3880">            return null;</span>
        } else {
<span class="nc" id="L3882">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L3883">            return null;</span>
        }

<span class="fc bfc" id="L3886" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L3887">            bp += offset;</span>
<span class="fc" id="L3888">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L3889">            matchStat = VALUE;</span>
<span class="fc" id="L3890">            token = JSONToken.COMMA;</span>
<span class="fc" id="L3891">            return value;</span>
        }

<span class="fc bfc" id="L3894" title="All 2 branches covered.">        if (chLocal == '}') {</span>
<span class="fc" id="L3895">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L3896" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L3897">                token = JSONToken.COMMA;</span>
<span class="nc" id="L3898">                bp += offset;</span>
<span class="nc" id="L3899">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3900" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L3901">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L3902">                bp += offset;</span>
<span class="nc" id="L3903">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3904" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L3905">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L3906">                bp += offset;</span>
<span class="nc" id="L3907">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L3908" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L3909">                token = JSONToken.EOF;</span>
<span class="fc" id="L3910">                bp += (offset - 1);</span>
<span class="fc" id="L3911">                ch = EOI;</span>
            } else {
<span class="nc" id="L3913">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L3914">                return null;</span>
            }
<span class="fc" id="L3916">            matchStat = END;</span>
        } else {
<span class="fc" id="L3918">            matchStat = NOT_MATCH;</span>
<span class="fc" id="L3919">            return null;</span>
        }

<span class="fc" id="L3922">        return value;</span>
    }

    public java.util.Date scanFieldDate(char[] fieldName) {
<span class="fc" id="L3926">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L3928" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L3929">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L3930">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L3935">        int offset = fieldName.length;</span>
<span class="fc" id="L3936">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L3939" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L3940">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L3941">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L3942" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L3943">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L3946">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L3947">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L3948" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L3950">                    int slashCount = 0;</span>
<span class="nc bnc" id="L3951" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L3952" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L3953">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L3958" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L3959">                        break;</span>
                    }
<span class="nc" id="L3961">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L3962">                }</span>

<span class="nc" id="L3964">                int chars_len = endIndex - (bp + fieldName.length + 1);</span>
<span class="nc" id="L3965">                char[] chars = sub_chars( bp + fieldName.length + 1, chars_len);</span>

<span class="nc" id="L3967">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L3970">            offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L3971">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L3973">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="fc bfc" id="L3975" title="All 2 branches covered.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L3976">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L3977">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L3978">                } else {</span>
<span class="fc" id="L3979">                    matchStat = NOT_MATCH;</span>
<span class="fc" id="L3980">                    return null;</span>
                }
            } finally {
<span class="fc" id="L3983">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L3985" title="3 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L3986">            long millis = 0;</span>

<span class="fc" id="L3988">            boolean negative = false;</span>
<span class="pc bpc" id="L3989" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L3990">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L3991">                negative = true;</span>
            }

<span class="pc bpc" id="L3994" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3995">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L3997">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L3998" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L3999">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4006" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4007">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4008">                return null;</span>
            }

<span class="pc bpc" id="L4011" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4012">                millis = -millis;</span>
            }

<span class="fc" id="L4015">            dateVal = new java.util.Date(millis);</span>
<span class="fc" id="L4016">        } else {</span>
<span class="nc" id="L4017">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4018">            return null;</span>
        }

<span class="fc bfc" id="L4021" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4022">            bp += offset;</span>
<span class="fc" id="L4023">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4024">            matchStat = VALUE;</span>
<span class="fc" id="L4025">            return dateVal;</span>
        }

<span class="pc bpc" id="L4028" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4029">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4030" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4031">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4032">                bp += offset;</span>
<span class="nc" id="L4033">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4034" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4035">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4036">                bp += offset;</span>
<span class="nc" id="L4037">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4038" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4039">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4040">                bp += offset;</span>
<span class="nc" id="L4041">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4042" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4043">                token = JSONToken.EOF;</span>
<span class="fc" id="L4044">                bp += (offset - 1);</span>
<span class="fc" id="L4045">                ch = EOI;</span>
            } else {
<span class="nc" id="L4047">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4048">                return null;</span>
            }
<span class="fc" id="L4050">            matchStat = END;</span>
        } else {
<span class="nc" id="L4052">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4053">            return null;</span>
        }

<span class="fc" id="L4056">        return dateVal;</span>
    }

    public java.util.Date scanDate(char seperator) {
<span class="fc" id="L4060">        matchStat = UNKNOWN;</span>

<span class="fc" id="L4062">        int offset = 0;</span>
<span class="fc" id="L4063">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.Date dateVal;
<span class="fc bfc" id="L4066" title="All 2 branches covered.">        if (chLocal == '&quot;'){</span>
<span class="fc" id="L4067">            int startIndex = bp + 1;</span>
<span class="fc" id="L4068">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4069" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4070">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4073">            int startIndex2 = bp + 1; // must re compute</span>
<span class="fc" id="L4074">            String stringVal = subString(startIndex2, endIndex - startIndex2);</span>
<span class="pc bpc" id="L4075" title="1 of 2 branches missed.">            if (stringVal.indexOf('\\') != -1) {</span>
                for (;;) {
<span class="nc" id="L4077">                    int slashCount = 0;</span>
<span class="nc bnc" id="L4078" title="All 2 branches missed.">                    for (int i = endIndex - 1; i &gt;= 0; --i) {</span>
<span class="nc bnc" id="L4079" title="All 2 branches missed.">                        if (charAt(i) == '\\') {</span>
<span class="nc" id="L4080">                            slashCount++;</span>
                        } else {
                            break;
                        }
                    }
<span class="nc bnc" id="L4085" title="All 2 branches missed.">                    if (slashCount % 2 == 0) {</span>
<span class="nc" id="L4086">                        break;</span>
                    }
<span class="nc" id="L4088">                    endIndex = indexOf('&quot;', endIndex + 1);</span>
<span class="nc" id="L4089">                }</span>

<span class="nc" id="L4091">                int chars_len = endIndex - (bp + 1);</span>
<span class="nc" id="L4092">                char[] chars = sub_chars( bp + 1, chars_len);</span>

<span class="nc" id="L4094">                stringVal = readString(chars, chars_len);</span>
            }

<span class="fc" id="L4097">            offset += (endIndex - (bp + 1) + 1);</span>
<span class="fc" id="L4098">            chLocal = charAt(bp + (offset++));</span>

<span class="fc" id="L4100">            JSONScanner dateLexer = new JSONScanner(stringVal);</span>
            try {
<span class="pc bpc" id="L4102" title="1 of 2 branches missed.">                if (dateLexer.scanISO8601DateIfMatch(false)) {</span>
<span class="fc" id="L4103">                    Calendar calendar = dateLexer.getCalendar();</span>
<span class="fc" id="L4104">                    dateVal = calendar.getTime();</span>
<span class="fc" id="L4105">                } else {</span>
<span class="nc" id="L4106">                    matchStat = NOT_MATCH;</span>
<span class="nc" id="L4107">                    return null;</span>
                }
            } finally {
<span class="fc" id="L4110">                dateLexer.close();</span>
            }
<span class="pc bpc" id="L4112" title="2 of 6 branches missed.">        } else if (chLocal == '-' || (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9')) {</span>
<span class="fc" id="L4113">            long millis = 0;</span>

<span class="fc" id="L4115">            boolean negative = false;</span>
<span class="pc bpc" id="L4116" title="1 of 2 branches missed.">            if (chLocal == '-') {</span>
<span class="nc" id="L4117">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4118">                negative = true;</span>
            }

<span class="pc bpc" id="L4121" title="2 of 4 branches missed.">            if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4122">                millis = chLocal - '0';</span>
                for (; ; ) {
<span class="fc" id="L4124">                    chLocal = charAt(bp + (offset++));</span>
<span class="fc bfc" id="L4125" title="All 4 branches covered.">                    if (chLocal &gt;= '0' &amp;&amp; chLocal &lt;= '9') {</span>
<span class="fc" id="L4126">                        millis = millis * 10 + (chLocal - '0');</span>
                    } else {
                        break;
                    }
                }
            }

<span class="pc bpc" id="L4133" title="1 of 2 branches missed.">            if (millis &lt; 0) {</span>
<span class="nc" id="L4134">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4135">                return null;</span>
            }

<span class="pc bpc" id="L4138" title="1 of 2 branches missed.">            if (negative) {</span>
<span class="nc" id="L4139">                millis = -millis;</span>
            }

<span class="fc" id="L4142">            dateVal = new java.util.Date(millis);</span>
<span class="pc bpc" id="L4143" title="1 of 2 branches missed.">        } else if (chLocal == 'n' &amp;&amp;</span>
<span class="pc bpc" id="L4144" title="1 of 2 branches missed.">                   charAt(bp + offset) == 'u' &amp;&amp;</span>
<span class="pc bpc" id="L4145" title="1 of 2 branches missed.">                   charAt(bp + offset + 1) == 'l' &amp;&amp;</span>
<span class="pc bpc" id="L4146" title="1 of 2 branches missed.">                   charAt(bp + offset + 2) == 'l') {</span>
<span class="fc" id="L4147">            matchStat = VALUE_NULL;</span>
<span class="fc" id="L4148">            dateVal = null;</span>
<span class="fc" id="L4149">            offset += 3;</span>
<span class="fc" id="L4150">            chLocal = charAt(bp + offset++);</span>
        } else {
<span class="nc" id="L4152">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4153">            return null;</span>
        }

<span class="fc bfc" id="L4156" title="All 2 branches covered.">        if (chLocal == ',') {</span>
<span class="fc" id="L4157">            bp += offset;</span>
<span class="fc" id="L4158">            this.ch = this.charAt(bp);</span>
<span class="fc" id="L4159">            matchStat = VALUE;</span>
<span class="fc" id="L4160">            token = JSONToken.COMMA;</span>
<span class="fc" id="L4161">            return dateVal;</span>
        }

<span class="pc bpc" id="L4164" title="1 of 2 branches missed.">        if (chLocal == ']') {</span>
<span class="fc" id="L4165">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4166" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4167">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4168">                bp += offset;</span>
<span class="nc" id="L4169">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4170" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4171">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4172">                bp += offset;</span>
<span class="nc" id="L4173">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4174" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4175">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4176">                bp += offset;</span>
<span class="nc" id="L4177">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4178" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4179">                token = JSONToken.EOF;</span>
<span class="fc" id="L4180">                bp += (offset - 1);</span>
<span class="fc" id="L4181">                ch = EOI;</span>
            } else {
<span class="nc" id="L4183">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4184">                return null;</span>
            }
<span class="fc" id="L4186">            matchStat = END;</span>
        } else {
<span class="nc" id="L4188">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4189">            return null;</span>
        }

<span class="fc" id="L4192">        return dateVal;</span>
    }

    public java.util.UUID scanFieldUUID(char[] fieldName) {
<span class="fc" id="L4196">        matchStat = UNKNOWN;</span>

<span class="pc bpc" id="L4198" title="1 of 2 branches missed.">        if (!charArrayCompare(fieldName)) {</span>
<span class="nc" id="L4199">            matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4200">            return null;</span>
        }

        // int index = bp + fieldName.length;

<span class="fc" id="L4205">        int offset = fieldName.length;</span>
<span class="fc" id="L4206">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="fc bfc" id="L4209" title="All 2 branches covered.">        if (chLocal == '&quot;') {</span>
<span class="fc" id="L4210">            int startIndex = bp + fieldName.length + 1;</span>
<span class="fc" id="L4211">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="pc bpc" id="L4212" title="1 of 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4213">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="fc" id="L4216">            int startIndex2 = bp + fieldName.length + 1; // must re compute</span>
<span class="fc" id="L4217">            int len = endIndex - startIndex2;</span>
<span class="pc bpc" id="L4218" title="1 of 2 branches missed.">            if (len == 36) {</span>
<span class="fc" id="L4219">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="fc bfc" id="L4220" title="All 2 branches covered.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="fc" id="L4221">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4223" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4224">                        num = ch - '0';</span>
<span class="pc bpc" id="L4225" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4226">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4227" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4228">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4230">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4231">                        return null;</span>
                    }

<span class="fc" id="L4234">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4235">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4237" title="All 2 branches covered.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="fc" id="L4238">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4240" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4241">                        num = ch - '0';</span>
<span class="pc bpc" id="L4242" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4243">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4244" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4245">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4247">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4248">                        return null;</span>
                    }

<span class="fc" id="L4251">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4252">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4254" title="All 2 branches covered.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="fc" id="L4255">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4257" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4258">                        num = ch - '0';</span>
<span class="pc bpc" id="L4259" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4260">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4261" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4262">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4264">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4265">                        return null;</span>
                    }

<span class="fc" id="L4268">                    mostSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4269">                    mostSigBits |= num;</span>
                }
<span class="fc bfc" id="L4271" title="All 2 branches covered.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="fc" id="L4272">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4274" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4275">                        num = ch - '0';</span>
<span class="pc bpc" id="L4276" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4277">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4278" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4279">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4281">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4282">                        return null;</span>
                    }

<span class="fc" id="L4285">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4286">                    leastSigBits |= num;</span>
                }
<span class="fc bfc" id="L4288" title="All 2 branches covered.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="fc" id="L4289">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="pc bpc" id="L4291" title="1 of 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L4292">                        num = ch - '0';</span>
<span class="pc bpc" id="L4293" title="1 of 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="fc" id="L4294">                        num = 10 + (ch - 'a');</span>
<span class="pc bpc" id="L4295" title="2 of 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="fc" id="L4296">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4298">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4299">                        return null;</span>
                    }

<span class="fc" id="L4302">                    leastSigBits &lt;&lt;= 4;</span>
<span class="fc" id="L4303">                    leastSigBits |= num;</span>
                }
<span class="fc" id="L4305">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="fc" id="L4307">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="fc" id="L4308">                chLocal = charAt(bp + (offset++));</span>
<span class="pc bnc" id="L4309" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4310">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4311" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4312">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4314" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4315">                        num = ch - '0';</span>
<span class="nc bnc" id="L4316" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4317">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4318" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4319">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4321">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4322">                        return null;</span>
                    }

<span class="nc" id="L4325">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4326">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4328" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4329">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4331" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4332">                        num = ch - '0';</span>
<span class="nc bnc" id="L4333" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4334">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4335" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4336">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4338">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4339">                        return null;</span>
                    }

<span class="nc" id="L4342">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4343">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4346">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4348">                offset += (endIndex - (bp + fieldName.length + 1) + 1);</span>
<span class="nc" id="L4349">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4350">            } else {</span>
<span class="nc" id="L4351">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4352">                return null;</span>
            }
<span class="pc bpc" id="L4354" title="1 of 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="pc bpc" id="L4355" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="pc bpc" id="L4356" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="pc bpc" id="L4357" title="1 of 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="fc" id="L4358">            uuid = null;</span>
<span class="fc" id="L4359">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4361">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4362">            return null;</span>
        }

<span class="pc bpc" id="L4365" title="1 of 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4366">            bp += offset;</span>
<span class="nc" id="L4367">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4368">            matchStat = VALUE;</span>
<span class="nc" id="L4369">            return uuid;</span>
        }

<span class="pc bpc" id="L4372" title="1 of 2 branches missed.">        if (chLocal == '}') {</span>
<span class="fc" id="L4373">            chLocal = charAt(bp + (offset++));</span>
<span class="pc bpc" id="L4374" title="1 of 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4375">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4376">                bp += offset;</span>
<span class="nc" id="L4377">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4378" title="1 of 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4379">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4380">                bp += offset;</span>
<span class="nc" id="L4381">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4382" title="1 of 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4383">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4384">                bp += offset;</span>
<span class="nc" id="L4385">                this.ch = this.charAt(bp);</span>
<span class="pc bpc" id="L4386" title="1 of 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="fc" id="L4387">                token = JSONToken.EOF;</span>
<span class="fc" id="L4388">                bp += (offset - 1);</span>
<span class="fc" id="L4389">                ch = EOI;</span>
            } else {
<span class="nc" id="L4391">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4392">                return null;</span>
            }
<span class="fc" id="L4394">            matchStat = END;</span>
        } else {
<span class="nc" id="L4396">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4397">            return null;</span>
        }

<span class="fc" id="L4400">        return uuid;</span>
    }

    public java.util.UUID scanUUID(char seperator) {
<span class="nc" id="L4404">        matchStat = UNKNOWN;</span>

        // int index = bp + fieldName.length;

<span class="nc" id="L4408">        int offset = 0;</span>
<span class="nc" id="L4409">        char chLocal = charAt(bp + (offset++));</span>

        final java.util.UUID uuid;
<span class="nc bnc" id="L4412" title="All 2 branches missed.">        if (chLocal == '&quot;') {</span>
<span class="nc" id="L4413">            int startIndex = bp + 1;</span>
<span class="nc" id="L4414">            int endIndex = indexOf('&quot;', startIndex);</span>
<span class="nc bnc" id="L4415" title="All 2 branches missed.">            if (endIndex == -1) {</span>
<span class="nc" id="L4416">                throw new JSONException(&quot;unclosed str&quot;);</span>
            }

<span class="nc" id="L4419">            int startIndex2 = bp + 1; // must re compute</span>
<span class="nc" id="L4420">            int len = endIndex - startIndex2;</span>
<span class="nc bnc" id="L4421" title="All 2 branches missed.">            if (len == 36) {</span>
<span class="nc" id="L4422">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4423" title="All 2 branches missed.">                for (int i = 0; i &lt; 8; ++i) {</span>
<span class="nc" id="L4424">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4426" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4427">                        num = ch - '0';</span>
<span class="nc bnc" id="L4428" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4429">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4430" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4431">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4433">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4434">                        return null;</span>
                    }

<span class="nc" id="L4437">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4438">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4440" title="All 2 branches missed.">                for (int i = 9; i &lt; 13; ++i) {</span>
<span class="nc" id="L4441">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4443" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4444">                        num = ch - '0';</span>
<span class="nc bnc" id="L4445" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4446">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4447" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4448">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4450">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4451">                        return null;</span>
                    }

<span class="nc" id="L4454">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4455">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4457" title="All 2 branches missed.">                for (int i = 14; i &lt; 18; ++i) {</span>
<span class="nc" id="L4458">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4460" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4461">                        num = ch - '0';</span>
<span class="nc bnc" id="L4462" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4463">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4464" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4465">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4467">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4468">                        return null;</span>
                    }

<span class="nc" id="L4471">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4472">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4474" title="All 2 branches missed.">                for (int i = 19; i &lt; 23; ++i) {</span>
<span class="nc" id="L4475">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4477" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4478">                        num = ch - '0';</span>
<span class="nc bnc" id="L4479" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4480">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4481" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4482">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4484">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4485">                        return null;</span>
                    }

<span class="nc" id="L4488">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4489">                    leastSigBits |= num;</span>
                }
<span class="nc bnc" id="L4491" title="All 2 branches missed.">                for (int i = 24; i &lt; 36; ++i) {</span>
<span class="nc" id="L4492">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4494" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4495">                        num = ch - '0';</span>
<span class="nc bnc" id="L4496" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4497">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4498" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4499">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4501">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4502">                        return null;</span>
                    }

<span class="nc" id="L4505">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4506">                    leastSigBits |= num;</span>
                }
<span class="nc" id="L4508">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4510">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4511">                chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4512" title="All 2 branches missed.">            } else if (len == 32) {</span>
<span class="nc" id="L4513">                long mostSigBits = 0, leastSigBits = 0;</span>
<span class="nc bnc" id="L4514" title="All 2 branches missed.">                for (int i = 0; i &lt; 16; ++i) {</span>
<span class="nc" id="L4515">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4517" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4518">                        num = ch - '0';</span>
<span class="nc bnc" id="L4519" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4520">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4521" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4522">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4524">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4525">                        return null;</span>
                    }

<span class="nc" id="L4528">                    mostSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4529">                    mostSigBits |= num;</span>
                }
<span class="nc bnc" id="L4531" title="All 2 branches missed.">                for (int i = 16; i &lt; 32; ++i) {</span>
<span class="nc" id="L4532">                    char ch = charAt(startIndex2 + i);</span>
                    int num;
<span class="nc bnc" id="L4534" title="All 4 branches missed.">                    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="nc" id="L4535">                        num = ch - '0';</span>
<span class="nc bnc" id="L4536" title="All 4 branches missed.">                    } else if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f') {</span>
<span class="nc" id="L4537">                        num = 10 + (ch - 'a');</span>
<span class="nc bnc" id="L4538" title="All 4 branches missed.">                    } else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F') {</span>
<span class="nc" id="L4539">                        num = 10 + (ch - 'A');</span>
                    } else {
<span class="nc" id="L4541">                        matchStat = NOT_MATCH_NAME;</span>
<span class="nc" id="L4542">                        return null;</span>
                    }

<span class="nc" id="L4545">                    leastSigBits &lt;&lt;= 4;</span>
<span class="nc" id="L4546">                    leastSigBits |= num;</span>
                }

<span class="nc" id="L4549">                uuid = new UUID(mostSigBits, leastSigBits);</span>

<span class="nc" id="L4551">                offset += (endIndex - (bp + 1) + 1);</span>
<span class="nc" id="L4552">                chLocal = charAt(bp + (offset++));</span>
<span class="nc" id="L4553">            } else {</span>
<span class="nc" id="L4554">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4555">                return null;</span>
            }
<span class="nc bnc" id="L4557" title="All 2 branches missed.">        } else if (chLocal == 'n'</span>
<span class="nc bnc" id="L4558" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'u'</span>
<span class="nc bnc" id="L4559" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l'</span>
<span class="nc bnc" id="L4560" title="All 2 branches missed.">                &amp;&amp; charAt(bp + (offset++)) == 'l') {</span>
<span class="nc" id="L4561">            uuid = null;</span>
<span class="nc" id="L4562">            chLocal = charAt(bp + (offset++));</span>
        } else {
<span class="nc" id="L4564">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4565">            return null;</span>
        }

<span class="nc bnc" id="L4568" title="All 2 branches missed.">        if (chLocal == ',') {</span>
<span class="nc" id="L4569">            bp += offset;</span>
<span class="nc" id="L4570">            this.ch = this.charAt(bp);</span>
<span class="nc" id="L4571">            matchStat = VALUE;</span>
<span class="nc" id="L4572">            return uuid;</span>
        }

<span class="nc bnc" id="L4575" title="All 2 branches missed.">        if (chLocal == ']') {</span>
<span class="nc" id="L4576">            chLocal = charAt(bp + (offset++));</span>
<span class="nc bnc" id="L4577" title="All 2 branches missed.">            if (chLocal == ',') {</span>
<span class="nc" id="L4578">                token = JSONToken.COMMA;</span>
<span class="nc" id="L4579">                bp += offset;</span>
<span class="nc" id="L4580">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4581" title="All 2 branches missed.">            } else if (chLocal == ']') {</span>
<span class="nc" id="L4582">                token = JSONToken.RBRACKET;</span>
<span class="nc" id="L4583">                bp += offset;</span>
<span class="nc" id="L4584">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4585" title="All 2 branches missed.">            } else if (chLocal == '}') {</span>
<span class="nc" id="L4586">                token = JSONToken.RBRACE;</span>
<span class="nc" id="L4587">                bp += offset;</span>
<span class="nc" id="L4588">                this.ch = this.charAt(bp);</span>
<span class="nc bnc" id="L4589" title="All 2 branches missed.">            } else if (chLocal == EOI) {</span>
<span class="nc" id="L4590">                token = JSONToken.EOF;</span>
<span class="nc" id="L4591">                bp += (offset - 1);</span>
<span class="nc" id="L4592">                ch = EOI;</span>
            } else {
<span class="nc" id="L4594">                matchStat = NOT_MATCH;</span>
<span class="nc" id="L4595">                return null;</span>
            }
<span class="nc" id="L4597">            matchStat = END;</span>
        } else {
<span class="nc" id="L4599">            matchStat = NOT_MATCH;</span>
<span class="nc" id="L4600">            return null;</span>
        }

<span class="nc" id="L4603">        return uuid;</span>
    }

    public final void scanTrue() {
<span class="fc bfc" id="L4607" title="All 2 branches covered.">        if (ch != 't') {</span>
<span class="fc" id="L4608">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4610">        next();</span>

<span class="fc bfc" id="L4612" title="All 2 branches covered.">        if (ch != 'r') {</span>
<span class="fc" id="L4613">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4615">        next();</span>

<span class="fc bfc" id="L4617" title="All 2 branches covered.">        if (ch != 'u') {</span>
<span class="fc" id="L4618">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4620">        next();</span>

<span class="fc bfc" id="L4622" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4623">            throw new JSONException(&quot;error parse true&quot;);</span>
        }
<span class="fc" id="L4625">        next();</span>

<span class="pc bpc" id="L4627" title="1 of 24 branches missed.">        if (ch == ' '  ||</span>
            ch == ','  ||
            ch == '}'  ||
            ch == ']'  ||
            ch == '\n' ||
            ch == '\r' ||
            ch == '\t' ||
            ch == EOI  ||
            ch == '\f' ||
            ch == '\b' ||
            ch == ':'  ||
            ch == '/') {
<span class="fc" id="L4639">            token = JSONToken.TRUE;</span>
        } else {
<span class="fc" id="L4641">            throw new JSONException(&quot;scan true error&quot;);</span>
        }
<span class="fc" id="L4643">    }</span>

    public final void scanNullOrNew() {
<span class="fc" id="L4646">        scanNullOrNew(true);</span>
<span class="fc" id="L4647">    }</span>

    public final void scanNullOrNew(boolean acceptColon) {
<span class="fc bfc" id="L4650" title="All 2 branches covered.">        if (ch != 'n') {</span>
<span class="fc" id="L4651">            throw new JSONException(&quot;error parse null or new&quot;);</span>
        }
<span class="fc" id="L4653">        next();</span>

<span class="fc bfc" id="L4655" title="All 2 branches covered.">        if (ch == 'u') {</span>
<span class="fc" id="L4656">            next();</span>
<span class="fc bfc" id="L4657" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4658">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4660">            next();</span>

<span class="fc bfc" id="L4662" title="All 2 branches covered.">            if (ch != 'l') {</span>
<span class="fc" id="L4663">                throw new JSONException(&quot;error parse null&quot;);</span>
            }
<span class="fc" id="L4665">            next();</span>


<span class="pc bpc" id="L4668" title="1 of 24 branches missed.">            if (ch == ' '</span>
                    || ch == ','
                    || ch == '}'
                    || ch == ']'
                    || ch == '\n'
                    || ch == '\r'
                    || ch == '\t'
                    || ch == EOI
                    || (ch == ':' &amp;&amp; acceptColon)
                    || ch == '\f'
                    || ch == '\b') {

<span class="fc" id="L4680">                token = JSONToken.NULL;</span>
            } else {
<span class="fc" id="L4682">                throw new JSONException(&quot;scan null error&quot;);</span>
            }
<span class="fc" id="L4684">            return;</span>
        }

<span class="fc bfc" id="L4687" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4688">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4690">        next();</span>

<span class="fc bfc" id="L4692" title="All 2 branches covered.">        if (ch != 'w') {</span>
<span class="fc" id="L4693">            throw new JSONException(&quot;error parse new&quot;);</span>
        }
<span class="fc" id="L4695">        next();</span>

<span class="fc bfc" id="L4697" title="All 20 branches covered.">        if (ch == ' '  ||</span>
            ch == ','  ||
            ch == '}'  ||
            ch == ']'  ||
            ch == '\n' ||
            ch == '\r' ||
            ch == '\t' ||
            ch == EOI  ||
            ch == '\f' ||
            ch == '\b') {
<span class="fc" id="L4707">            token = JSONToken.NEW;</span>
        } else {
<span class="fc" id="L4709">            throw new JSONException(&quot;scan new error&quot;);</span>
        }
<span class="fc" id="L4711">    }</span>

    public final void scanFalse() {
<span class="fc bfc" id="L4714" title="All 2 branches covered.">        if (ch != 'f') {</span>
<span class="fc" id="L4715">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4717">        next();</span>

<span class="fc bfc" id="L4719" title="All 2 branches covered.">        if (ch != 'a') {</span>
<span class="fc" id="L4720">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4722">        next();</span>

<span class="fc bfc" id="L4724" title="All 2 branches covered.">        if (ch != 'l') {</span>
<span class="fc" id="L4725">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4727">        next();</span>

<span class="fc bfc" id="L4729" title="All 2 branches covered.">        if (ch != 's') {</span>
<span class="fc" id="L4730">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4732">        next();</span>

<span class="fc bfc" id="L4734" title="All 2 branches covered.">        if (ch != 'e') {</span>
<span class="fc" id="L4735">            throw new JSONException(&quot;error parse false&quot;);</span>
        }
<span class="fc" id="L4737">        next();</span>

<span class="pc bpc" id="L4739" title="1 of 24 branches missed.">        if (ch == ' '  ||</span>
            ch == ','  ||
            ch == '}'  ||
            ch == ']'  ||
            ch == '\n' ||
            ch == '\r' ||
            ch == '\t' ||
            ch == EOI  ||
            ch == '\f' ||
            ch == '\b' ||
            ch == ':'  ||
            ch == '/') {
<span class="fc" id="L4751">            token = JSONToken.FALSE;</span>
        } else {
<span class="fc" id="L4753">            throw new JSONException(&quot;scan false error&quot;);</span>
        }
<span class="fc" id="L4755">    }</span>

    public final void scanIdent() {
<span class="fc" id="L4758">        np = bp - 1;</span>
<span class="fc" id="L4759">        hasSpecial = false;</span>

        for (;;) {
<span class="fc" id="L4762">            sp++;</span>

<span class="fc" id="L4764">            next();</span>
<span class="fc bfc" id="L4765" title="All 2 branches covered.">            if (Character.isLetterOrDigit(ch)) {</span>
<span class="fc" id="L4766">                continue;</span>
            }

<span class="fc" id="L4769">            String ident = stringVal();</span>

<span class="fc bfc" id="L4771" title="All 2 branches covered.">            if (&quot;null&quot;.equalsIgnoreCase(ident)) {</span>
<span class="fc" id="L4772">                token = JSONToken.NULL;</span>
<span class="fc bfc" id="L4773" title="All 2 branches covered.">            } else if (&quot;new&quot;.equals(ident)) {</span>
<span class="fc" id="L4774">                token = JSONToken.NEW;</span>
<span class="fc bfc" id="L4775" title="All 2 branches covered.">            } else if (&quot;true&quot;.equals(ident)) {</span>
<span class="fc" id="L4776">                token = JSONToken.TRUE;</span>
<span class="fc bfc" id="L4777" title="All 2 branches covered.">            } else if (&quot;false&quot;.equals(ident)) {</span>
<span class="fc" id="L4778">                token = JSONToken.FALSE;</span>
<span class="fc bfc" id="L4779" title="All 2 branches covered.">            } else if (&quot;undefined&quot;.equals(ident)) {</span>
<span class="fc" id="L4780">                token = JSONToken.UNDEFINED;</span>
<span class="fc bfc" id="L4781" title="All 2 branches covered.">            } else if (&quot;Set&quot;.equals(ident)) {</span>
<span class="fc" id="L4782">                token = JSONToken.SET;</span>
<span class="fc bfc" id="L4783" title="All 2 branches covered.">            } else if (&quot;TreeSet&quot;.equals(ident)) {</span>
<span class="fc" id="L4784">                token = JSONToken.TREE_SET;</span>
            } else {
<span class="fc" id="L4786">                token = JSONToken.IDENTIFIER;</span>
            }
<span class="fc" id="L4788">            return;</span>
        }
    }

    public abstract String stringVal();

    public abstract String subString(int offset, int count);

    protected abstract char[] sub_chars(int offset, int count);

    public static String readString(char[] chars, int chars_len) {
<span class="fc" id="L4799">        char[] sbuf = new char[chars_len];</span>
<span class="fc" id="L4800">        int len = 0;</span>
<span class="fc bfc" id="L4801" title="All 2 branches covered.">        for (int i = 0; i &lt; chars_len; ++i) {</span>
<span class="fc" id="L4802">            char ch = chars[i];</span>

<span class="fc bfc" id="L4804" title="All 2 branches covered.">            if (ch != '\\') {</span>
<span class="fc" id="L4805">                sbuf[len++] = ch;</span>
<span class="fc" id="L4806">                continue;</span>
            }
<span class="fc" id="L4808">            ch = chars[++i];</span>

<span class="fc bfc" id="L4810" title="All 21 branches covered.">            switch (ch) {</span>
                case '0':
<span class="fc" id="L4812">                    sbuf[len++] = '\0';</span>
<span class="fc" id="L4813">                    break;</span>
                case '1':
<span class="fc" id="L4815">                    sbuf[len++] = '\1';</span>
<span class="fc" id="L4816">                    break;</span>
                case '2':
<span class="fc" id="L4818">                    sbuf[len++] = '\2';</span>
<span class="fc" id="L4819">                    break;</span>
                case '3':
<span class="fc" id="L4821">                    sbuf[len++] = '\3';</span>
<span class="fc" id="L4822">                    break;</span>
                case '4':
<span class="fc" id="L4824">                    sbuf[len++] = '\4';</span>
<span class="fc" id="L4825">                    break;</span>
                case '5':
<span class="fc" id="L4827">                    sbuf[len++] = '\5';</span>
<span class="fc" id="L4828">                    break;</span>
                case '6':
<span class="fc" id="L4830">                    sbuf[len++] = '\6';</span>
<span class="fc" id="L4831">                    break;</span>
                case '7':
<span class="fc" id="L4833">                    sbuf[len++] = '\7';</span>
<span class="fc" id="L4834">                    break;</span>
                case 'b': // 8
<span class="fc" id="L4836">                    sbuf[len++] = '\b';</span>
<span class="fc" id="L4837">                    break;</span>
                case 't': // 9
<span class="fc" id="L4839">                    sbuf[len++] = '\t';</span>
<span class="fc" id="L4840">                    break;</span>
                case 'n': // 10
<span class="fc" id="L4842">                    sbuf[len++] = '\n';</span>
<span class="fc" id="L4843">                    break;</span>
                case 'v': // 11
<span class="fc" id="L4845">                    sbuf[len++] = '\u000B';</span>
<span class="fc" id="L4846">                    break;</span>
                case 'f': // 12
                case 'F':
<span class="fc" id="L4849">                    sbuf[len++] = '\f';</span>
<span class="fc" id="L4850">                    break;</span>
                case 'r': // 13
<span class="fc" id="L4852">                    sbuf[len++] = '\r';</span>
<span class="fc" id="L4853">                    break;</span>
                case '&quot;': // 34
<span class="fc" id="L4855">                    sbuf[len++] = '&quot;';</span>
<span class="fc" id="L4856">                    break;</span>
                case '\'': // 39
<span class="fc" id="L4858">                    sbuf[len++] = '\'';</span>
<span class="fc" id="L4859">                    break;</span>
                case '/': // 47
<span class="fc" id="L4861">                    sbuf[len++] = '/';</span>
<span class="fc" id="L4862">                    break;</span>
                case '\\': // 92
<span class="fc" id="L4864">                    sbuf[len++] = '\\';</span>
<span class="fc" id="L4865">                    break;</span>
                case 'x':
<span class="fc" id="L4867">                    sbuf[len++] = (char) (digits[chars[++i]] * 16 + digits[chars[++i]]);</span>
<span class="fc" id="L4868">                    break;</span>
                case 'u':
<span class="fc" id="L4870">                    sbuf[len++] = (char) Integer.parseInt(new String(new char[] { chars[++i], //</span>
                                    chars[++i], //
                                    chars[++i], //
                                    chars[++i] }),
                            16);
<span class="fc" id="L4875">                    break;</span>
                default:
<span class="fc" id="L4877">                    throw new JSONException(&quot;unclosed.str.lit&quot;);</span>
            }
        }
<span class="fc" id="L4880">        return new String(sbuf, 0, len);</span>
    }

    protected abstract boolean charArrayCompare(char[] chars);

    public boolean isBlankInput() {
<span class="fc" id="L4886">        for (int i = 0;; ++i) {</span>
<span class="fc" id="L4887">            char chLocal = charAt(i);</span>
<span class="fc bfc" id="L4888" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc" id="L4889">                token = JSONToken.EOF;</span>
<span class="fc" id="L4890">                break;</span>
            }

<span class="fc bfc" id="L4893" title="All 2 branches covered.">            if (!isWhitespace(chLocal)) {</span>
<span class="fc" id="L4894">                return false;</span>
            }
        }

<span class="fc" id="L4898">        return true;</span>
    }

    public final void skipWhitespace() {
        for (;;) {
<span class="fc bfc" id="L4903" title="All 2 branches covered.">            if (ch &lt;= '/') {</span>
<span class="pc bpc" id="L4904" title="3 of 12 branches missed.">                if (ch == ' '  ||</span>
                    ch == '\r' ||
                    ch == '\n' ||
                    ch == '\t' ||
                    ch == '\f' ||
                    ch == '\b') {
<span class="fc" id="L4910">                    next();</span>
<span class="fc" id="L4911">                    continue;</span>
<span class="fc bfc" id="L4912" title="All 2 branches covered.">                } else if (ch == '/') {</span>
<span class="fc" id="L4913">                    skipComment();</span>
<span class="fc" id="L4914">                    continue;</span>
                } else {
                    break;
                }
            } else {
                break;
            }
        }
<span class="fc" id="L4922">    }</span>

    private void scanStringSingleQuote() {
<span class="fc" id="L4925">        np = bp;</span>
<span class="fc" id="L4926">        hasSpecial = false;</span>
        char chLocal;
        for (;;) {
<span class="fc" id="L4929">            chLocal = next();</span>

<span class="fc bfc" id="L4931" title="All 2 branches covered.">            if (chLocal == '\'') {</span>
<span class="fc" id="L4932">                break;</span>
            }

<span class="fc bfc" id="L4935" title="All 2 branches covered.">            if (chLocal == EOI) {</span>
<span class="fc bfc" id="L4936" title="All 2 branches covered.">                if (!isEOF()) {</span>
<span class="fc" id="L4937">                    putChar((char) EOI);</span>
<span class="fc" id="L4938">                    continue;</span>
                }
<span class="fc" id="L4940">                throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
            }

<span class="fc bfc" id="L4943" title="All 2 branches covered.">            if (chLocal == '\\') {</span>
<span class="fc bfc" id="L4944" title="All 2 branches covered.">                if (!hasSpecial) {</span>
<span class="fc" id="L4945">                    hasSpecial = true;</span>

<span class="pc bpc" id="L4947" title="1 of 2 branches missed.">                    if (sp &gt; sbuf.length) {</span>
<span class="nc" id="L4948">                        char[] newsbuf = new char[sp * 2];</span>
<span class="nc" id="L4949">                        System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="nc" id="L4950">                        sbuf = newsbuf;</span>
                    }

                    // text.getChars(offset, offset + count, dest, 0);
<span class="fc" id="L4954">                    this.copyTo(np + 1, sp, sbuf);</span>
                    // System.arraycopy(buf, np + 1, sbuf, 0, sp);
                }

<span class="fc" id="L4958">                chLocal = next();</span>

<span class="fc bfc" id="L4960" title="All 21 branches covered.">                switch (chLocal) {</span>
                    case '0':
<span class="fc" id="L4962">                        putChar('\0');</span>
<span class="fc" id="L4963">                        break;</span>
                    case '1':
<span class="fc" id="L4965">                        putChar('\1');</span>
<span class="fc" id="L4966">                        break;</span>
                    case '2':
<span class="fc" id="L4968">                        putChar('\2');</span>
<span class="fc" id="L4969">                        break;</span>
                    case '3':
<span class="fc" id="L4971">                        putChar('\3');</span>
<span class="fc" id="L4972">                        break;</span>
                    case '4':
<span class="fc" id="L4974">                        putChar('\4');</span>
<span class="fc" id="L4975">                        break;</span>
                    case '5':
<span class="fc" id="L4977">                        putChar('\5');</span>
<span class="fc" id="L4978">                        break;</span>
                    case '6':
<span class="fc" id="L4980">                        putChar('\6');</span>
<span class="fc" id="L4981">                        break;</span>
                    case '7':
<span class="fc" id="L4983">                        putChar('\7');</span>
<span class="fc" id="L4984">                        break;</span>
                    case 'b': // 8
<span class="fc" id="L4986">                        putChar('\b');</span>
<span class="fc" id="L4987">                        break;</span>
                    case 't': // 9
<span class="fc" id="L4989">                        putChar('\t');</span>
<span class="fc" id="L4990">                        break;</span>
                    case 'n': // 10
<span class="fc" id="L4992">                        putChar('\n');</span>
<span class="fc" id="L4993">                        break;</span>
                    case 'v': // 11
<span class="fc" id="L4995">                        putChar('\u000B');</span>
<span class="fc" id="L4996">                        break;</span>
                    case 'f': // 12
                    case 'F':
<span class="fc" id="L4999">                        putChar('\f');</span>
<span class="fc" id="L5000">                        break;</span>
                    case 'r': // 13
<span class="fc" id="L5002">                        putChar('\r');</span>
<span class="fc" id="L5003">                        break;</span>
                    case '&quot;': // 34
<span class="fc" id="L5005">                        putChar('&quot;');</span>
<span class="fc" id="L5006">                        break;</span>
                    case '\'': // 39
<span class="fc" id="L5008">                        putChar('\'');</span>
<span class="fc" id="L5009">                        break;</span>
                    case '/': // 47
<span class="fc" id="L5011">                        putChar('/');</span>
<span class="fc" id="L5012">                        break;</span>
                    case '\\': // 92
<span class="fc" id="L5014">                        putChar('\\');</span>
<span class="fc" id="L5015">                        break;</span>
                    case 'x':
<span class="fc" id="L5017">                        char x1 = next();</span>
<span class="fc" id="L5018">                        char x2 = next();</span>

<span class="pc bpc" id="L5020" title="2 of 12 branches missed.">                        boolean hex1 = (x1 &gt;= '0' &amp;&amp; x1 &lt;= '9')</span>
                                || (x1 &gt;= 'a' &amp;&amp; x1 &lt;= 'f')
                                || (x1 &gt;= 'A' &amp;&amp; x1 &lt;= 'F');
<span class="pc bpc" id="L5023" title="7 of 12 branches missed.">                        boolean hex2 = (x2 &gt;= '0' &amp;&amp; x2 &lt;= '9')</span>
                                || (x2 &gt;= 'a' &amp;&amp; x2 &lt;= 'f')
                                || (x2 &gt;= 'A' &amp;&amp; x2 &lt;= 'F');
<span class="fc bfc" id="L5026" title="All 4 branches covered.">                        if (!hex1 || !hex2) {</span>
<span class="fc" id="L5027">                            throw new JSONException(&quot;invalid escape character \\x&quot; + x1 + x2);</span>
                        }

<span class="fc" id="L5030">                        putChar((char) (digits[x1] * 16 + digits[x2]));</span>
<span class="fc" id="L5031">                        break;</span>
                    case 'u':
<span class="fc" id="L5033">                        putChar((char) Integer.parseInt(new String(new char[] { next(), next(), next(), next() }), 16));</span>
<span class="fc" id="L5034">                        break;</span>
                    default:
<span class="fc" id="L5036">                        this.ch = chLocal;</span>
<span class="fc" id="L5037">                        throw new JSONException(&quot;unclosed single-quote string&quot;);</span>
                }
                continue;
            }

<span class="fc bfc" id="L5042" title="All 2 branches covered.">            if (!hasSpecial) {</span>
<span class="fc" id="L5043">                sp++;</span>
<span class="fc" id="L5044">                continue;</span>
            }

<span class="fc bfc" id="L5047" title="All 2 branches covered.">            if (sp == sbuf.length) {</span>
<span class="fc" id="L5048">                putChar(chLocal);</span>
            } else {
<span class="fc" id="L5050">                sbuf[sp++] = chLocal;</span>
            }
        }

<span class="fc" id="L5054">        token = LITERAL_STRING;</span>
<span class="fc" id="L5055">        this.next();</span>
<span class="fc" id="L5056">    }</span>

    /**
     * Append a character to sbuf.
     */
    protected final void putChar(char ch) {
<span class="fc bfc" id="L5062" title="All 2 branches covered.">        if (sp == sbuf.length) {</span>
<span class="fc" id="L5063">            char[] newsbuf = new char[sbuf.length * 2];</span>
<span class="fc" id="L5064">            System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length);</span>
<span class="fc" id="L5065">            sbuf = newsbuf;</span>
        }
<span class="fc" id="L5067">        sbuf[sp++] = ch;</span>
<span class="fc" id="L5068">    }</span>

    public final void scanHex() {
<span class="pc bpc" id="L5071" title="1 of 2 branches missed.">        if (ch != 'x') {</span>
<span class="nc" id="L5072">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }
<span class="fc" id="L5074">        next();</span>
<span class="pc bpc" id="L5075" title="1 of 2 branches missed.">        if (ch != '\'') {</span>
<span class="nc" id="L5076">            throw new JSONException(&quot;illegal state. &quot; + ch);</span>
        }

<span class="fc" id="L5079">        np = bp;</span>
<span class="fc" id="L5080">        next();</span>

<span class="fc bfc" id="L5082" title="All 2 branches covered.">        if (ch == '\'') {</span>
<span class="fc" id="L5083">            next();</span>
<span class="fc" id="L5084">            token = JSONToken.HEX;</span>
<span class="fc" id="L5085">            return;</span>
        }

<span class="fc" id="L5088">        for (int i = 0;;++i) {</span>
<span class="fc" id="L5089">            char ch = next();</span>
<span class="pc bpc" id="L5090" title="1 of 8 branches missed.">            if ((ch &gt;= '0' &amp;&amp; ch &lt;= '9') || (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F')) {</span>
<span class="fc" id="L5091">                sp++;</span>
<span class="fc" id="L5092">                continue;</span>
<span class="pc bpc" id="L5093" title="1 of 2 branches missed.">            } else if (ch == '\'') {</span>
<span class="fc" id="L5094">                sp++;</span>
<span class="fc" id="L5095">                next();</span>
<span class="fc" id="L5096">                break;</span>
            } else {
<span class="nc" id="L5098">                throw new JSONException(&quot;illegal state. &quot; + ch);</span>
            }
        }
<span class="fc" id="L5101">        token = JSONToken.HEX;</span>
<span class="fc" id="L5102">    }</span>

    public final void scanNumber() {
<span class="fc" id="L5105">        np = bp;</span>

<span class="fc bfc" id="L5107" title="All 2 branches covered.">        if (ch == '-') {</span>
<span class="fc" id="L5108">            sp++;</span>
<span class="fc" id="L5109">            next();</span>
        }

        for (;;) {
<span class="fc bfc" id="L5113" title="All 4 branches covered.">            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5114">                sp++;</span>
            } else {
                break;
            }
<span class="fc" id="L5118">            next();</span>
        }

<span class="fc" id="L5121">        boolean isDouble = false;</span>

<span class="fc bfc" id="L5123" title="All 2 branches covered.">        if (ch == '.') {</span>
<span class="fc" id="L5124">            sp++;</span>
<span class="fc" id="L5125">            next();</span>
<span class="fc" id="L5126">            isDouble = true;</span>

            for (;;) {
<span class="fc bfc" id="L5129" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5130">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5134">                next();</span>
            }
        }

<span class="fc bfc" id="L5138" title="All 2 branches covered.">        if (ch == 'L') {</span>
<span class="fc" id="L5139">            sp++;</span>
<span class="fc" id="L5140">            next();</span>
<span class="fc bfc" id="L5141" title="All 2 branches covered.">        } else if (ch == 'S') {</span>
<span class="fc" id="L5142">            sp++;</span>
<span class="fc" id="L5143">            next();</span>
<span class="fc bfc" id="L5144" title="All 2 branches covered.">        } else if (ch == 'B') {</span>
<span class="fc" id="L5145">            sp++;</span>
<span class="fc" id="L5146">            next();</span>
<span class="fc bfc" id="L5147" title="All 2 branches covered.">        } else if (ch == 'F') {</span>
<span class="fc" id="L5148">            sp++;</span>
<span class="fc" id="L5149">            next();</span>
<span class="fc" id="L5150">            isDouble = true;</span>
<span class="fc bfc" id="L5151" title="All 2 branches covered.">        } else if (ch == 'D') {</span>
<span class="fc" id="L5152">            sp++;</span>
<span class="fc" id="L5153">            next();</span>
<span class="fc" id="L5154">            isDouble = true;</span>
<span class="fc bfc" id="L5155" title="All 4 branches covered.">        } else if (ch == 'e' || ch == 'E') {</span>
<span class="fc" id="L5156">            sp++;</span>
<span class="fc" id="L5157">            next();</span>

<span class="fc bfc" id="L5159" title="All 4 branches covered.">            if (ch == '+' || ch == '-') {</span>
<span class="fc" id="L5160">                sp++;</span>
<span class="fc" id="L5161">                next();</span>
            }

            for (;;) {
<span class="fc bfc" id="L5165" title="All 4 branches covered.">                if (ch &gt;= '0' &amp;&amp; ch &lt;= '9') {</span>
<span class="fc" id="L5166">                    sp++;</span>
                } else {
                    break;
                }
<span class="fc" id="L5170">                next();</span>
            }

<span class="fc bfc" id="L5173" title="All 4 branches covered.">            if (ch == 'D' || ch == 'F') {</span>
<span class="fc" id="L5174">                sp++;</span>
<span class="fc" id="L5175">                next();</span>
            }

<span class="fc" id="L5178">            isDouble = true;</span>
        }

<span class="fc bfc" id="L5181" title="All 2 branches covered.">        if (isDouble) {</span>
<span class="fc" id="L5182">            token = JSONToken.LITERAL_FLOAT;</span>
        } else {
<span class="fc" id="L5184">            token = JSONToken.LITERAL_INT;</span>
        }
<span class="fc" id="L5186">    }</span>

    public final long longValue() throws NumberFormatException {
<span class="fc" id="L5189">        long result = 0;</span>
<span class="fc" id="L5190">        boolean negative = false;</span>
        long limit;
        int digit;

<span class="pc bpc" id="L5194" title="1 of 2 branches missed.">        if (np == -1) {</span>
<span class="nc" id="L5195">            np = 0;</span>
        }

<span class="fc" id="L5198">        int i = np, max = np + sp;</span>

<span class="fc bfc" id="L5200" title="All 2 branches covered.">        if (charAt(np) == '-') {</span>
<span class="fc" id="L5201">            negative = true;</span>
<span class="fc" id="L5202">            limit = Long.MIN_VALUE;</span>
<span class="fc" id="L5203">            i++;</span>
        } else {
<span class="fc" id="L5205">            limit = -Long.MAX_VALUE;</span>
        }
<span class="fc" id="L5207">        long multmin = MULTMIN_RADIX_TEN;</span>
<span class="fc bfc" id="L5208" title="All 2 branches covered.">        if (i &lt; max) {</span>
<span class="fc" id="L5209">            digit = charAt(i++) - '0';</span>
<span class="fc" id="L5210">            result = -digit;</span>
        }
<span class="fc bfc" id="L5212" title="All 2 branches covered.">        while (i &lt; max) {</span>
            // Accumulating negatively avoids surprises near MAX_VALUE
<span class="fc" id="L5214">            char chLocal = charAt(i++);</span>

<span class="fc bfc" id="L5216" title="All 6 branches covered.">            if (chLocal == 'L' || chLocal == 'S' || chLocal == 'B') {</span>
<span class="fc" id="L5217">                break;</span>
            }

<span class="fc" id="L5220">            digit = chLocal - '0';</span>
<span class="fc bfc" id="L5221" title="All 2 branches covered.">            if (result &lt; multmin) {</span>
<span class="fc" id="L5222">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5224">            result *= 10;</span>
<span class="fc bfc" id="L5225" title="All 2 branches covered.">            if (result &lt; limit + digit) {</span>
<span class="fc" id="L5226">                throw new NumberFormatException(numberString());</span>
            }
<span class="fc" id="L5228">            result -= digit;</span>
<span class="fc" id="L5229">        }</span>

<span class="fc bfc" id="L5231" title="All 2 branches covered.">        if (negative) {</span>
<span class="fc bfc" id="L5232" title="All 2 branches covered.">            if (i &gt; np + 1) {</span>
<span class="fc" id="L5233">                return result;</span>
            } else { /* Only got &quot;-&quot; */
<span class="fc" id="L5235">                throw new NumberFormatException(numberString());</span>
            }
        } else {
<span class="fc" id="L5238">            return -result;</span>
        }
    }

    public final Number decimalValue(boolean decimal) {
<span class="fc" id="L5243">        char chLocal = charAt(np + sp - 1);</span>
        try {
<span class="fc bfc" id="L5245" title="All 2 branches covered.">            if (chLocal == 'F') {</span>
<span class="fc" id="L5246">                return Float.parseFloat(numberString());</span>
            }

<span class="fc bfc" id="L5249" title="All 2 branches covered.">            if (chLocal == 'D') {</span>
<span class="fc" id="L5250">                return Double.parseDouble(numberString());</span>
            }

<span class="fc bfc" id="L5253" title="All 2 branches covered.">            if (decimal) {</span>
<span class="fc" id="L5254">                return decimalValue();</span>
            } else {
<span class="fc" id="L5256">                return doubleValue();</span>
            }
<span class="fc" id="L5258">        } catch (NumberFormatException ex) {</span>
<span class="fc" id="L5259">            throw new JSONException(ex.getMessage() + &quot;, &quot; + info());</span>
        }
    }

    public abstract BigDecimal decimalValue();

    public static boolean isWhitespace(char ch) {
        // 专门调整了判断顺序
<span class="fc bfc" id="L5267" title="All 14 branches covered.">        return ch &lt;= ' '  &amp;&amp;</span>
              (ch == ' '  ||
               ch == '\n' ||
               ch == '\r' ||
               ch == '\t' ||
               ch == '\f' ||
               ch == '\b');
    }

    protected static final long  MULTMIN_RADIX_TEN     = Long.MIN_VALUE / 10;
    protected static final int   INT_MULTMIN_RADIX_TEN = Integer.MIN_VALUE / 10;

<span class="fc" id="L5279">    protected final static int[] digits                = new int[(int) 'f' + 1];</span>

    static {
<span class="fc bfc" id="L5282" title="All 2 branches covered.">        for (int i = '0'; i &lt;= '9'; ++i) {</span>
<span class="fc" id="L5283">            digits[i] = i - '0';</span>
        }

<span class="fc bfc" id="L5286" title="All 2 branches covered.">        for (int i = 'a'; i &lt;= 'f'; ++i) {</span>
<span class="fc" id="L5287">            digits[i] = (i - 'a') + 10;</span>
        }
<span class="fc bfc" id="L5289" title="All 2 branches covered.">        for (int i = 'A'; i &lt;= 'F'; ++i) {</span>
<span class="fc" id="L5290">            digits[i] = (i - 'A') + 10;</span>
        }
<span class="fc" id="L5292">    }</span>

    /**
     * hsf support
     * @param fieldName
     * @param argTypesCount
     * @param typeSymbolTable
     * @return
     */
    public String[] scanFieldStringArray(char[] fieldName, int argTypesCount, SymbolTable typeSymbolTable) {
<span class="nc" id="L5302">        throw new UnsupportedOperationException();</span>
    }

    public boolean matchField2(char[] fieldName) {
<span class="nc" id="L5306">        throw new UnsupportedOperationException();</span>
    }

    public int getFeatures() {
<span class="fc" id="L5310">        return this.features;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>